import{u as W,k as X,z as Y,K as q,r as i,N as J,c as f,w as t,V as Q,o as u,a,f as l,R as P,G as Z,S as A,d,T as w,b as C,n as I,F as B,U as E,C as y,H as N,A as p,e as U,i as T,g as ee,h as te,W as $,X as ae}from"./app-d2fb1262.js";import{c as b}from"./clientApi-2b4a321a.js";import{m as le,a as oe}from"./mdi-a0a77bee.js";import{_ as se}from"./KpiContent-32da05e5.js";import{_ as ne}from"./EmployeeCard-d6e2f4e2.js";import{_ as ce}from"./ConfirmDialog-c3dbd728.js";import{_ as ie}from"./SnackBar-28e14e9f.js";import"./vue-datepicker-b8277478.js";import"./typeof-7fd5df1e.js";import"./defineProperty-fcf2a4a8.js";import"./printInitials-a54a9c4a.js";const ue={class:"v-col-12 v-col-md-3 pb-0"},re=l("div",{class:"text-caption px-3 text-grey-darken-1 pt-1"}," Enter ecode, name, or email ",-1),de={key:0,class:"v-col-12 v-col-md-3 text-right pb-0"},pe=l("div",{class:"text-caption px-3 text-grey-darken-1 pt-1"},"Employee Status",-1),ve={class:"v-col-12"},me={class:"v-col-12 v-col-md-3 d-flex align-center"},_e={class:"v-col-12 v-col-md-2 d-flex flex-column"},fe=l("div",{class:"text-caption text-grey"},"Reporting To",-1),ye={class:"text-body-2"},he={class:"v-col-12 v-col-md-2 d-flex flex-column"},ge=l("div",{class:"text-caption text-grey"},"Business Unit",-1),xe={class:"text-body-2"},ke={class:"v-col-12 v-col-md-2 d-flex flex-column"},Ce=l("div",{class:"text-caption text-grey"},"KPI's Target Year",-1),be={class:"text-body-2"},Se=l("div",{class:"v-col-12 v-col-md-1 d-flex flex-column"},[l("div",{class:"text-caption text-grey"},"Total KPI"),l("div",{class:"text-body-2"},"0/100")],-1),Ve={key:0,class:"v-col-12 v-col-md-2 d-flex align-center"},Ke={__name:"SingleEmployee",setup(we){const r=W(),S=X(),z=Y(),K=q(),v=i({}),h=i("Active"),R=i(""),L=i([{title:"Active",color:"success"},{title:"Inactive",color:"error"}]),s=i({}),V=async()=>{await b(r.authToken).get("/api/hr/employee/ecode/"+K.params.ecode).then(e=>{s.value=e.data,h.value=e.data.status}).catch(e=>{console.log("getEmployee",e)})};V();const F=e=>{R.value=e.title,o.value={dialog:!0,title:"Confirm Status Update",text:"Please confirm that you want to update the status of "+s.value.display_name+" into "+e.title+".",btnColor:e.title=="Active"?"success":"error",btnTitle:"Confirm"}},M=async()=>{let e={ecode:s.value.ecode,status:R.value};o.value={...o.value,loading:!0},await b(r.authToken).post("/api/hr/employee/status/update",e).then(n=>{V().then(()=>{o.value={...o.value,loading:!1,dialog:!1},v.value={status:!0,type:"success",text:n.data.message}})}).catch(n=>{console.log("getEmployee",n),o.value={...o.value,loading:!1},v.value={status:!0,type:"error",text:"Error while updating employee"}})},g=i(""),x=i(!1),k=i([]),O=async e=>{x.value=!0,await b(r.authToken).get("/api/hr/search/employee?&filter[search]="+e).then(n=>{x.value=!1,k.value=n.data,console.log("results.value",k.value)}).catch(n=>{x.value=!1,console.log("getEmployee",n)})},j=e=>{s.value=e,h.value=e.status,z.push({name:"SingleEmployee",params:{ecode:e.ecode}}).catch(n=>{})};J(g,(e,n)=>{e!=n&&e.length>3&&O(g.value)});const m=i({data:{},loading:!1}),D=()=>{o.value={dialog:!0,title:"Confirm Reopen",text:"Please confirm that you want to reopen the KPI for "+r.authProfile.email+".",btnColor:"primary",btnTitle:"Confirm"}},G=async()=>{m.value.data={ecode:s.value.ecode},o.value={...o.value,loading:!0},await b(r.authToken).post("/api/hr/employee/reopen",m.value.data).then(e=>{o.value={...o.value,loading:!1,dialog:!1},m.value.loading=!0,V().then(()=>{m.value.loading=!1,v.value={status:!0,type:"success",text:e.data.message}})}).catch(e=>{o.value={...o.value,loading:!1},v.value={status:!0,type:"error",text:"Error while updating employee"},console.log("getEmployee",e)})},o=i(),H=e=>{o.value.title=="Confirm Status Update"?M():o.value.title=="Confirm Reopen"&&G()};return(e,n)=>(u(),f(Q,{class:"pb-16"},{default:t(()=>[a(T,{class:"mt-5 justify-space-between"},{default:t(()=>[l("div",ue,[a(P,null,{activator:t(({props:c})=>[a(Z,A(c,{modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=_=>g.value=_),loading:x.value,variant:"outlined",density:"compact",class:"bg-white",label:"Search Employee","hide-details":"","append-inner-icon":d(le)}),null,16,["modelValue","loading","append-inner-icon"])]),default:t(()=>[k.value.length>0?(u(),f(w,{key:0,density:"compact",style:{"max-height":"300px"}},{default:t(()=>[(u(!0),C(B,null,I(k.value,(c,_)=>(u(),f(E,{key:_,onClick:()=>j(c)},{default:t(()=>[a($,null,{default:t(()=>[y(p(c.display_name+" - "+c.ecode),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(u(),f(w,{key:1,density:"compact"},{default:t(()=>[a(E,null,{default:t(()=>[y(" No results found ")]),_:1})]),_:1}))]),_:1}),re]),["hr_admin","app_admin"].includes(d(r).authProfile.role)?(u(),C("div",de,[l("div",null,[a(P,null,{activator:t(({props:c})=>[a(N,A(c,{color:`${h.value=="Active"?"success":"error"}`,width:"120"}),{default:t(()=>[y(p(h.value),1)]),_:2},1040,["color"])]),default:t(()=>[a(w,{density:"compact"},{default:t(()=>[(u(!0),C(B,null,I(L.value,(c,_)=>(u(),f(E,{key:_,onClick:()=>F(c)},{default:t(()=>[a($,null,{default:t(()=>[a(ae,{size:"16",color:c.color,icon:d(oe)},null,8,["color","icon"]),y(" "+p(c.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),pe])):U("",!0)]),_:1}),a(T,null,{default:t(()=>[l("div",ve,[a(ee,{class:"elevation-0"},{default:t(()=>[a(te,null,{default:t(()=>[a(T,null,{default:t(()=>[l("div",me,[a(ne,{profile:s.value},null,8,["profile"])]),l("div",_e,[fe,l("div",ye,p(s.value.managed_by&&s.value.managed_by.display_name?s.value.managed_by.display_name:""),1)]),l("div",he,[ge,l("div",xe,p(s.value&&s.value.company?s.value.company.title:""),1)]),l("div",ke,[Ce,l("div",be,p(d(S)&&d(S).pms_settings?d(S).pms_settings.year:""),1)]),Se,["hr_admin","app_admin"].includes(d(r).authProfile.role)?(u(),C("div",Ve,[a(N,{loading:m.value.loading,onClick:D,block:"",size:"large",color:"secondary",class:"text-capitalize rounded-lg"},{default:t(()=>[y("Reopen")]),_:1},8,["loading"])])):U("",!0)]),_:1})]),_:1})]),_:1})])]),_:1}),a(se,{"selected-employee":s.value},null,8,["selected-employee"]),a(ce,{options:o.value,onConfirm:H},null,8,["options"]),a(ie,{options:v.value},null,8,["options"])]),_:1}))}};export{Ke as default};
