import{u as A,k as D,x as Y,r as d,Q as q,c as v,w as i,V as Q,o as r,a as s,f as o,t as C,s as W,q as G,P as H,d as J,R as X,S as Z,M as ee,v as y,n as p,e as h,b as _,i as P,F as ae,C as te,T as le,g as I,h as z}from"./app-bd93c558.js";import{c as R}from"./clientApi-94de2a45.js";import{u as oe}from"./company-e80e79b0.js";import se from"./KpiProgress-e2e5f19b.js";import{_ as ie}from"./EmployeeCard-050cd511.js";import{_ as ne}from"./SnackBar-257cab0c.js";import"./printInitials-a54a9c4a.js";import"./mdi-5e26928d.js";const de={class:"v-col-12"},re={class:"text-h6"},ce={class:"v-col-12 v-col-md-3"},ue={class:"v-col-12 v-col-md-4"},me={class:"v-col-12 v-col-md-2"},ve={class:"v-col-12 v-col-md-3"},pe={class:"d-flex justify-space-between"},he=o("div",{class:"v-col-4"},null,-1),_e={class:"v-col-12 v-col-md-4 text-center"},ge={key:1,class:"text-caption text-center"},ye={class:"v-col-12 v-col-md-4 text-center"},fe={key:1,class:"text-caption text-center"},be={key:0,class:"v-col-12"},we={class:"v-col-12 v-col-md-3"},Ve={class:"v-col-12 v-col-md-8"},ke={class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},xe=o("div",{class:"text-caption text-grey"},"Total KPI",-1),Ce={key:1,class:"v-col-12"},ze={__name:"Employees",setup(Pe){const n=A(),S=D(),f=Y(),N=(l,a=null)=>{let e=a?Object.assign({},a):!1;S.push({name:l,params:e}).catch(c=>{})},O=l=>{let a=0;return l.reviews&&l.reviews.length>0&&l.reviews[0].key_review&&l.reviews[0].key_review.map((e,c)=>{a+=e.weightage}),a},b=oe(),g=d(!1),$=()=>{b.companies.length==0&&(g.value=!0,b.getCompanies(n.authToken).then(()=>{g.value=!1}))},w=d(!1),V=d(!1),L=()=>{let l={auth:n.authProfile.role,hrbp:n.authProfile.hrbp_email};R(n.authToken).post("/api/check-reviews/acount-validation",l).then(a=>{w.value=a.data.first_button,V.value=a.data.second_button}).catch(a=>{location.reload()})},F=d({}),T=l=>{let a={state:l,auth:n.authProfile.role,profile_id:n.authProfile.profile_id,hrbp:n.authProfile.hrbp_email};R(n.authToken).post("/api/hr-change/multitple-state",a).then(e=>{m(u.value),F.value={status:!0,type:"success",text:e.data.message}}).catch(e=>{location.reload()})},M=d([{value:1,title:"Regular"},{value:0,title:"Probation"}]),t=d({loadingReset:!1,loadingFilter:!1,data:{employee:null,company_id:null,is_regular:1}}),E=async()=>{t.value.loadingFilter=!0,m(1).then(()=>{t.value.loadingFilter=!1}).catch(l=>{t.value.loadingFilter=!1})},U=async()=>{t.value.data={employee:null,company_id:null,is_regular:1},t.value.loadingReset=!0,m(1).then(()=>{t.value.loadingReset=!1}).catch(l=>{t.value.loadingReset=!1})},k=d([]),x=d(0),K=d(0),u=d(f.params&&f.params.page?f.params.page:1),m=async l=>{let a="/api/hr/employees?&filter[is_regular]="+t.value.data.is_regular+"&filter[hrbp_email]="+n.authProfile.email;t.value.data.company_id!==null&&(a+="&filter[company_id]="+t.value.data.company_id),a+="&filter[employee]="+t.value.data.employee,a+="&page="+l,await R(n.authToken).get(a).then(e=>{var c,B;x.value=e.data.last_page,u.value=e.data.current_page,K.value=e.data.total,k.value=e.data.data,((B=(c=e==null?void 0:e.data)==null?void 0:c.data)==null?void 0:B.length)>0&&L()}).catch(e=>{location.reload()})};q(u,(l,a)=>{l!=a&&(S.push({name:"PaginatedEmployees",params:{page:u.value}}).catch(e=>{}),m(u.value))}),n.authToken&&m(u.value);const j=l=>{N("SingleEmployee",{ecode:l.ecode})};return(l,a)=>(r(),v(Q,{class:"pb-16"},{default:i(()=>[s(P,{class:"mt-5"},{default:i(()=>[o("div",de,[o("div",re,"Employee List "+C("("+K.value+")"),1)]),o("div",ce,[s(W,{modelValue:t.value.data.employee,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.data.employee=e),variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Input Employee",onKeydown:G(E,["enter"])},null,8,["modelValue","onKeydown"])]),o("div",ue,[s(H,{modelValue:t.value.data.company_id,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.data.company_id=e),items:J(b).active_companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:g.value?"Loading...":"Select Company",loading:g.value,clearable:"",onFocus:$},{selection:i(({props:e,item:c})=>[o("span",X(Z(e)),C(c.raw.title&&c.raw.title.length>20?c.raw.title.substring(0,20)+"...":c.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),o("div",me,[s(ee,{modelValue:t.value.data.is_regular,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.data.is_regular=e),items:M.value,"item-title":"title","item-value":"value",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),o("div",ve,[o("div",pe,[s(y,{onClick:U,height:"40px",variant:"text",color:"primary",class:"bg-grey-lighten-2 text-capitalize",loading:t.value.loadingReset,style:{width:"48%"}},{default:i(()=>[p("Reset")]),_:1},8,["loading"]),s(y,{onClick:E,height:"40px",color:"secondary",class:"text-capitalize",loading:t.value.loadingFilter,style:{width:"48%"}},{default:i(()=>[p("Search")]),_:1},8,["loading"])])]),he,o("div",_e,[w.value?(r(),v(y,{key:0,color:"primary",size:"small",onClick:a[3]||(a[3]=e=>T("midyear"))},{default:i(()=>[p("Change KPI`s to Mid Year/ First Review")]),_:1})):h("",!0),w.value?(r(),_("div",ge,"(Only Submitted KPIs - Regular / Probation)")):h("",!0)]),o("div",ye,[V.value?(r(),v(y,{key:0,color:"primary",size:"small",onClick:a[4]||(a[4]=e=>T("yearend"))},{default:i(()=>[p("Change KPI`s to Year End/ Final Review")]),_:1})):h("",!0),V.value?(r(),_("div",fe,"(Only Mid-Year Submitted KPIs - Regular / Probation)")):h("",!0)])]),_:1}),s(P,null,{default:i(()=>[k.value.length>0?(r(),_("div",be,[(r(!0),_(ae,null,te(k.value,e=>(r(),v(I,{key:e.id,class:"mb-3 elevation-0",onClick:()=>j(e)},{default:i(()=>[s(z,null,{default:i(()=>[s(P,null,{default:i(()=>[o("div",we,[s(ie,{profile:e},null,8,["profile"])]),o("div",Ve,[s(se,{density:"compact","selected-employee":e},null,8,["selected-employee"])]),o("div",ke,[o("div",null,[o("div",null,C(O(e))+" /100",1),xe])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),x.value>1?(r(),v(le,{key:0,modelValue:u.value,"onUpdate:modelValue":a[5]||(a[5]=e=>u.value=e),class:"my-4",length:x.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):h("",!0)])):(r(),_("div",Ce,[s(I,null,{default:i(()=>[s(z,{class:"text-center"},{default:i(()=>[p(" No records found ")]),_:1})]),_:1})]))]),_:1}),s(ne,{options:F.value},null,8,["options"])]),_:1}))}};export{ze as default};
