import{u as D,z as E,L as S,r as c,O as U,l as L,c as C,w as l,V as G,o as p,a,f as o,g as k,B as H,H as g,Z as z,d as P,a3 as K,b as w,F as M,n as Z,e as b,h as q,C as _,R as J,i as I,A as h,G as Q,K as W,I as X}from"./app-6f483914.js";import{c as Y,f as tt}from"./mdi-5e26928d.js";import{c as T}from"./clientApi-1c160f7d.js";import{_ as et}from"./PageHeader-b197dd6d.js";import{_ as at}from"./ConfirmDialog-ede04e7b.js";import{_ as st}from"./SnackBar-ea66d07d.js";import{_ as lt}from"./ImportData-3b36bd67.js";import"./_commonjsHelpers-042e6b4d.js";import"./industry-b0bbe113.js";const ot={class:"v-col-12"},it=o("div",{class:"text-primary text-capitalize"},"Industries",-1),nt=o("thead",null,[o("tr",null,[o("th",{class:"text-left text-capitalize"},"Title"),o("th",{class:"text-center text-capitalize"},"Status"),o("th",{class:"text-right text-capitalize"},"Actions")])],-1),ut={key:0},rt={class:"text-center"},dt={class:"d-flex align-center justify-end"},ct={class:X("v-col-12 px-4")},vt={class:"v-col-12"},pt={class:"v-col-12 py-0"},mt={class:"v-col-12 d-flex justify-end"},bt={__name:"Industries",setup(ft){const m=D(),R=E(),x=S(),u=c({}),y=c({cardTitle:"Import Industries",endpoint:"/api/import/industries",templateFile:"import-template-industries.csv"}),B=e=>{e.status==!0?f(1).then(()=>{u.value={status:!0,type:"success",text:e.message},y.value={...y.value,loading:!1,dialog:!1}}):u.value={status:!0,type:"error",text:e.message}},v=c([]),s=c({title:"",data:{},loading:!1,dialog:!1,action:"add"}),V=c(0),n=c(x.params&&x.params.page?x.params.page:1),f=async e=>{await T(m.authToken).get("/api/hr/industries?page="+e).then(t=>{V.value=t.data.last_page,n.value=t.data.current_page,v.value=t.data.data}).catch(t=>{console.log("industries",t)})},O=async()=>{let e={profile_id:m.authProfile.id,id:s.value.action=="edit"?s.value.data.id:null,title:s.value.data.title};s.value.loading=!0,await T(m.authToken).post("/api/hr/industry/save",e).then(t=>{f(n.value).then(()=>{s.value.loading=!1,s.value.dialog=!1,u.value={status:!0,type:"success",text:t.data.message}})}).catch(t=>{s.value.loading=!1,console.log("industries",t),t.response.data.message.includes("Duplicate entry")==!0?u.value={status:!0,type:"error",text:e.title+" already exist"}:u.value={status:!0,type:"error",text:"Error while saving industry"}})},A=()=>{s.value={...s.value,title:"Add Industry",data:{},dialog:!0,action:"add"}},F=e=>{s.value={...s.value,title:"Edit "+e.title,data:Object.assign({},e),dialog:!0,action:"edit"}};U(n,(e,t)=>{e!=t&&(R.push({name:"PaginatedIndustries",params:{page:n.value}}).catch(i=>{}),f(n.value))}),L(()=>{f(n.value)});const r=c({}),d=c({}),N=e=>{d.value=Object.assign({},e),d.value.new_status=d.value.status=="active"?"inactive":"active",r.value={dialog:!0,title:"Confirm",text:"Please confirm that you want to update the status of "+e.title+" to "+d.value.new_status+".",btnColor:d.value.new_status=="active"?"success":"error",btnTitle:d.value.new_status}},$=async()=>{let e={status:d.value.new_status,profile_id:m.authProfile.id};await T(m.authToken).post("/api/hr/industry/update-status/"+d.value.id,e).then(t=>{f(n.value).then(()=>{u.value={status:!0,type:"success",text:t.data.message}})}).catch(t=>{u.value={status:!0,type:"error",text:"Error while removing data"}})},j=e=>{r.value={...r.value,loading:!0},$().then(t=>{r.value={...r.value,dialog:!1,loading:!1}}).catch(t=>{r.value={...r.value,loading:!1}})};return(e,t)=>(p(),C(G,{class:"pb-16"},{default:l(()=>[a(et,{title:"Industries"}),a(I,{class:"my-5"},{default:l(()=>[o("div",ot,[a(lt,{options:y.value,onImported:B,class:"mb-3"},null,8,["options"]),a(k,{class:"rounded-lg"},{default:l(()=>[a(H,{class:"d-flex align-center"},{default:l(()=>[a(g,{onClick:A,density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:l(()=>[a(z,{size:"small",icon:P(Y)},null,8,["icon"])]),_:1}),it]),_:1}),a(K,null,{default:l(()=>[nt,v.value&&v.value.length>0?(p(),w("tbody",ut,[(p(!0),w(M,null,Z(v.value,i=>(p(),w("tr",{key:i.id},[o("td",null,h(i.title),1),o("td",rt,[a(g,{size:"small",onClick:()=>N(i),color:i.status=="active"?"success":"error",class:"mx-1 rounded-xl"},{default:l(()=>[_(h(i.status),1)]),_:2},1032,["onClick","color"])]),o("td",null,[o("div",dt,[a(z,{size:"small",onClick:()=>F(i),icon:P(tt),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])):b("",!0)]),_:1}),v.value&&v.value.length==0?(p(),C(k,{key:0},{default:l(()=>[a(q,{class:"text-center"},{default:l(()=>[_(" No records found ")]),_:1})]),_:1})):b("",!0)]),_:1}),V.value>1?(p(),C(J,{key:0,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),class:"my-4",length:V.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):b("",!0)])]),_:1}),a(W,{modelValue:s.value.dialog,"onUpdate:modelValue":t[3]||(t[3]=i=>s.value.dialog=i),width:"100%","max-width":"480px",persistent:""},{default:l(()=>[a(k,{class:"rounded-lg"},{default:l(()=>[a(I,{class:"ma-0 pa-0"},{default:l(()=>[o("div",ct,[a(I,null,{default:l(()=>[o("div",vt,h(s.value.title)+" "+h(),1),o("div",pt,[a(Q,{modelValue:s.value.data.title,"onUpdate:modelValue":t[1]||(t[1]=i=>s.value.data.title=i),label:"Industry*",variant:"outlined",density:"compact"},null,8,["modelValue"])]),o("div",mt,[a(g,{onClick:t[2]||(t[2]=i=>s.value.dialog=!1),color:"primary",variant:"text"},{default:l(()=>[_("Cancel")]),_:1}),a(g,{color:"primary",loading:s.value.loading,class:"ml-2 px-8",onClick:O},{default:l(()=>[_("save")]),_:1},8,["loading"])])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(at,{options:r.value,onConfirm:j},null,8,["options"]),a(st,{options:u.value},null,8,["options"])]),_:1}))}};export{bt as default};
