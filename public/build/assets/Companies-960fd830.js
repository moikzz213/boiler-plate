import{u as D,z as I,K as S,r,N as U,l as G,c as h,w as s,V as H,o as m,a as t,f as o,g as y,B as J,H as x,X as C,d as V,a2 as K,b as k,F as L,n as M,e as b,h as Q,C as w,Q as X,i as T,A as z,G as Y,J as q,Y as W}from"./app-d2fb1262.js";import{c as Z,e as aa,f as ea}from"./mdi-a0a77bee.js";import{c as R}from"./clientApi-2b4a321a.js";import{_ as ta}from"./PageHeader-4dc07963.js";import{_ as la}from"./ConfirmDialog-c3dbd728.js";import{_ as sa}from"./SnackBar-28e14e9f.js";import{_ as oa}from"./ImportData-488bb4fd.js";import"./_commonjsHelpers-042e6b4d.js";import"./industry-cdd62490.js";const na={class:"v-col-12"},ia=o("div",{class:"text-primary text-capitalize"},"Companies",-1),ua=o("thead",null,[o("tr",null,[o("th",{class:"text-left text-capitalize"},"Title"),o("th",{class:"text-right text-capitalize"},"Actions")])],-1),ra={key:0},ca={class:"d-flex align-center justify-end"},da={class:W("v-col-12 px-4")},ma={class:"v-col-12"},pa={class:"v-col-12 py-0"},va={class:"v-col-12 d-flex justify-end"},wa={__name:"Companies",setup(fa){const v=D(),B=I(),f=S(),c=r({}),g=r({cardTitle:"Import companies",endpoint:"/api/import/companies",templateFile:"import-template-companies.csv"}),N=e=>{e.status==!0?p(1).then(()=>{c.value={status:!0,type:"success",text:e.message},g.value={...g.value,loading:!1,dialog:!1}}):c.value={status:!0,type:"error",text:e.message}},d=r([]),l=r({title:"",data:{},loading:!1,dialog:!1,action:"add"}),_=r(0),i=r(f.params&&f.params.page?f.params.page:1),p=async e=>{await R(v.authToken).get("/api/hr/companies?page="+e).then(a=>{_.value=a.data.last_page,i.value=a.data.current_page,d.value=a.data.data}).catch(a=>{console.log("companies",a)})},A=async()=>{let e={id:l.value.action=="edit"?l.value.data.id:null,title:l.value.data.title};l.value.loading=!0,await R(v.authToken).post("/api/hr/company/save",e).then(a=>{p(i.value).then(()=>{l.value.loading=!1,l.value.dialog=!1,c.value={status:!0,type:"success",text:a.data.message}})}).catch(a=>{l.value.loading=!1,console.log("companies",a),c.value={status:!0,type:"error",text:"Error while saving company"}})},F=()=>{l.value={...l.value,title:"Add Company",data:{},dialog:!0,action:"add"}},O=e=>{l.value={...l.value,title:"Edit "+e.title,data:Object.assign({},e),dialog:!0,action:"edit"}};U(i,(e,a)=>{e!=a&&(B.push({name:"PaginatedCompanies",params:{page:i.value}}).catch(n=>{}),p(i.value))}),G(()=>{p(i.value)});const u=r({}),P=r({}),$=e=>{P.value=Object.assign({},e),u.value={dialog:!0,title:"Confirm Remove",text:"Please confirm that you want to remove "+e.title+".",btnColor:"error",btnTitle:"Confirm"}},j=async()=>{await R(v.authToken).post("/api/hr/company/remove/"+P.value.id).then(e=>{p(i.value).then(()=>{c.value={status:!0,type:"success",text:e.data.message}})}).catch(e=>{c.value={status:!0,type:"error",text:"Error while removing data"}})},E=e=>{u.value={...u.value,loading:!0},j().then(a=>{u.value={...u.value,dialog:!1,loading:!1}}).catch(a=>{u.value={...u.value,loading:!1}})};return(e,a)=>(m(),h(H,{class:"pb-16"},{default:s(()=>[t(ta,{title:"Companies"}),t(T,{class:"my-5"},{default:s(()=>[o("div",na,[t(oa,{options:g.value,onImported:N,class:"mb-3"},null,8,["options"]),t(y,{class:"rounded-lg"},{default:s(()=>[t(J,{class:"d-flex align-center"},{default:s(()=>[t(x,{onClick:F,density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:s(()=>[t(C,{size:"small",icon:V(Z)},null,8,["icon"])]),_:1}),ia]),_:1}),t(K,null,{default:s(()=>[ua,d.value&&d.value.length>0?(m(),k("tbody",ra,[(m(!0),k(L,null,M(d.value,n=>(m(),k("tr",{key:n.id},[o("td",null,z(n.title),1),o("td",null,[o("div",ca,[t(C,{size:"small",onClick:()=>O(n),icon:V(aa),class:"mx-1"},null,8,["onClick","icon"]),t(C,{size:"small",onClick:()=>$(n),icon:V(ea),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])):b("",!0)]),_:1}),d.value&&d.value.length==0?(m(),h(y,{key:0},{default:s(()=>[t(Q,{class:"text-center"},{default:s(()=>[w(" No records found ")]),_:1})]),_:1})):b("",!0)]),_:1}),_.value>1?(m(),h(X,{key:0,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=n=>i.value=n),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):b("",!0)])]),_:1}),t(q,{modelValue:l.value.dialog,"onUpdate:modelValue":a[3]||(a[3]=n=>l.value.dialog=n),width:"100%","max-width":"480px",persistent:""},{default:s(()=>[t(y,{class:"rounded-lg"},{default:s(()=>[t(T,{class:"ma-0 pa-0"},{default:s(()=>[o("div",da,[t(T,null,{default:s(()=>[o("div",ma,z(l.value.title)+" "+z(),1),o("div",pa,[t(Y,{modelValue:l.value.data.title,"onUpdate:modelValue":a[1]||(a[1]=n=>l.value.data.title=n),label:"Company*",variant:"outlined",density:"compact"},null,8,["modelValue"])]),o("div",va,[t(x,{color:"primary",variant:"text",onClick:a[2]||(a[2]=n=>l.value.dialog=!1)},{default:s(()=>[w("Cancel")]),_:1}),t(x,{color:"primary",loading:l.value.loading,class:"ml-2 px-8",onClick:A},{default:s(()=>[w("save")]),_:1},8,["loading"])])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(la,{options:u.value,onConfirm:E},null,8,["options"]),t(sa,{options:c.value},null,8,["options"])]),_:1}))}};export{wa as default};
