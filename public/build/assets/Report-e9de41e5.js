import{k as b,u as N,r as d,c as V,w as o,V as S,o as u,a as i,f as t,d as I,J as F,H as C,C as T,i as g,g as B,h as E,a2 as R,b as v,F as A,n as z,A as n,I as L}from"./app-8b546cee.js";import{c as P}from"./clientApi-a315db1b.js";import{e as D}from"./vue-datepicker-e1c90acd.js";import"./typeof-7fd5df1e.js";import"./defineProperty-fcf2a4a8.js";const O={class:"v-col-12 v-col-md-2"},U={class:"v-col-12 v-col-md-2"},G={class:"v-col-12 v-col-md-3"},H={class:"d-flex justify-space-between"},J={class:"v-col-12"},Y=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"#"),t("th",{class:"text-center"},"Entity"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Locked"),t("th",{class:"text-center"},"Open"),t("th",{class:"text-center"},"InProgress"),t("th",{class:"text-center"},"InReview"),t("th",{class:"text-center"},"Submitted")])],-1),$={key:0},q={class:"text-center"},K={class:"text-center"},M={class:"text-center text-capitalize py-2"},Q={class:"text-center"},W={class:"text-center"},X={class:"text-center"},Z={class:"text-center"},j={class:"text-center"},ee={key:1},te=t("tr",null,[t("td",{colspan:"8",class:"text-center"},"No record found.")],-1),se=[te],oe={__name:"Report",setup(ae){const f=b(),_=N(),p=d(new Date().getFullYear()),y=d([{value:1,title:"Regular"},{value:0,title:"Probation"}]),r=d({loadingFilter:!1,data:{company_id:null,is_regular:1}}),k=async()=>{r.value.loadingFilter=!0,w().then(()=>{r.value.loadingFilter=!1}).catch(l=>{r.value.loadingFilter=!1})},m=d([]),h=d([]),c=d([]),w=async()=>{let l="/api/reports/business-entity/kpi-employees?&filter[is_regular]="+r.value.data.is_regular+"&year="+p.value+"&filter[hrbp_email]="+_.authProfile.email;await P(_.authToken).get(l).then(e=>{m.value=e.data,e.data&&e.data.length>0&&(e.data.map((s,a)=>{h.value.includes(s.company_id)||(h.value.push(s.company_id),c.value.push({id:s.company_id,title:s.company.title}))}),x())}).catch(e=>{console.log("getEmployees",e)})},x=()=>{let l={};c.value&&c.value.length>0&&c.value.map((e,s)=>{l=f.filterAllSettings(e.id,p.value),l.state?(e.state=l.state,e.status=l.status,e.sort=s):(e.state="no-setting",e.status="locked",e.sort=99),e.lock="-",e.open="-",e.inprogress="-",e.inreview="-",e.submitted="-",m.value.map(a=>{a.company_id==e.id&&(a.reviews.length>0?a.reviews[0].status&&(a.reviews[0].status=="locked"||a.reviews[0].status=="closed")?(e.lock=isNaN(e.lock)?0:e.lock,e.lock=parseInt(e.lock)+1):a.reviews[0].status&&a.reviews[0].status=="open"?(e.open=isNaN(e.open)?0:e.open,e.open=parseInt(e.open)+1):a.reviews[0].status&&a.reviews[0].status=="inprogress"?(e.inprogress=isNaN(e.inprogress)?0:e.inprogress,e.inprogress=parseInt(e.inprogress)+1):a.reviews[0].status&&a.reviews[0].status=="inreview"?(e.inreview=isNaN(e.inreview)?0:e.inreview,e.inreview=parseInt(e.inreview)+1):a.reviews[0].status&&a.reviews[0].status=="submitted"&&(e.submitted=isNaN(e.submitted)?0:e.submitted,e.submitted=parseInt(e.submitted)+1):e.state=="no-setting"||e.status=="closed"||e.status=="locked"?(e.lock=isNaN(e.lock)?0:e.lock,e.lock=parseInt(e.lock)+1):(e.open=isNaN(e.open)?0:e.open,e.open=parseInt(e.open)+1))})}),c.value.sort((e,s)=>e.sort-s.sort)};return(l,e)=>(u(),V(S,{class:"pb-16"},{default:o(()=>[i(g,{class:"mt-5"},{default:o(()=>[t("div",O,[i(I(D),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),t("div",U,[i(F,{modelValue:r.value.data.is_regular,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.data.is_regular=s),items:y.value,"item-title":"title","item-value":"value",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),t("div",G,[t("div",H,[i(C,{onClick:k,height:"40px",color:"secondary",class:"text-capitalize",loading:r.value.loadingFilter},{default:o(()=>[T("Generate Report")]),_:1},8,["loading"])])])]),_:1}),i(g,null,{default:o(()=>[t("div",J,[i(B,{class:"mb-3 elevation-0"},{default:o(()=>[i(E,null,{default:o(()=>[i(R,{density:"compact"},{default:o(()=>[Y,c.value.length>0?(u(),v("tbody",$,[(u(!0),v(A,null,z(c.value,(s,a)=>(u(),v("tr",{key:s.id},[t("td",q,n(a+=1),1),t("td",K,n(s.title),1),t("td",M,[t("span",{class:L(`${s.state=="no-setting"?"text-error":"text-info"}`)},n(s.state=="no-setting"?"( No Setting )":"( "+s.state+" - "+s.status+" )"),3)]),t("td",Q,n(s.lock),1),t("td",W,n(s.open),1),t("td",X,n(s.inprogress),1),t("td",Z,n(s.inreview),1),t("td",j,n(s.submitted),1)]))),128))])):(u(),v("tbody",ee,se))]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}))}};export{oe as default};
