import{u as z,z as A,L as K,r as d,O as U,c as h,w as i,V as j,o as u,a as s,f as o,A as f,G as O,E as I,N as $,d as D,P as G,Q as H,J,H as R,C as V,i as w,b,F as Q,n as W,R as q,e as M,g as E,h as F}from"./app-ac939634.js";import{c as X}from"./clientApi-fa3ef3a0.js";import{u as Y}from"./company-7344ce4e.js";import Z from"./KpiProgress-819fac12.js";import{_ as ee}from"./EmployeeCard-0b989277.js";import"./printInitials-a54a9c4a.js";import"./mdi-5e26928d.js";const ae={class:"v-col-12"},le={class:"text-h6"},te={class:"v-col-12 v-col-md-3"},oe={class:"v-col-12 v-col-md-4"},se={class:"v-col-12 v-col-md-2"},ie={class:"v-col-12 v-col-md-3"},ne={class:"d-flex justify-space-between"},de={key:0,class:"v-col-12"},ce={class:"v-col-12 v-col-md-3"},ue={class:"v-col-12 v-col-md-8"},re={class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},me=o("div",{class:"text-caption text-grey"},"Total KPI",-1),ve={key:1,class:"v-col-12"},be={__name:"Employees",setup(pe){const r=z(),x=A(),p=K(),P=(t,a=null)=>{let e=a?Object.assign({},a):!1;x.push({name:t,params:e}).catch(c=>{})},S=t=>{let a=0;return t.reviews&&t.reviews.length>0&&t.reviews[0].key_review&&t.reviews[0].key_review.map((e,c)=>{a+=e.weightage}),a},g=Y(),m=d(!1),T=()=>{g.companies.length==0&&(m.value=!0,g.getCompanies(r.authToken).then(()=>{m.value=!1}))},N=d([{value:1,title:"Regular"},{value:0,title:"Probation"}]),l=d({loadingReset:!1,loadingFilter:!1,data:{employee:null,company_id:null,is_regular:1}}),k=async()=>{l.value.loadingFilter=!0,v(1).then(()=>{l.value.loadingFilter=!1}).catch(t=>{l.value.loadingFilter=!1})},B=async()=>{l.value.data={employee:null,company_id:null,is_regular:1},l.value.loadingReset=!0,v(1).then(()=>{l.value.loadingReset=!1}).catch(t=>{l.value.loadingReset=!1})},y=d([]),_=d(0),C=d(0),n=d(p.params&&p.params.page?p.params.page:1),v=async t=>{let a="/api/hr/employees?&filter[is_regular]="+l.value.data.is_regular+"&filter[hrbp_email]="+r.authProfile.email;l.value.data.company_id!==null&&(a+="&filter[company_id]="+l.value.data.company_id),a+="&filter[employee]="+l.value.data.employee,a+="&page="+t,await X(r.authToken).get(a).then(e=>{_.value=e.data.last_page,n.value=e.data.current_page,C.value=e.data.total,y.value=e.data.data}).catch(e=>{console.log("getEmployees",e)})};U(n,(t,a)=>{t!=a&&(x.push({name:"PaginatedEmployees",params:{page:n.value}}).catch(e=>{}),v(n.value))}),r.authToken&&v(n.value);const L=t=>{console.log("profile",t),P("SingleEmployee",{ecode:t.ecode})};return(t,a)=>(u(),h(j,{class:"pb-16"},{default:i(()=>[s(w,{class:"mt-5"},{default:i(()=>[o("div",ae,[o("div",le,"Employee List "+f("("+C.value+")"),1)]),o("div",te,[s(O,{modelValue:l.value.data.employee,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value.data.employee=e),variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Input Employee",onKeydown:I(k,["enter"])},null,8,["modelValue","onKeydown"])]),o("div",oe,[s($,{modelValue:l.value.data.company_id,"onUpdate:modelValue":a[1]||(a[1]=e=>l.value.data.company_id=e),items:D(g).active_companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:m.value?"Loading...":"Select Company",loading:m.value,clearable:"",onFocus:T},{selection:i(({props:e,item:c})=>[o("span",G(H(e)),f(c.raw.title&&c.raw.title.length>20?c.raw.title.substring(0,20)+"...":c.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),o("div",se,[s(J,{modelValue:l.value.data.is_regular,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value.data.is_regular=e),items:N.value,"item-title":"title","item-value":"value",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),o("div",ie,[o("div",ne,[s(R,{onClick:B,height:"40px",variant:"text",color:"primary",class:"bg-grey-lighten-2 text-capitalize",loading:l.value.loadingReset,style:{width:"48%"}},{default:i(()=>[V("Reset")]),_:1},8,["loading"]),s(R,{onClick:k,height:"40px",color:"secondary",class:"text-capitalize",loading:l.value.loadingFilter,style:{width:"48%"}},{default:i(()=>[V("Search")]),_:1},8,["loading"])])])]),_:1}),s(w,null,{default:i(()=>[y.value.length>0?(u(),b("div",de,[(u(!0),b(Q,null,W(y.value,e=>(u(),h(E,{key:e.id,class:"mb-3 elevation-0",onClick:()=>L(e)},{default:i(()=>[s(F,null,{default:i(()=>[s(w,null,{default:i(()=>[o("div",ce,[s(ee,{profile:e},null,8,["profile"])]),o("div",ue,[s(Z,{density:"compact","selected-employee":e},null,8,["selected-employee"])]),o("div",re,[o("div",null,[o("div",null,f(S(e))+" /100",1),me])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),_.value>1?(u(),h(q,{key:0,modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value=e),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):M("",!0)])):(u(),b("div",ve,[s(E,null,{default:i(()=>[s(F,{class:"text-center"},{default:i(()=>[V(" No records found ")]),_:1})]),_:1})]))]),_:1})]),_:1}))}};export{be as default};
