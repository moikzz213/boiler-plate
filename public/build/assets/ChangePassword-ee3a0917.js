import{x as $,u as A,r as f,P as b,o as w,c as x,w as n,a as e,m as z,n as _,t as F,h as B,d as y,s as r,y as P,L as R,v as E,e as N,g as D,i as T,f as v,b as j}from"./app-cd5d535f.js";import{d as h,u as O,c as I,a as S,b as q,F as L}from"./index.esm-ad92a975.js";import{c as G}from"./clientApi-8a9bbd48.js";import{_ as H}from"./SnackBar-1113efc5.js";const ma={__name:"AccountForm",props:["user"],emits:["saved"],setup(V,{emit:c}){const a=V,p=$(),t=A(),s=f(["normal","hrbp","hr_admin"]),l=f({loading:!1,data:Object.assign({},a.user)});b(()=>a.user,o=>{l.value.data=o});const U=async o=>{let u={enable:!1,role:l.value.data.role,ecode:l.value.data.ecode,author:t.authProfile.id};if(o){let i="Active";o=="Active"&&(i="Inactive"),u={enable:i,ecode:l.value.data.ecode,author:t.authProfile.id}}l.value.loading=!0,await G(t.authToken).post("/api/admin/account/save",u).then(i=>{c("saved",i.data.message),l.value.loading=!1}).catch(i=>{l.value.loading=!1})};return(o,u)=>(w(),x(D,null,{default:n(()=>[e(z,{class:"text-primary text-capitalize mb-3"},{default:n(()=>[_("Account - "+F(l.value.data.status),1)]),_:1}),e(B,null,{default:n(()=>[e(y(h),{name:"username",modelValue:l.value.data.username,"onUpdate:modelValue":u[1]||(u[1]=i=>l.value.data.username=i)},{default:n(({field:i,errors:d})=>[e(r,P(i,{modelValue:l.value.data.username,"onUpdate:modelValue":u[0]||(u[0]=m=>l.value.data.username=m),label:"Username",variant:"outlined",density:"compact","error-messages":d,readonly:""}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"]),e(y(h),{name:"role",modelValue:l.value.data.role,"onUpdate:modelValue":u[3]||(u[3]=i=>l.value.data.role=i)},{default:n(({field:i,errors:d})=>[e(R,P({disabled:y(p).name!="EditUser",modelValue:l.value.data.role,"onUpdate:modelValue":u[2]||(u[2]=m=>l.value.data.role=m)},i,{items:s.value,label:"Role",variant:"outlined",density:"compact",class:"mb-2","error-messages":d}),null,16,["disabled","modelValue","items","error-messages"])]),_:1},8,["modelValue"]),y(p).name=="EditUser"?(w(),x(E,{key:0,color:"primary",size:"small",loading:l.value.loading,onClick:u[4]||(u[4]=()=>U())},{default:n(()=>[_("Save")]),_:1},8,["loading"])):N("",!0),y(p).name=="EditUser"?(w(),x(E,{key:1,class:"ml-3",color:l.value.data.status=="Inactive"?"success":"error",size:"small",loading:l.value.loading,onClick:u[5]||(u[5]=()=>U(l.value.data.status))},{default:n(()=>[_(F(l.value.data.status=="Inactive"?"Enable Employee":"Disable Employee"),1)]),_:1},8,["color","loading"])):N("",!0)]),_:1})]),_:1}))}},J={class:"v-col-12 v-col-md-6 py-0"},K={class:"v-col-12 v-col-md-6 py-0"},M={class:"v-col-12 v-col-md-6 py-0"},Q={class:"v-col-12 v-col-md-6 py-0"},W={class:"v-col-12 v-col-md-6 py-0"},X={class:"v-col-12 v-col-md-6 py-0"},Y={class:"v-col-12 v-col-md-6 py-0"},Z={class:"v-col-12 v-col-md-6 py-0"},aa={class:"v-col-12 v-col-md-6 py-0"},ea={class:"v-col-12 v-col-md-6 py-0"},la={class:"v-col-12 v-col-md-6 py-0"},oa={class:"v-col-12 v-col-md-6 py-0"},ta={class:"v-col-12 v-col-md-6 py-0"},sa={class:"v-col-12 v-col-md-6 py-0"},va={__name:"ProfileForm",props:["user"],setup(V){const c=V,a=f({loading:!1,data:Object.assign({},c.user),company:{title:c.user.company?c.user.company.title:""}});return b(()=>c.user,(p,t)=>{p!=t&&(a.value.data=Object.assign({},p),a.value.company=p.company)}),(p,t)=>(w(),x(D,null,{default:n(()=>[e(z,{class:"text-primary text-capitalize mb-3"},{default:n(()=>[_("Profile Settings")]),_:1}),e(B,null,{default:n(()=>[e(T,{class:"py-3"},{default:n(()=>[v("div",J,[e(r,{modelValue:a.value.data.display_name,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.data.display_name=s),label:"Full name",variant:"outlined",density:"compact",readonly:""},null,8,["modelValue"])]),v("div",K,[e(r,{modelValue:a.value.data.ecode,"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.data.ecode=s),label:"Ecode",variant:"outlined",density:"compact",readonly:""},null,8,["modelValue"])]),v("div",M,[e(r,{modelValue:a.value.data.email,"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.data.email=s),label:"Email",variant:"outlined",density:"compact",readonly:""},null,8,["modelValue"])]),v("div",Q,[e(r,{label:"Employee Type","model-value":a.value.data.is_regular?"Regular":"Probation",variant:"outlined",density:"compact",readonly:""},null,8,["model-value"])]),v("div",W,[e(r,{modelValue:a.value.company.title,"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.company.title=s),label:"Company",variant:"outlined",density:"compact",readonly:""},null,8,["modelValue"])]),v("div",X,[e(r,{readonly:"",label:"Designation",modelValue:a.value.data.designation,"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.data.designation=s),variant:"outlined",density:"compact"},null,8,["modelValue"])]),v("div",Y,[e(r,{readonly:"",label:"Department",modelValue:a.value.data.department,"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.data.department=s),variant:"outlined",density:"compact"},null,8,["modelValue"])]),v("div",Z,[e(r,{readonly:"",type:"date",label:"Date of Birth","model-value":a.value.data.dob,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",aa,[e(r,{readonly:"",type:"date",label:"Date Joined","model-value":a.value.data.doj,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",ea,[e(r,{readonly:"",label:"Nationality","model-value":a.value.data.nationality,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",la,[e(r,{readonly:"",label:"Grade","model-value":a.value.data.grade_original?a.value.data.grade_original:a.value.data.grade,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",oa,[e(r,{readonly:"",label:"Equivalent Grade","model-value":a.value.data.grade,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",ta,[e(r,{readonly:"",label:"Reporting to","model-value":`${a.value.data.managed_by&&a.value.data.managed_by.display_name?a.value.data.managed_by.display_name+" ("+a.value.data.managed_by.ecode+")":"N/A"}
            `,variant:"outlined",density:"compact"},null,8,["model-value"])]),v("div",sa,[e(r,{readonly:"",label:"HRBP",modelValue:a.value.data.hrbp_email,"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.data.hrbp_email=s),variant:"outlined",density:"compact"},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1}))}},da={class:"d-flex align-center"},ca={__name:"ChangePassword",props:["user"],setup(V){const c=V,a=$(),p=f("performance-management-system"),t=f("https://users.moikzz.tech"),s=f({status:!1,type:"",text:""}),l=f(!0),U=O(),o=f({status:!1,loading:!1,data:{username:"",password:"",password_confirmation:"",url:p.value}}),u=I({password:S().min(5).required(),password_confirmation:S().required().oneOf([q("password")],"Passwords do not match")}),i=async()=>{o.value.loading=!0,o.value.data.username=c.user?c.user.ecode:a.params.ecode,await axios.post(t.value+"/api/application/reset-password",o.value.data).then(d=>{o.value={status:!1,loading:!1,data:{username:c.user?c.user.ecode:a.params.ecode,password:"11111111111111111111111",password_confirmation:"11111111111111111111111"}},s.value={status:!0,type:"success",text:d.data.msg}}).catch(d=>{console.log(d),o.value.loading=!1,s.value={status:!0,type:"error",text:"Error while updating password"},console.log(d.response.data)})};return b(()=>c.user,(d,m)=>{d!=m&&(o.value.data.username=Object.assign({},d.ecode))}),b(()=>o.value.data.password,d=>{console.log(U.value),d&&d==o.value.data.password_confirmation?l.value=!1:l.value=!0}),b(()=>o.value.data.password_confirmation,(d,m)=>{d&&d==o.value.data.password?l.value=!1:l.value=!0}),(d,m)=>(w(),j("div",null,[e(D,{loading:o.value.loading},{default:n(()=>[e(z,{class:"text-primary text-capitalize mb-3"},{default:n(()=>[_(" Change password ")]),_:1}),e(B,null,{default:n(()=>[e(y(L),{as:"v-form","validation-schema":y(u)},{default:n(()=>[e(y(h),{name:"password",modelValue:o.value.data.password,"onUpdate:modelValue":m[1]||(m[1]=g=>o.value.data.password=g)},{default:n(({field:g,errors:k})=>[e(r,P({modelValue:o.value.data.password,"onUpdate:modelValue":m[0]||(m[0]=C=>o.value.data.password=C)},g,{label:"Set New Password",type:"password",variant:"outlined",density:"compact","error-messages":k}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"]),e(y(h),{name:"password_confirmation",modelValue:o.value.data.password_confirmation,"onUpdate:modelValue":m[3]||(m[3]=g=>o.value.data.password_confirmation=g)},{default:n(({field:g,errors:k})=>[e(r,P({modelValue:o.value.data.password_confirmation,"onUpdate:modelValue":m[2]||(m[2]=C=>o.value.data.password_confirmation=C)},g,{label:"Confirm New Password",type:"password",variant:"outlined",density:"compact","error-messages":k}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"]),v("div",da,[e(E,{disabled:l.value,color:"primary",size:"large",onClick:i},{default:n(()=>[_(" Save ")]),_:1},8,["disabled"])])]),_:1},8,["validation-schema"])]),_:1})]),_:1},8,["loading"]),e(H,{options:s.value},null,8,["options"])]))}};export{ma as _,va as a,ca as b};
