import{r as p,N as K,o as c,b as V,a,w as n,g as z,i as $,f as t,Y as le,A as y,M as me,O as Ve,P as Ce,I as ae,G as D,Z as $e,$ as pe,a0 as te,H as b,C,e as h,c as k,J as ge,F as Q,z as Ie,K as Te,u as Re,k as Oe,L as q,d as P,X as U,B as fe,h as J,q as he,n as de,v as be}from"./app-3dd68769.js";import{b as De,c as re,d as je,e as Pe,f as ve,g as ce}from"./mdi-1daeeafa.js";import{e as Se}from"./vue-datepicker-ca4b0a6c.js";import{_ as ye}from"./SnackBar-53e4303c.js";const Ke={class:"v-col-12"},Ue={class:"v-col-12 v-col-md-6 py-0"},Ae={class:"v-col-12 v-col-md-6 py-0"},Fe={class:"v-col-12 v-col-md-3 py-0"},ze={class:"v-col-12 v-col-md-3 py-0"},Be={class:"v-col-12 v-col-md-3 py-0"},Le={class:"v-col-12 v-col-md-3 py-0"},Me={class:"v-col-12 py-0"},We={class:"v-col-12 pt-0"},Ee={class:"v-col-12 py-0"},Ne={class:"v-col-12 py-0"},Ye={class:"v-col-12 py-0"},He={class:"v-col-12 py-0 hidden hide",hidden:""},qe={class:"v-col-12 py-0"},Ge={key:0,class:"v-col-12 d-flex justify-end"},Je={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},Xe=t("div",{class:"v-col-12 px-1"},y("Review"),-1),Ze={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},Qe={class:"v-col-12 v-col-md-6 py-0 px-1"},et={class:"v-col-12 v-col-md-6 py-0 px-1"},tt={class:"v-col-12 v-col-md-6 py-0 px-1"},at={class:"v-col-12 v-col-md-6 py-0 px-1"},lt={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},st={class:"v-col-12 py-0 px-1"},it={class:"v-col-12 v-col-md-6 py-0 px-1"},nt={class:"v-col-12 v-col-md-6 py-0 px-1"},ot={class:"v-col-12 d-flex justify-end"},ut={__name:"KpiDialog",props:{kpiOptions:{type:Object,default:null},submitButton:{type:Boolean,default:!0},industryList:{type:Object,default:null},remainWeightage:{type:Number,default:70},measuresList:{type:Object,default:null},finalReview:{type:Boolean,default:!1}},emits:["savedResponse"],setup(O,{emit:A}){const x=O,F=p({}),g=p(["min","max"]),W=p([]),w=p(["5%","10%","15%","20%","25%","30%"]),S=p(null),e=p({}),u=p({measures:null}),I=p([]),B=p([]),T=p(""),r=p(""),m=p(""),_=p(!1),j=p(!0),R=p([]),X=()=>{_.value=!0,e.value.data=u.value,e.value.industryTitle=m.value,setTimeout(()=>{_.value=!1,e.value.dialog=!1,A("savedResponse",e.value)},1200),T.value=x.kpiOptions.data.industry},ee=()=>{e.value.dialog=!1,(e.value.action=="edit"||e.value.action=="review")&&(T.value=x.kpiOptions.data.industry,r.value=x.kpiOptions.data.title)},se=()=>{x.finalReview.isFinal?e.value.state="final":e.value.state="mid",X()};K(()=>x.kpiOptions,v=>{_.value=!1,B.value=x.industryList,console.log("listIndustries.value",B.value),u.value=Object.assign({},v.data),e.value=Object.assign({},v),e.value.action=="edit"||e.value.action=="review"||e.value.action=="readonly"?(T.value=v.data.industry,r.value=v.data.title,S.value=v.data.weightage,j.value=!1):(T.value=null,r.value=null,S.value=null,j.value=!0)}),K(()=>T.value,v=>{I.value=[],W.value=x.measuresList,e.value.action=="add"?(j.value=!0,u.value={},r.value=null,v&&(R.value.push("industry"),f(),m.value=v.title,B.value.map(l=>{l.id==v.id&&(I.value=l.kpis)}))):(R.value.push("industry"),j.value=!1)}),K(()=>r.value,v=>{if(e.value.action=="add"){u.value={};let l=I.value.filter(o=>o.id==v);l&&l.length>0&&(u.value=l[0],j.value=!1,R.value.push("kpi"),f())}else R.value.push("kpi")}),K(()=>u.value.weightage,v=>{let l=!1;if(!isNaN(v)||v==null||v==null)l=!1;else if(e.value.action=="add")parseInt(v)>x.remainWeightage?(l=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):l=!0;else{let o=parseInt(x.remainWeightage)+parseInt(S.value)-parseInt(v);parseInt(o)<0?(l=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):S.value>parseInt(v)||parseInt(o)>=0?l=!0:l=!1}l?(R.value.push("weightage"),f()):Y("weightage")});const f=()=>{R.value=R.value.filter((v,l)=>R.value.indexOf(v)===l)},Y=v=>{const l=R.value.indexOf(v);l>-1&&R.value.splice(l,1)};return K(()=>u.value.target,v=>{v?(R.value.push("target"),f()):Y("target")}),K(()=>u.value.measures,v=>{v?(R.value.push("measures"),f()):Y("measures")}),K(()=>u.value.target_type,v=>{R.value.push("target_type"),f(),v=="min"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Exceeding the Target</span> <br/><span style="color:red">Negative Ranking = Falling short of the Target</span>':v=="max"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Falling short of the Target</span> <br/><span style="color:red">Negative Ranking = Exceeding the Target</span>':(Y("target_type"),u.value.evaluation_pattern="")}),(v,l)=>(c(),V(Q,null,[a(ge,{modelValue:e.value.dialog,"onUpdate:modelValue":l[18]||(l[18]=o=>e.value.dialog=o),width:"100%","max-width":`${e.value.is_review==!0?"1240":"900"} `,persistent:""},{default:n(()=>[a(z,{class:"rounded-lg"},{default:n(()=>[a($,{class:"ma-0 pa-0"},{default:n(()=>[t("div",{class:le(`v-col-12 ${e.value.is_review==!0?"v-col-md-8":""} px-4`)},[a($,null,{default:n(()=>[t("div",Ke,y(e.value.title),1),t("div",Ue,[a(me,{modelValue:T.value,"onUpdate:modelValue":l[0]||(l[0]=o=>T.value=o),items:O.industryList,"item-title":"title","item-value":"title","return-object":"",disabled:e.value.action=="edit"||e.value.is_review,variant:"outlined",density:"compact",label:"Select Industry*"},null,8,["modelValue","items","disabled"])]),t("div",Ae,[a(me,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=o=>r.value=o),items:I.value,"item-title":"title","item-value":"id",variant:"outlined",disabled:e.value.action=="edit"||e.value.is_review,density:"compact",label:"Select KPI*"},{selection:n(({props:o,item:H})=>[t("span",Ve(Ce(o)),y((H==null?void 0:H.title.substring(0,35))+"..."),17)]),_:1},8,["modelValue","items","disabled"])]),t("div",Fe,[a(ae,{disabled:j.value||e.value.is_review,modelValue:u.value.target_type,"onUpdate:modelValue":l[2]||(l[2]=o=>u.value.target_type=o),items:g.value,label:"Target Type*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",ze,[a(D,{disabled:j.value||e.value.is_review,modelValue:u.value.target,"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.target=o),label:"Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",Be,[a(ae,{disabled:j.value||e.value.is_review,modelValue:u.value.measures,"onUpdate:modelValue":l[4]||(l[4]=o=>u.value.measures=o),items:W.value,label:"Measures*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Le,[a(ae,{disabled:j.value||e.value.is_review,modelValue:u.value.weightage,"onUpdate:modelValue":l[5]||(l[5]=o=>u.value.weightage=o),items:w.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Me,[a($,{class:"mx-0 mb-3"},{default:n(()=>[a($e,{class:"pa-3",style:{border:"1px solid #b1b1b1","border-radius":"5px","min-height":"70px"},innerHTML:u.value.evaluation_pattern},null,8,["innerHTML"])]),_:1})]),t("div",We,[a(pe,{class:"mx-auto"})]),t("div",Ee,[a(te,{modelValue:u.value.definition,"onUpdate:modelValue":l[6]||(l[6]=o=>u.value.definition=o),readonly:j.value||e.value.action=="edit"||e.value.is_review,label:"KPI Definition*",variant:"outlined",rows:"2"},null,8,["modelValue","readonly"])]),t("div",Ne,[a(te,{modelValue:u.value.formula,"onUpdate:modelValue":l[7]||(l[7]=o=>u.value.formula=o),readonly:"",label:"Calulation Formula*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",Ye,[a(te,{modelValue:u.value.subordinate_measures,"onUpdate:modelValue":l[8]||(l[8]=o=>u.value.subordinate_measures=o),readonly:"",label:"Subordinate Measures*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",He,[a(te,{modelValue:u.value.calculation_example,"onUpdate:modelValue":l[9]||(l[9]=o=>u.value.calculation_example=o),readonly:"",label:"KPI Calculation Example*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",qe,[a(pe,{class:"mx-auto"})]),e.value.is_review?h("",!0):(c(),V("div",Ge,[a(b,{color:"primary",variant:"text",onClick:ee},{default:n(()=>[C("Cancel")]),_:1}),a(b,{loading:_.value,disabled:R.value.length<6,color:"primary",class:"ml-2 px-8",onClick:X},{default:n(()=>[C("save")]),_:1},8,["loading","disabled"])]))]),_:1})],2),e.value.is_review?(c(),V("div",Je,[a($,{class:"px-3"},{default:n(()=>[Xe,t("div",Ze,y(e.value.is_regular?"Mid-year Achievement":"First Review Achievement"),1),t("div",Qe,[a(D,{disabled:O.finalReview.isFinal||e.value.action=="readonly",modelValue:u.value.achievement_midyear,"onUpdate:modelValue":l[10]||(l[10]=o=>u.value.achievement_midyear=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",et,[a(D,{readonly:"",modelValue:v.mid_target_variation,"onUpdate:modelValue":l[11]||(l[11]=o=>v.mid_target_variation=o),label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",tt,[e.value.is_regular?(c(),k(D,{key:0,disabled:O.finalReview.isFinal||e.value.action=="readonly",modelValue:u.value.revised_annual_target,"onUpdate:modelValue":l[12]||(l[12]=o=>u.value.revised_annual_target=o),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])):h("",!0)]),t("div",at,[e.value.is_regular?(c(),k(D,{key:0,readonly:"",modelValue:u.value.mid_year_remainder_target,"onUpdate:modelValue":l[13]||(l[13]=o=>u.value.mid_year_remainder_target=o),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])):h("",!0)])]),_:1}),O.finalReview.isFinal?(c(),k($,{key:0,class:"px-3"},{default:n(()=>[t("div",lt,y(e.value.is_regular?"Year-end Achievement":"Final Review Achievement"),1),t("div",st,[a(D,{modelValue:u.value.achievement_yearend,"onUpdate:modelValue":l[14]||(l[14]=o=>u.value.achievement_yearend=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",it,[a(D,{readonly:"",modelValue:v.final_target_variation,"onUpdate:modelValue":l[15]||(l[15]=o=>v.final_target_variation=o),disabled:"",label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",nt,[a(D,{modelValue:u.value.year_end_remainder_target,"onUpdate:modelValue":l[16]||(l[16]=o=>u.value.year_end_remainder_target=o),disabled:"",label:"Remainer Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])])]),_:1})):h("",!0),a($,null,{default:n(()=>[t("div",ot,[a(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:l[17]||(l[17]=o=>e.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),e.value.action!="readonly"&&x.submitButton&&O.finalReview.saveBtn?(c(),k(b,{key:0,loading:_.value,color:"primary",class:"ml-2",onClick:se},{default:n(()=>[C("Save")]),_:1},8,["loading"])):h("",!0)])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),a(ye,{options:F.value},null,8,["options"])],64))}},dt={class:"v-col-12"},rt={class:"v-col-12 py-0"},vt={class:"v-col-12 py-0"},ct={class:"v-col-12 py-0"},mt={key:0,class:"v-col-12 d-flex justify-end"},pt={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},gt=t("div",{class:"v-col-12 px-1"},y("Review"),-1),yt=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Mid-year Achievement ",-1),_t={class:"v-col-12 v-col-md-6 py-0 px-1"},ft={class:"v-col-12 v-col-md-6 py-0 px-1"},ht={class:"v-col-12 v-col-md-6 py-0 px-1"},bt={class:"v-col-12 v-col-md-6 py-0 px-1"},xt=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Year-year Achievement ",-1),wt={class:"v-col-12 py-0 px-1"},kt={class:"v-col-12 v-col-md-6 py-0 px-1"},Vt={class:"v-col-12 v-col-md-6 py-0 px-1"},Ct={class:"v-col-12 d-flex justify-end"},$t={__name:"EcdDialog",props:{ecdOptions:{type:Object,default:null},ecdList:{type:Object,default:null},remainWeightage:{type:Number,default:30}},emits:["savedResponse"],setup(O,{emit:A}){const x=O,F=p(null),g=p({}),W=p([]),w=p({}),S=p(null),e=p(null),u=p(["5%","10%","15%","20%"]),I=()=>{g.value.weightage=e.value,g.value.ecd_type=x.ecdOptions.ecdType,w.value.data=g.value,w.value.dialog=!1,A("savedResponse",w.value)};K(()=>x.ecdOptions,r=>{g.value=Object.assign({},r.data),W.value=x.ecdList.filter(m=>m.ecd_type==r.ecdType||m.ecd_type=="both"),w.value=Object.assign({},r),w.value.action=="edit"?(F.value=r.data.weightage,S.value=r.data.title,e.value=r.data.weightage):(F.value=null,S.value=null,e.value=null)}),K(()=>S.value,r=>{w.value.action=="add"&&(g.value={},g.value=r)});const B=p({}),T=p(!1);return K(()=>e.value,r=>{if(!isNaN(r)||r==null||r==null)T.value=!1;else if(w.value.action=="add")parseInt(r)>x.remainWeightage?(T.value=!1,B.value={status:!0,type:"error",text:"Weightage is over the limit!"}):T.value=!0;else{let m=parseInt(x.remainWeightage)+parseInt(F.value)-parseInt(r);parseInt(m)<0?(T.value=!1,B.value={status:!0,type:"error",text:"Weightage is over the limit!"}):F.value>parseInt(r)||parseInt(m)>=0?T.value=!0:T.value=!1}}),(r,m)=>(c(),V(Q,null,[a(ge,{modelValue:w.value.dialog,"onUpdate:modelValue":m[11]||(m[11]=_=>w.value.dialog=_),width:"100%","max-width":`${O.ecdOptions.is_review==!0?"1240":"700"} `,persistent:""},{default:n(()=>[a(z,{class:"rounded-lg"},{default:n(()=>[a($,{class:"ma-0 pa-0"},{default:n(()=>[t("div",{class:le(`v-col-12 ${O.ecdOptions.is_review==!0?"v-col-md-8":""} px-4`)},[a($,null,{default:n(()=>[t("div",dt,y(w.value.title),1),t("div",rt,[a(me,{modelValue:S.value,"onUpdate:modelValue":m[0]||(m[0]=_=>S.value=_),items:W.value,"item-title":"title","item-value":"id","return-object":"",variant:"outlined",density:"compact",label:"Select KPI*"},null,8,["modelValue","items"])]),t("div",vt,[a(ae,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=_=>e.value=_),items:u.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),t("div",ct,[a(pe,{class:"mx-auto"})]),w.value.is_review?h("",!0):(c(),V("div",mt,[a(b,{color:"primary",variant:"text",onClick:m[2]||(m[2]=_=>w.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),a(b,{disabled:!T.value,color:"primary",class:"ml-2 px-8",onClick:I},{default:n(()=>[C("save")]),_:1},8,["disabled"])]))]),_:1})],2),w.value.is_review?(c(),V("div",pt,[a($,{class:"px-3"},{default:n(()=>[gt,yt,t("div",_t,[a(D,{modelValue:g.value.revised_annual_target,"onUpdate:modelValue":m[3]||(m[3]=_=>g.value.revised_annual_target=_),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",ft,[a(D,{modelValue:g.value.mid_year_remainder_target,"onUpdate:modelValue":m[4]||(m[4]=_=>g.value.mid_year_remainder_target=_),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",ht,[a(D,{modelValue:g.value.mid_year_achievement,"onUpdate:modelValue":m[5]||(m[5]=_=>g.value.mid_year_achievement=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",bt,[a(D,{modelValue:g.value.mid_year_target_variation,"onUpdate:modelValue":m[6]||(m[6]=_=>g.value.mid_year_target_variation=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),xt,t("div",wt,[a(D,{modelValue:g.value.year_end_achievement,"onUpdate:modelValue":m[7]||(m[7]=_=>g.value.year_end_achievement=_),label:"Year-end Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",kt,[a(D,{modelValue:g.value.year_end_target_variation,"onUpdate:modelValue":m[8]||(m[8]=_=>g.value.year_end_target_variation=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",Vt,[a(D,{modelValue:g.value.year_end_remainder_target,"onUpdate:modelValue":m[9]||(m[9]=_=>g.value.year_end_remainder_target=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",Ct,[a(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:m[10]||(m[10]=_=>w.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),a(b,{color:"primary",class:"ml-2",onClick:r.submitReview},{default:n(()=>[C("Submit")]),_:1},8,["onClick"])])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),a(ye,{options:B.value},null,8,["options"])],64))}};const It={class:"v-col-12 v-col-md-2"},Tt={class:"v-col-12 v-col-md-2"},Rt={class:"v-col-12"},Ot={class:"d-flex align-center px-3"},Dt={key:1,class:"ml-auto text-h6"},jt={key:1,class:"text-uppercase text-primary"},Pt={key:2,class:"text-uppercase text-center",style:{display:"block !important",width:"100%"}},St={key:3,class:"text-uppercase text-center"},Kt={key:4,class:"ml-auto text-body-1"},Ut={class:"v-col-12 pb-0"},At={class:"v-col-12"},Ft={class:"v-col-12 pb-0 d-flex justify-space-between"},zt=t("div",{class:"text-grey text-caption"},"KPI",-1),Bt={class:"text-primary text-body-1"},Lt={class:"v-col-3"},Mt=t("div",{class:"text-grey text-caption"},"Industry",-1),Wt={class:"text-primary text-body-1"},Et={class:"v-col-3"},Nt={class:"text-grey text-caption"},Yt={class:"text-primary text-body-1"},Ht={class:"v-col-3"},qt=t("div",{class:"text-grey text-caption"},"Measure",-1),Gt={class:"text-primary text-body-1"},Jt={class:"v-col-3"},Xt={class:"text-grey text-caption"},Zt={class:"text-primary text-body-1"},Qt={key:1,class:"v-col-12 pb-0 text-center"},ea={class:"v-col-6 pb-0"},ta={key:1},aa={class:"v-col-6 pb-0"},la={key:1},sa={class:"v-col-6 pb-0"},ia={class:"v-col-12 pb-0 d-flex justify-space-between"},na=t("div",{class:"text-grey text-caption"},"Training",-1),oa={class:"text-primary text-body-1"},ua={class:"v-col-3"},da={class:"text-grey text-caption"},ra={class:"text-primary text-body-1"},va={class:"v-col-3"},ca=t("div",{class:"text-grey text-caption"},"Type",-1),ma={class:"text-primary text-body-1"},pa={class:"v-col-6 pb-0"},ga={class:"v-col-12 pb-0 d-flex justify-space-between"},ya=t("div",{class:"text-grey text-caption"},"Training",-1),_a={class:"text-primary text-body-1"},fa={class:"v-col-3"},ha={class:"text-grey text-caption"},ba={class:"text-primary text-body-1"},xa={class:"v-col-3"},wa=t("div",{class:"text-grey text-caption"},"Type",-1),ka={class:"text-primary text-body-1"},Va={class:"pb-3 text-grey"},Ca={class:"text-primary"},$a={class:"d-flex justify-end mt-5"},Da={__name:"KpiContent",props:{selectedEmployee:{type:Object,default:null},industryList:{type:Object,default:null},ecdList:{type:Object,default:null},submitButton:{type:Boolean,default:!0},measuresList:{type:Object,default:null}},emits:["yearchange","savedResponse","errorcheck"],setup(O,{emit:A}){const x=O,F=Ie(),g=Te(),W=Re(),w=p({}),S=Oe(),e=p(x.selectedEmployee),u=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="kpi")),I=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd")),B=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="tech")),T=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="soft"));K(()=>x.selectedEmployee,s=>{s.length>0?e.value=Object.assign({},s[0]):e.value=Object.assign({},s),g.name=="SingleTeamMember"&&j()});const r=q(()=>S.filteredSetting(e.value.company_id)),m=p(!1),_=p(!1),j=()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="first_review")){let s=e.value.reviews[0].key_review.filter(d=>d.achievement_midyear==null),i=!1;s&&s.length>0&&(i=!0),A("errorcheck",{hasError:i})}else if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="yearend"||e.value.reviews[0].state=="final_review")){let s=e.value.reviews[0].key_review.filter(d=>d.achievement_yearend==null),i=!1;s&&s.length>0&&(i=!0),A("errorcheck",{hasError:i})}else X().then(()=>{A("errorcheck",{hasError:_.value})})},R=p(""),X=async()=>{let s="",i=!1;f.value=="kpi"&&u.value.length<4&&N("kpi")==0?(s="Invalid: Minimum 4 KPI's needed, kindly update the weightage.",i=!0):(s="Invalid: Should have 1 each, technical and soft skill, kindly update the weightage.",i=ee(i)),m.value=i,i&&(R.value=s),se()},ee=s=>{if(N("ecd")==0&&I.value&&I.value.length>0&&I.value.length<2)s=!0;else if(I.value.length>1){let i=[];I.value.map((d,G)=>{i.push(d.ecd_type)}),i=[...new Set(i)],N("ecd")==0&&i.length<2&&(s=!0)}return s},se=async()=>{let s=!1;u.value.length<4&&N("kpi")==0&&(s=!0),s=ee(s),_.value=s},f=p("kpi"),Y=s=>{f.value=s,g.name=="SingleTeamMember"&&X()},v=p(new Date),l=q(()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0)return!!(W.authRole.includes("manager")&&g.name=="SingleTeamMember"&&e.value.reviews[0].state=="setting"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"||e.value.reviews[0].status=="inreview"));if(g.name=="SingleTeamMember"&&r&&r.state=="setting"&&(r.status=="open"||r.status=="inprogress"))return!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){let s=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(r.probation_kpi_setting)),s>=v.value)return!0}return!1}),o=p({saveBtn:!1,isFinal:!1}),H=q(()=>{if(o.value={saveBtn:!1,isFinal:!1},g.name=="SingleTeamMember"&&r&&r.state=="yearend"&&(o.value={saveBtn:!1,isFinal:!0}),g.name=="SingleTeamMember"&&r&&(r.state=="midyear"||r.state=="yearend")&&(r.status=="open"||r.status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){if(o.value={saveBtn:!1,isFinal:!1},r){let s=new Date(e.value.doj),i=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(r.probation_first_review_start)),i.setDate(i.getDate()+parseInt(r.probation_first_review_end)),e.value.reviews[0].state=="first_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!1},!0;if(s<=v.value&&i>=v.value)return o.value={saveBtn:!0,isFinal:!1},!0;let d=new Date(e.value.doj),G=new Date(e.value.doj);if(d.setDate(d.getDate()+parseInt(r.probation_final_review_start)),G.setDate(G.getDate()+parseInt(r.probation_final_review_end)),e.value.reviews[0].state=="final_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(d<=v.value&&G>=v.value)return o.value={saveBtn:!0,isFinal:!0},!0}}else if(e.value&&e.value.reviews&&e.value.reviews.length>0)return e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"?o.value.saveBtn=!0:e.value.reviews[0].state=="yearend"&&(o.value.isFinal=!0),!!(W.authRole.includes("manager")&&g.name=="SingleTeamMember"&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="yearend"));return!1}),Z=p(new Date().getFullYear()),xe=()=>{const s=F.resolve({path:"/print/kpi/"+Z.value+"/"+e.value.username,params:{year:Z.value},query:{print:1}});window.open(s.href,"_blank")};K(Z,async(s,i)=>{A("yearchange",s)});const L=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),M=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),ie=async(s,i)=>{N(f.value)<=0?w.value={status:!0,type:"error",text:"Denied: You've reached the weightage limit."}:s=="kpi"?u.value.length>5?w.value={status:!0,type:"error",text:"Denied: Max of 6 KPI only. Minimum is 4 KPI"}:L.value={title:"Add KPI ",data:{},dialog:!0,type:s,action:"add",is_review:!1}:M.value={...M.value,title:"Add Technical & Behavioural Program",data:{},dialog:!0,type:s,ecdType:i,action:"add",is_review:!1}},ne=async(s,i="kpi",d)=>{i=="kpi"?L.value={...L.value,title:"Edit KPI ",data:Object.assign({},s),dialog:!0,type:i,action:"edit",is_review:!1}:M.value={...M.value,title:"Edit ECD ",data:Object.assign({},s),dialog:!0,type:i,action:"edit",ecdType:d,is_review:!1}},we=async(s,i="kpi")=>{console.log("item",s),i=="kpi"&&(L.value={...L.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"readonly",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular},console.log("kpiOptions",L.value)),i=="ecd"&&(M.value={...M.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"readonly",is_review:!0})},oe=async(s,i="kpi")=>{i=="kpi"&&(L.value={...L.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"review",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular}),i=="ecd"&&(M.value={...M.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"review",is_review:!0})},_e=s=>{let i={reviewID:e.value.reviews[0].id,data:s,industryTitle:s.industryTitle,state:s.state};j(),A("savedResponse",i)},E=p({data:{},dialog:!1,loading:!1}),ue=async s=>{E.value={...E.value,data:Object.assign({},s),dialog:!0}},ke=async()=>{let s=E.value.data;E.value.dialog=!1,A("removeKPI",s)},N=s=>{let i=70;return e.value&&e.value.is_regular==0&&(i=100),s=="ecd"?(i=30,I.value&&I.value.length>0&&I.value.map((d,G)=>{i-=d.weightage})):u.value&&u.value.length>0&&u.value.map((d,G)=>{i-=d.weightage}),i};return(s,i)=>(c(),k($,null,{default:n(()=>[t("div",It,[a(P(Se),{modelValue:Z.value,"onUpdate:modelValue":i[0]||(i[0]=d=>Z.value=d),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),t("div",Tt,[e.value&&e.value.reviews&&e.value.reviews.length>0?(c(),k(b,{key:0,onClick:xe,color:"white",class:"text-capitalize"},{default:n(()=>[C("View / Print KPI "),a(U,{icon:P(De),class:"ml-3"},null,8,["icon"])]),_:1})):h("",!0)]),t("div",Rt,[t("div",Ot,[a(z,{onClick:i[1]||(i[1]=()=>Y("kpi")),flat:"",class:le(`
          ${f.value=="kpi"?"":"bg-grey-darken-3 text-white"}
          d-flex align-center justify-center px-3 text-center pms-tab`)},{default:n(()=>[C(" KPI "+y(u.value?"("+u.value.length+")":"(0)"),1)]),_:1},8,["class"]),e.value&&e.value.is_regular?(c(),k(z,{key:0,onClick:i[2]||(i[2]=()=>Y("ecd")),flat:"",class:le(`${f.value=="ecd"?"":"bg-grey-darken-3 text-white"} d-flex align-center justify-center px-3 text-caption text-center pms-tab`)},{default:n(()=>[C(" Employee Capability Development "+y("("+I.value.length+")"),1)]),_:1},8,["class"])):h("",!0),e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="yearend"&&e.value.reviews[0].status=="submitted"?(c(),V("div",Dt,"Rate: Coming Soon")):h("",!0)]),a(z,{flat:""},{default:n(()=>[a(fe,{class:"px-5 py-5 d-flex align-center"},{default:n(()=>[l.value&&f.value=="kpi"?(c(),k(b,{key:0,onClick:i[3]||(i[3]=()=>ie(f.value)),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[a(U,{size:"small",icon:P(re)},null,8,["icon"])]),_:1})):h("",!0),f.value=="kpi"&&u.value&&u.value.length>0||f.value=="ecd"&&I.value&&I.value.length>0?(c(),V("div",jt,y(f.value=="ecd"?"Employee Capability Development":f.value)+" List ",1)):l.value?(c(),V("div",St,y(f.value=="ecd"?"Employee Capability Development":f.value)+" List ",1)):(c(),V("div",Pt,y(f.value)+" not set ",1)),l.value?(c(),V("div",Kt,"Remaining "+y(f.value.toUpperCase())+" weightage: "+y(N(f.value))+"%",1)):h("",!0)]),_:1}),a(J,{class:"px-5 pb-10"},{default:n(()=>[m.value?(c(),k($,{key:0,class:"mb-2"},{default:n(()=>[t("div",Ut,[a(z,{class:"rounded-lg",style:{border:"2px solid red"}},{default:n(()=>[a(J,null,{default:n(()=>[a($,null,{default:n(()=>[t("div",At,[a(U,{size:"large",color:"red",class:"mr-1",icon:P(je)},null,8,["icon"]),C(" "+y(R.value),1)])]),_:1})]),_:1})]),_:1})])]),_:1})):h("",!0),he(a($,{class:"mt-3"},{default:n(()=>[u.value&&u.value.length>0?(c(!0),V(Q,{key:0},de(u.value,d=>(c(),V("div",{class:"v-col-12 pb-0",key:d.id},[a(z,{class:"rounded-lg"},{default:n(()=>[a(J,null,{default:n(()=>[a($,null,{default:n(()=>[t("div",Ft,[t("div",null,[zt,t("div",Bt,y(d.title),1)]),t("div",null,[a(b,{icon:P(Pe),color:"primary",class:"rounded-md mr-1",size:"small",onClick:()=>we(d,"kpi")},null,8,["icon","onClick"]),H.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"kpi")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:1,onClick:()=>ne(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",Lt,[Mt,t("div",Wt,y(d.industry),1)]),t("div",Et,[t("div",Nt,"Target ("+y(d.target_type)+")",1),t("div",Yt,y(d.target),1)]),t("div",Ht,[qt,t("div",Gt,y(d.measures),1)]),t("div",Jt,[t("div",Xt,y("KPI's Weightage(%)"),1),t("div",Zt,y(d.weightage)+"%",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)):(c(),V("div",Qt," No records yet. "))]),_:1},512),[[be,f.value=="kpi"]]),he(a($,{class:"mt-n3"},{default:n(()=>[t("div",ea,[l.value?(c(),k(b,{key:0,onClick:i[4]||(i[4]=()=>ie(f.value,"tech")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[a(U,{size:"small",icon:P(re)},null,8,["icon"])]),_:1})):h("",!0),l.value?(c(),V("span",ta,"Technical Skill")):h("",!0)]),t("div",aa,[l.value?(c(),k(b,{key:0,onClick:i[5]||(i[5]=()=>ie(f.value,"soft")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[a(U,{size:"small",icon:P(re)},null,8,["icon"])]),_:1})):h("",!0),C(),l.value?(c(),V("span",la,"Soft Skill")):h("",!0)]),t("div",sa,[a($,null,{default:n(()=>[(c(!0),V(Q,null,de(B.value,d=>(c(),V("div",{class:"v-col-12 pb-0",key:d.id},[a(z,{class:"rounded-lg"},{default:n(()=>[a(J,null,{default:n(()=>[a($,null,{default:n(()=>[t("div",ia,[t("div",null,[na,t("div",oa,y(d.title),1)]),t("div",null,[H.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:1,onClick:()=>ne(d,"ecd","tech"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",ua,[t("div",da,y("KPI's Weightage(%)"),1),t("div",ra,y(d.weightage),1)]),t("div",va,[ca,t("div",ma,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),t("div",pa,[a($,null,{default:n(()=>[(c(!0),V(Q,null,de(T.value,d=>(c(),V("div",{class:"v-col-12 pb-0",key:d.id},[a(z,{class:"rounded-lg"},{default:n(()=>[a(J,null,{default:n(()=>[a($,null,{default:n(()=>[t("div",ga,[t("div",null,[ya,t("div",_a,y(d.title),1)]),t("div",null,[H.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:1,onClick:()=>ne(d,"ecd","soft"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),l.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[a(U,{size:"small",icon:P(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",fa,[t("div",ha,y("KPI's Weightage(%)"),1),t("div",ba,y(d.weightage),1)]),t("div",xa,[wa,t("div",ka,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})])]),_:1},512),[[be,f.value=="ecd"]])]),_:1})]),_:1})]),a(ge,{modelValue:E.value.dialog,"onUpdate:modelValue":i[7]||(i[7]=d=>E.value.dialog=d),width:"100%","max-width":"480",persistent:""},{default:n(()=>[a(z,{class:"rounded-lg"},{default:n(()=>[a(fe,{class:"pa-3"},{default:n(()=>[C("Confirm Remove")]),_:1}),a(J,{class:"px-3"},{default:n(()=>[t("div",Va,[C(" Please confirm that you want to remove "),t("span",Ca,y("'"+E.value.data.title.substring(0,35)+"...'"),1)]),t("div",$a,[a(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:i[6]||(i[6]=d=>E.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),a(b,{color:"primary",class:"ml-2",onClick:ke},{default:n(()=>[C("Remove")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ut,{"final-review":o.value,"measures-list":O.measuresList,"kpi-options":L.value,"remain-weightage":N(f.value),"industry-list":O.industryList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","measures-list","kpi-options","remain-weightage","industry-list","submit-button"]),a($t,{"final-review":o.value,"ecd-options":M.value,"remain-weightage":N(f.value),"ecd-list":O.ecdList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","ecd-options","remain-weightage","ecd-list","submit-button"]),a(ye,{options:w.value},null,8,["options"])]),_:1}))}};export{Da as _};
