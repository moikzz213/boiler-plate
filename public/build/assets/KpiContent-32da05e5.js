import{r as p,N as K,o as c,b as C,a as l,w as i,g as z,i as $,f as t,Y as ae,A as y,M as me,O as ke,P as Ve,I as le,G as O,Z as Ce,$ as pe,a0 as te,H as b,C as V,e as h,c as k,J as ge,F as Q,z as $e,K as Ie,u as Te,k as Re,L as H,d as j,X as U,B as fe,h as J,q as he,n as de,v as be}from"./app-d2fb1262.js";import{b as De,c as re,d as Oe,e as ve,f as ce}from"./mdi-a0a77bee.js";import{e as Se}from"./vue-datepicker-b8277478.js";import{_ as ye}from"./SnackBar-28e14e9f.js";const Pe={class:"v-col-12"},je={class:"v-col-12 v-col-md-6 py-0"},Ke={class:"v-col-12 v-col-md-6 py-0"},Ue={class:"v-col-12 v-col-md-3 py-0"},Ae={class:"v-col-12 v-col-md-3 py-0"},Fe={class:"v-col-12 v-col-md-3 py-0"},ze={class:"v-col-12 v-col-md-3 py-0"},Be={class:"v-col-12 py-0"},Le={class:"v-col-12 pt-0"},Me={class:"v-col-12 py-0"},We={class:"v-col-12 py-0"},Ee={class:"v-col-12 py-0"},Ne={class:"v-col-12 py-0"},Ye={class:"v-col-12 py-0"},He={key:0,class:"v-col-12 d-flex justify-end"},qe={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},Ge=t("div",{class:"v-col-12 px-1"},y("Review"),-1),Je={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},Xe={class:"v-col-12 v-col-md-6 py-0 px-1"},Ze={class:"v-col-12 v-col-md-6 py-0 px-1"},Qe={class:"v-col-12 v-col-md-6 py-0 px-1"},et={class:"v-col-12 v-col-md-6 py-0 px-1"},tt={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},lt={class:"v-col-12 py-0 px-1"},at={class:"v-col-12 v-col-md-6 py-0 px-1"},st={class:"v-col-12 v-col-md-6 py-0 px-1"},it={class:"v-col-12 d-flex justify-end"},nt={__name:"KpiDialog",props:{kpiOptions:{type:Object,default:null},submitButton:{type:Boolean,default:!0},industryList:{type:Object,default:null},remainWeightage:{type:Number,default:70},measuresList:{type:Object,default:null},finalReview:{type:Boolean,default:!1}},emits:["savedResponse"],setup(D,{emit:A}){const x=D,F=p({}),g=p(["min","max"]),B=p([]),w=p(["5%","10%","15%","20%","25%","30%"]),P=p(null),e=p({}),u=p({measures:null}),I=p([]),L=p([]),T=p(""),r=p(""),m=p(""),_=p(!1),S=p(!0),R=p([]),X=()=>{_.value=!0,e.value.data=u.value,e.value.industryTitle=m.value,setTimeout(()=>{_.value=!1,e.value.dialog=!1,A("savedResponse",e.value)},1200),T.value=x.kpiOptions.data.industry},ee=()=>{e.value.dialog=!1,(e.value.action=="edit"||e.value.action=="review")&&(T.value=x.kpiOptions.data.industry,r.value=x.kpiOptions.data.title)},se=()=>{x.finalReview.isFinal?e.value.state="final":e.value.state="mid",X()};K(()=>x.kpiOptions,v=>{console.log("newValnewVal",v),_.value=!1,L.value=x.industryList,u.value=Object.assign({},v.data),e.value=Object.assign({},v),e.value.action=="edit"||e.value.action=="review"?(T.value=v.data.industry,r.value=v.data.title,P.value=v.data.weightage,S.value=!1):(T.value=null,r.value=null,P.value=null,S.value=!0)}),K(()=>T.value,v=>{I.value=[],B.value=x.measuresList,e.value.action=="add"?(S.value=!0,u.value={},r.value=null,v&&(R.value.push("industry"),f(),m.value=v.title,L.value.map(a=>{a.id==v.id&&(I.value=a.kpis)}))):(R.value.push("industry"),S.value=!1)}),K(()=>r.value,v=>{if(e.value.action=="add"){u.value={};let a=I.value.filter(o=>o.id==v);a&&a.length>0&&(u.value=a[0],S.value=!1,R.value.push("kpi"),f())}else R.value.push("kpi")}),K(()=>u.value.weightage,v=>{let a=!1;if(!isNaN(v)||v==null||v==null)a=!1;else if(e.value.action=="add")parseInt(v)>x.remainWeightage?(a=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):a=!0;else{let o=parseInt(x.remainWeightage)+parseInt(P.value)-parseInt(v);parseInt(o)<0?(a=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):P.value>parseInt(v)||parseInt(o)>=0?a=!0:a=!1}a?(R.value.push("weightage"),f()):E("weightage")});const f=()=>{R.value=R.value.filter((v,a)=>R.value.indexOf(v)===a)},E=v=>{const a=R.value.indexOf(v);a>-1&&R.value.splice(a,1)};return K(()=>u.value.target,v=>{v?(R.value.push("target"),f()):E("target")}),K(()=>u.value.measures,v=>{v?(R.value.push("measures"),f()):E("measures")}),K(()=>u.value.target_type,v=>{R.value.push("target_type"),f(),v=="min"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Exceeding the Target</span> <br/><span style="color:red">Negative Ranking = Falling short of the Target</span>':v=="max"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Falling short of the Target</span> <br/><span style="color:red">Negative Ranking = Exceeding the Target</span>':(E("target_type"),u.value.evaluation_pattern="")}),(v,a)=>(c(),C(Q,null,[l(ge,{modelValue:e.value.dialog,"onUpdate:modelValue":a[18]||(a[18]=o=>e.value.dialog=o),width:"100%","max-width":`${e.value.is_review==!0?"1240":"900"} `,persistent:""},{default:i(()=>[l(z,{class:"rounded-lg"},{default:i(()=>[l($,{class:"ma-0 pa-0"},{default:i(()=>[t("div",{class:ae(`v-col-12 ${e.value.is_review==!0?"v-col-md-8":""} px-4`)},[l($,null,{default:i(()=>[t("div",Pe,y(e.value.title),1),t("div",je,[l(me,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=o=>T.value=o),items:D.industryList,"item-title":"title","item-value":"title","return-object":"",disabled:e.value.action=="edit"||e.value.is_review,variant:"outlined",density:"compact",label:"Select Industry*"},null,8,["modelValue","items","disabled"])]),t("div",Ke,[l(me,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o),items:I.value,"item-title":"title","item-value":"id",variant:"outlined",disabled:e.value.action=="edit"||e.value.is_review,density:"compact",label:"Select KPI*"},{selection:i(({props:o,item:N})=>[t("span",ke(Ve(o)),y((N==null?void 0:N.title.substring(0,35))+"..."),17)]),_:1},8,["modelValue","items","disabled"])]),t("div",Ue,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.target_type,"onUpdate:modelValue":a[2]||(a[2]=o=>u.value.target_type=o),items:g.value,label:"Target Type*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Ae,[l(O,{disabled:S.value||e.value.is_review,modelValue:u.value.target,"onUpdate:modelValue":a[3]||(a[3]=o=>u.value.target=o),label:"Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",Fe,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.measures,"onUpdate:modelValue":a[4]||(a[4]=o=>u.value.measures=o),items:B.value,label:"Measures*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",ze,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.weightage,"onUpdate:modelValue":a[5]||(a[5]=o=>u.value.weightage=o),items:w.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Be,[l($,{class:"mx-0 mb-3"},{default:i(()=>[l(Ce,{class:"pa-3",style:{border:"1px solid #b1b1b1","border-radius":"5px","min-height":"70px"},innerHTML:u.value.evaluation_pattern},null,8,["innerHTML"])]),_:1})]),t("div",Le,[l(pe,{class:"mx-auto"})]),t("div",Me,[l(te,{modelValue:u.value.definition,"onUpdate:modelValue":a[6]||(a[6]=o=>u.value.definition=o),readonly:S.value||e.value.action=="edit"||e.value.is_review,label:"KPI Definition*",variant:"outlined",rows:"2"},null,8,["modelValue","readonly"])]),t("div",We,[l(te,{modelValue:u.value.formula,"onUpdate:modelValue":a[7]||(a[7]=o=>u.value.formula=o),readonly:"",label:"Calulation Formula*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",Ee,[l(te,{modelValue:u.value.subordinate_measures,"onUpdate:modelValue":a[8]||(a[8]=o=>u.value.subordinate_measures=o),readonly:"",label:"Subordinate Measures*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",Ne,[l(te,{modelValue:u.value.calculation_example,"onUpdate:modelValue":a[9]||(a[9]=o=>u.value.calculation_example=o),readonly:"",label:"KPI Calulation Example*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",Ye,[l(pe,{class:"mx-auto"})]),e.value.is_review?h("",!0):(c(),C("div",He,[l(b,{color:"primary",variant:"text",onClick:ee},{default:i(()=>[V("Cancel")]),_:1}),l(b,{loading:_.value,disabled:R.value.length<6,color:"primary",class:"ml-2 px-8",onClick:X},{default:i(()=>[V("save")]),_:1},8,["loading","disabled"])]))]),_:1})],2),e.value.is_review?(c(),C("div",qe,[l($,{class:"px-3"},{default:i(()=>[Ge,t("div",Je,y(e.value.is_regular?"Mid-year Achievement":"First Review Achievement"),1),t("div",Xe,[l(O,{disabled:D.finalReview.isFinal,modelValue:u.value.achievement_midyear,"onUpdate:modelValue":a[10]||(a[10]=o=>u.value.achievement_midyear=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",Ze,[l(O,{readonly:"",modelValue:v.mid_target_variation,"onUpdate:modelValue":a[11]||(a[11]=o=>v.mid_target_variation=o),label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",Qe,[e.value.is_regular?(c(),k(O,{key:0,disabled:D.finalReview.isFinal,modelValue:u.value.revised_annual_target,"onUpdate:modelValue":a[12]||(a[12]=o=>u.value.revised_annual_target=o),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])):h("",!0)]),t("div",et,[e.value.is_regular?(c(),k(O,{key:0,disabled:D.finalReview.isFinal,modelValue:u.value.mid_year_remainder_target,"onUpdate:modelValue":a[13]||(a[13]=o=>u.value.mid_year_remainder_target=o),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])):h("",!0)])]),_:1}),D.finalReview.isFinal?(c(),k($,{key:0,class:"px-3"},{default:i(()=>[t("div",tt,y(e.value.is_regular?"Year-end Achievement":"Final Review Achievement"),1),t("div",lt,[l(O,{modelValue:u.value.achievement_yearend,"onUpdate:modelValue":a[14]||(a[14]=o=>u.value.achievement_yearend=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",at,[l(O,{readonly:"",modelValue:v.final_target_variation,"onUpdate:modelValue":a[15]||(a[15]=o=>v.final_target_variation=o),disabled:"",label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",st,[l(O,{modelValue:u.value.year_end_remainder_target,"onUpdate:modelValue":a[16]||(a[16]=o=>u.value.year_end_remainder_target=o),disabled:"",label:"Remainer Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])])]),_:1})):h("",!0),l($,null,{default:i(()=>[t("div",it,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:a[17]||(a[17]=o=>e.value.dialog=!1)},{default:i(()=>[V("Cancel")]),_:1}),x.submitButton&&D.finalReview.saveBtn?(c(),k(b,{key:0,loading:_.value,color:"primary",class:"ml-2",onClick:se},{default:i(()=>[V("Save")]),_:1},8,["loading"])):h("",!0)])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),l(ye,{options:F.value},null,8,["options"])],64))}},ot={class:"v-col-12"},ut={class:"v-col-12 py-0"},dt={class:"v-col-12 py-0"},rt={class:"v-col-12 py-0"},vt={key:0,class:"v-col-12 d-flex justify-end"},ct={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},mt=t("div",{class:"v-col-12 px-1"},y("Review"),-1),pt=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Mid-year Achievement ",-1),gt={class:"v-col-12 v-col-md-6 py-0 px-1"},yt={class:"v-col-12 v-col-md-6 py-0 px-1"},_t={class:"v-col-12 v-col-md-6 py-0 px-1"},ft={class:"v-col-12 v-col-md-6 py-0 px-1"},ht=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Year-year Achievement ",-1),bt={class:"v-col-12 py-0 px-1"},xt={class:"v-col-12 v-col-md-6 py-0 px-1"},wt={class:"v-col-12 v-col-md-6 py-0 px-1"},kt={class:"v-col-12 d-flex justify-end"},Vt={__name:"EcdDialog",props:{ecdOptions:{type:Object,default:null},ecdList:{type:Object,default:null},remainWeightage:{type:Number,default:30}},emits:["savedResponse"],setup(D,{emit:A}){const x=D,F=p(null),g=p({}),B=p([]),w=p({}),P=p(null),e=p(null),u=p(["5%","10%","15%","20%"]),I=()=>{g.value.weightage=e.value,g.value.ecd_type=x.ecdOptions.ecdType,w.value.data=g.value,w.value.dialog=!1,A("savedResponse",w.value)};K(()=>x.ecdOptions,r=>{g.value=Object.assign({},r.data),B.value=x.ecdList.filter(m=>m.ecd_type==r.ecdType||m.ecd_type=="both"),w.value=Object.assign({},r),w.value.action=="edit"?(F.value=r.data.weightage,P.value=r.data.title,e.value=r.data.weightage):(F.value=null,P.value=null,e.value=null)}),K(()=>P.value,r=>{w.value.action=="add"&&(g.value={},g.value=r)});const L=p({}),T=p(!1);return K(()=>e.value,r=>{if(!isNaN(r)||r==null||r==null)T.value=!1;else if(w.value.action=="add")parseInt(r)>x.remainWeightage?(T.value=!1,L.value={status:!0,type:"error",text:"Weightage is over the limit!"}):T.value=!0;else{let m=parseInt(x.remainWeightage)+parseInt(F.value)-parseInt(r);parseInt(m)<0?(T.value=!1,L.value={status:!0,type:"error",text:"Weightage is over the limit!"}):F.value>parseInt(r)||parseInt(m)>=0?T.value=!0:T.value=!1}}),(r,m)=>(c(),C(Q,null,[l(ge,{modelValue:w.value.dialog,"onUpdate:modelValue":m[11]||(m[11]=_=>w.value.dialog=_),width:"100%","max-width":`${D.ecdOptions.is_review==!0?"1240":"700"} `,persistent:""},{default:i(()=>[l(z,{class:"rounded-lg"},{default:i(()=>[l($,{class:"ma-0 pa-0"},{default:i(()=>[t("div",{class:ae(`v-col-12 ${D.ecdOptions.is_review==!0?"v-col-md-8":""} px-4`)},[l($,null,{default:i(()=>[t("div",ot,y(w.value.title),1),t("div",ut,[l(me,{modelValue:P.value,"onUpdate:modelValue":m[0]||(m[0]=_=>P.value=_),items:B.value,"item-title":"title","item-value":"id","return-object":"",variant:"outlined",density:"compact",label:"Select KPI*"},null,8,["modelValue","items"])]),t("div",dt,[l(le,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=_=>e.value=_),items:u.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),t("div",rt,[l(pe,{class:"mx-auto"})]),w.value.is_review?h("",!0):(c(),C("div",vt,[l(b,{color:"primary",variant:"text",onClick:m[2]||(m[2]=_=>w.value.dialog=!1)},{default:i(()=>[V("Cancel")]),_:1}),l(b,{disabled:!T.value,color:"primary",class:"ml-2 px-8",onClick:I},{default:i(()=>[V("save")]),_:1},8,["disabled"])]))]),_:1})],2),w.value.is_review?(c(),C("div",ct,[l($,{class:"px-3"},{default:i(()=>[mt,pt,t("div",gt,[l(O,{modelValue:g.value.revised_annual_target,"onUpdate:modelValue":m[3]||(m[3]=_=>g.value.revised_annual_target=_),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",yt,[l(O,{modelValue:g.value.mid_year_remainder_target,"onUpdate:modelValue":m[4]||(m[4]=_=>g.value.mid_year_remainder_target=_),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",_t,[l(O,{modelValue:g.value.mid_year_achievement,"onUpdate:modelValue":m[5]||(m[5]=_=>g.value.mid_year_achievement=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",ft,[l(O,{modelValue:g.value.mid_year_target_variation,"onUpdate:modelValue":m[6]||(m[6]=_=>g.value.mid_year_target_variation=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),ht,t("div",bt,[l(O,{modelValue:g.value.year_end_achievement,"onUpdate:modelValue":m[7]||(m[7]=_=>g.value.year_end_achievement=_),label:"Year-end Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",xt,[l(O,{modelValue:g.value.year_end_target_variation,"onUpdate:modelValue":m[8]||(m[8]=_=>g.value.year_end_target_variation=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",wt,[l(O,{modelValue:g.value.year_end_remainder_target,"onUpdate:modelValue":m[9]||(m[9]=_=>g.value.year_end_remainder_target=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",kt,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:m[10]||(m[10]=_=>w.value.dialog=!1)},{default:i(()=>[V("Cancel")]),_:1}),l(b,{color:"primary",class:"ml-2",onClick:r.submitReview},{default:i(()=>[V("Submit")]),_:1},8,["onClick"])])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),l(ye,{options:L.value},null,8,["options"])],64))}};const Ct={class:"v-col-12 v-col-md-2"},$t={class:"v-col-12 v-col-md-2"},It={class:"v-col-12"},Tt={class:"d-flex align-center px-3"},Rt={key:1,class:"ml-auto text-h6"},Dt={key:1,class:"text-uppercase text-primary"},Ot={key:2,class:"text-uppercase text-center",style:{display:"block !important",width:"100%"}},St={key:3,class:"text-uppercase text-center"},Pt={key:4,class:"ml-auto text-body-1"},jt={class:"v-col-12 pb-0"},Kt={class:"v-col-12"},Ut={class:"v-col-12 pb-0 d-flex justify-space-between"},At=t("div",{class:"text-grey text-caption"},"KPI",-1),Ft={class:"text-primary text-body-1"},zt={class:"v-col-3"},Bt=t("div",{class:"text-grey text-caption"},"Industry",-1),Lt={class:"text-primary text-body-1"},Mt={class:"v-col-3"},Wt={class:"text-grey text-caption"},Et={class:"text-primary text-body-1"},Nt={class:"v-col-3"},Yt=t("div",{class:"text-grey text-caption"},"Measure",-1),Ht={class:"text-primary text-body-1"},qt={class:"v-col-3"},Gt={class:"text-grey text-caption"},Jt={class:"text-primary text-body-1"},Xt={class:"v-col-6 pb-0"},Zt={key:1},Qt={class:"v-col-6 pb-0"},el={key:1},tl={class:"v-col-6 pb-0"},ll={class:"v-col-12 pb-0 d-flex justify-space-between"},al=t("div",{class:"text-grey text-caption"},"Training",-1),sl={class:"text-primary text-body-1"},il={class:"v-col-3"},nl={class:"text-grey text-caption"},ol={class:"text-primary text-body-1"},ul={class:"v-col-3"},dl=t("div",{class:"text-grey text-caption"},"Type",-1),rl={class:"text-primary text-body-1"},vl={class:"v-col-6 pb-0"},cl={class:"v-col-12 pb-0 d-flex justify-space-between"},ml=t("div",{class:"text-grey text-caption"},"Training",-1),pl={class:"text-primary text-body-1"},gl={class:"v-col-3"},yl={class:"text-grey text-caption"},_l={class:"text-primary text-body-1"},fl={class:"v-col-3"},hl=t("div",{class:"text-grey text-caption"},"Type",-1),bl={class:"text-primary text-body-1"},xl={class:"pb-3 text-grey"},wl={class:"text-primary"},kl={class:"d-flex justify-end mt-5"},Tl={__name:"KpiContent",props:{selectedEmployee:{type:Object,default:null},industryList:{type:Object,default:null},ecdList:{type:Object,default:null},submitButton:{type:Boolean,default:!0},measuresList:{type:Object,default:null}},emits:["yearchange","savedResponse"],setup(D,{emit:A}){const x=D,F=$e(),g=Ie(),B=Te(),w=p({}),P=Re(),e=p(x.selectedEmployee),u=H(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="kpi")),I=H(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd")),L=H(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="technical")),T=H(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="softskill"));K(()=>x.selectedEmployee,s=>{s.length>0?e.value=Object.assign({},s[0]):e.value=Object.assign({},s),g.name=="SingleTeamMember"&&S()});const r=H(()=>P.filteredSetting(e.value.company_id)),m=p(!1),_=p(!1),S=()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="first_review"){let s=e.value.reviews[0].key_review.filter(d=>d.achievement_midyear==null),n=!1;s&&s.length>0&&(n=!0),A("errorcheck",{hasError:n})}else if(e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="yearend"||e.value.reviews[0].state=="final_review"){console.log("viewingEmployee.value.reviews[0].state",e.value.reviews[0].state);let s=e.value.reviews[0].key_review.filter(d=>d.achievement_yearend==null),n=!1;s&&s.length>0&&(n=!0),A("errorcheck",{hasError:n})}else X().then(()=>{A("errorcheck",{hasError:_.value})})},R=p(""),X=async()=>{let s="",n=!1;f.value=="kpi"&&u.value.length<4&&W("kpi")==0?(s="Invalid: Minimum 4 KPI's needed, kindly update the weightage.",n=!0):(s="Invalid: Should have 1 each, technical and soft skill, kindly update the weightage.",n=ee(n)),m.value=n,n&&(R.value=s),se()},ee=s=>{if(W("ecd")==0&&I.value&&I.value.length>0&&I.value.length<2)s=!0;else if(I.value.length>1){let n=[];I.value.map((d,G)=>{n.push(d.ecd_type)}),n=[...new Set(n)],W("ecd")==0&&n.length<2&&(s=!0)}return s},se=async()=>{let s=!1;u.value.length<4&&W("kpi")==0&&(s=!0),s=ee(s),_.value=s},f=p("kpi"),E=s=>{f.value=s,g.name=="SingleTeamMember"&&X()},v=p(new Date),a=H(()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0)return!!(B.authRole.includes("manager")&&g.name=="SingleTeamMember"&&e.value.reviews[0].state=="setting"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"||e.value.reviews[0].status=="inreview"));if(g.name=="SingleTeamMember"&&r&&r.state=="setting"&&(r.status=="open"||r.status=="inprogress"))return!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){let s=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(r.probation_kpi_setting)),s>=v.value)return!0}return!1}),o=p({saveBtn:!1,isFinal:!1}),N=H(()=>{if(o.value={saveBtn:!1,isFinal:!1},g.name=="SingleTeamMember"&&r&&r.state=="yearend"&&(o.value={saveBtn:!1,isFinal:!0}),g.name=="SingleTeamMember"&&r&&(r.state=="midyear"||r.state=="yearend")&&(r.status=="open"||r.status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){if(o.value={saveBtn:!1,isFinal:!1},r){let s=new Date(e.value.doj),n=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(r.probation_first_review_start)),n.setDate(n.getDate()+parseInt(r.probation_first_review_end)),e.value.reviews[0].state=="first_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!1},!0;if(s<=v.value&&n>=v.value)return o.value={saveBtn:!0,isFinal:!1},!0;let d=new Date(e.value.doj),G=new Date(e.value.doj);if(d.setDate(d.getDate()+parseInt(r.probation_final_review_start)),G.setDate(G.getDate()+parseInt(r.probation_final_review_end)),e.value.reviews[0].state=="final_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(d<=v.value&&G>=v.value)return o.value={saveBtn:!0,isFinal:!0},!0}}else if(e.value&&e.value.reviews&&e.value.reviews.length>0)return e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"?o.value.saveBtn=!0:e.value.reviews[0].state=="yearend"&&(o.value.isFinal=!0),!!(B.authRole.includes("manager")&&g.name=="SingleTeamMember"&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="yearend"));return!1}),Z=p(new Date().getFullYear()),xe=()=>{const s=F.resolve({path:"/print/kpi/"+Z.value+"/"+e.value.username,params:{year:Z.value},query:{print:1}});window.open(s.href,"_blank")};K(Z,async(s,n)=>{A("yearchange",s)});const q=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),Y=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),ie=async(s,n)=>{W(f.value)<=0?w.value={status:!0,type:"error",text:"Denied: You've reached the weightage limit."}:s=="kpi"?u.value.length>5?w.value={status:!0,type:"error",text:"Denied: Max of 6 KPI only. Minimum is 4 KPI"}:q.value={title:"Add KPI ",data:{},dialog:!0,type:s,action:"add",is_review:!1}:Y.value={...Y.value,title:"Add Technical & Behavioural Program",data:{},dialog:!0,type:s,ecdType:n,action:"add",is_review:!1}},ne=async(s,n="kpi",d)=>{n=="kpi"?q.value={...q.value,title:"Edit KPI ",data:Object.assign({},s),dialog:!0,type:n,action:"edit",is_review:!1}:Y.value={...Y.value,title:"Edit ECD ",data:Object.assign({},s),dialog:!0,type:n,action:"edit",ecdType:d,is_review:!1}},oe=async(s,n="kpi")=>{n=="kpi"&&(q.value={...q.value,title:n.toUpperCase(),data:Object.assign({},s),dialog:!0,type:n,action:"review",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular}),n=="ecd"&&(Y.value={...Y.value,title:n.toUpperCase(),data:Object.assign({},s),dialog:!0,type:n,action:"review",is_review:!0})},_e=s=>{let n={reviewID:e.value.reviews[0].id,data:s,industryTitle:s.industryTitle,state:s.state};S(),A("savedResponse",n)},M=p({data:{},dialog:!1,loading:!1}),ue=async s=>{M.value={...M.value,data:Object.assign({},s),dialog:!0}},we=async()=>{let s=M.value.data;M.value.dialog=!1,A("removeKPI",s)},W=s=>{let n=70;return e.value&&e.value.is_regular==0&&(n=100),s=="ecd"?(n=30,I.value&&I.value.length>0&&I.value.map((d,G)=>{n-=d.weightage})):u.value&&u.value.length>0&&u.value.map((d,G)=>{n-=d.weightage}),n};return(s,n)=>(c(),k($,null,{default:i(()=>[t("div",Ct,[l(j(Se),{modelValue:Z.value,"onUpdate:modelValue":n[0]||(n[0]=d=>Z.value=d),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),t("div",$t,[e.value&&e.value.reviews&&e.value.reviews.length>0?(c(),k(b,{key:0,onClick:xe,color:"white",class:"text-capitalize"},{default:i(()=>[V("View / Print KPI "),l(U,{icon:j(De),class:"ml-3"},null,8,["icon"])]),_:1})):h("",!0)]),t("div",It,[t("div",Tt,[l(z,{onClick:n[1]||(n[1]=()=>E("kpi")),flat:"",class:ae(`
          ${f.value=="kpi"?"":"bg-grey-darken-3 text-white"}
          d-flex align-center justify-center px-3 text-center pms-tab`)},{default:i(()=>[V(" KPI "+y(u.value?"("+u.value.length+")":"(0)"),1)]),_:1},8,["class"]),e.value&&e.value.is_regular?(c(),k(z,{key:0,onClick:n[2]||(n[2]=()=>E("ecd")),flat:"",class:ae(`${f.value=="ecd"?"":"bg-grey-darken-3 text-white"} d-flex align-center justify-center px-3 text-caption text-center pms-tab`)},{default:i(()=>[V(" Employee Capability Development "+y("("+I.value.length+")"),1)]),_:1},8,["class"])):h("",!0),e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="yearend"&&e.value.reviews[0].status=="submitted"?(c(),C("div",Rt,"Rate: Coming Soon")):h("",!0)]),l(z,{flat:""},{default:i(()=>[l(fe,{class:"px-5 py-5 d-flex align-center"},{default:i(()=>[a.value&&f.value=="kpi"?(c(),k(b,{key:0,onClick:n[3]||(n[3]=()=>ie(f.value)),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:i(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),f.value=="kpi"&&u.value&&u.value.length>0||f.value=="ecd"&&I.value&&I.value.length>0?(c(),C("div",Dt,y(f.value=="ecd"?"Employee Capability Development":f.value)+" List ",1)):a.value?(c(),C("div",St,y(f.value=="ecd"?"Employee Capability Development":f.value)+" List ",1)):(c(),C("div",Ot,y(f.value)+" not set ",1)),a.value?(c(),C("div",Pt,"Remaining "+y(f.value.toUpperCase())+" weightage: "+y(W(f.value))+"%",1)):h("",!0)]),_:1}),l(J,{class:"px-5 pb-10"},{default:i(()=>[m.value?(c(),k($,{key:0,class:"mb-2"},{default:i(()=>[t("div",jt,[l(z,{class:"rounded-lg",style:{border:"2px solid red"}},{default:i(()=>[l(J,null,{default:i(()=>[l($,null,{default:i(()=>[t("div",Kt,[l(U,{size:"large",color:"red",class:"mr-1",icon:j(Oe)},null,8,["icon"]),V(" "+y(R.value),1)])]),_:1})]),_:1})]),_:1})])]),_:1})):h("",!0),he(l($,{class:"mt-3"},{default:i(()=>[u.value&&u.value.length>0?(c(!0),C(Q,{key:0},de(u.value,d=>(c(),C("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:i(()=>[l(J,null,{default:i(()=>[l($,null,{default:i(()=>[t("div",Ut,[t("div",null,[At,t("div",Ft,y(d.title),1)]),t("div",null,[N.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"kpi")},{default:i(()=>[V("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:1,onClick:()=>ne(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",zt,[Bt,t("div",Lt,y(d.industry),1)]),t("div",Mt,[t("div",Wt,"Target ("+y(d.target_type)+")",1),t("div",Et,y(d.target),1)]),t("div",Nt,[Yt,t("div",Ht,y(d.measures),1)]),t("div",qt,[t("div",Gt,y("KPI's Weightage(%)"),1),t("div",Jt,y(d.weightage)+"%",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)):h("",!0)]),_:1},512),[[be,f.value=="kpi"]]),he(l($,{class:"mt-n3"},{default:i(()=>[t("div",Xt,[a.value?(c(),k(b,{key:0,onClick:n[4]||(n[4]=()=>ie(f.value,"technical")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:i(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),a.value?(c(),C("span",Zt,"Technical Skill")):h("",!0)]),t("div",Qt,[a.value?(c(),k(b,{key:0,onClick:n[5]||(n[5]=()=>ie(f.value,"softskill")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:i(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),V(),a.value?(c(),C("span",el,"Soft Skill")):h("",!0)]),t("div",tl,[l($,null,{default:i(()=>[(c(!0),C(Q,null,de(L.value,d=>(c(),C("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:i(()=>[l(J,null,{default:i(()=>[l($,null,{default:i(()=>[t("div",ll,[t("div",null,[al,t("div",sl,y(d.title),1)]),t("div",null,[N.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:i(()=>[V("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:1,onClick:()=>ne(d,"ecd","technical"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",il,[t("div",nl,y("KPI's Weightage(%)"),1),t("div",ol,y(d.weightage),1)]),t("div",ul,[dl,t("div",rl,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),t("div",vl,[l($,null,{default:i(()=>[(c(!0),C(Q,null,de(T.value,d=>(c(),C("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:i(()=>[l(J,null,{default:i(()=>[l($,null,{default:i(()=>[t("div",cl,[t("div",null,[ml,t("div",pl,y(d.title),1)]),t("div",null,[N.value?(c(),k(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:i(()=>[V("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:1,onClick:()=>ne(d,"ecd","softskill"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(c(),k(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:i(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",gl,[t("div",yl,y("KPI's Weightage(%)"),1),t("div",_l,y(d.weightage),1)]),t("div",fl,[hl,t("div",bl,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})])]),_:1},512),[[be,f.value=="ecd"]])]),_:1})]),_:1})]),l(ge,{modelValue:M.value.dialog,"onUpdate:modelValue":n[7]||(n[7]=d=>M.value.dialog=d),width:"100%","max-width":"480",persistent:""},{default:i(()=>[l(z,{class:"rounded-lg"},{default:i(()=>[l(fe,{class:"pa-3"},{default:i(()=>[V("Confirm Remove")]),_:1}),l(J,{class:"px-3"},{default:i(()=>[t("div",xl,[V(" Please confirm that you want to remove "),t("span",wl,y("'"+M.value.data.title.substring(0,35)+"...'"),1)]),t("div",kl,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:n[6]||(n[6]=d=>M.value.dialog=!1)},{default:i(()=>[V("Cancel")]),_:1}),l(b,{color:"primary",class:"ml-2",onClick:we},{default:i(()=>[V("Remove")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(nt,{"final-review":o.value,"measures-list":D.measuresList,"kpi-options":q.value,"remain-weightage":W(f.value),"industry-list":D.industryList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","measures-list","kpi-options","remain-weightage","industry-list","submit-button"]),l(Vt,{"final-review":o.value,"ecd-options":Y.value,"remain-weightage":W(f.value),"ecd-list":D.ecdList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","ecd-options","remain-weightage","ecd-list","submit-button"]),l(ye,{options:w.value},null,8,["options"])]),_:1}))}};export{Tl as _};
