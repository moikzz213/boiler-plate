import{u as Y,k as q,z as J,K as Q,r as c,L as Z,N as ee,c as _,w as t,V as te,o as u,a,f as l,R,G as ae,S as P,d as k,T as S,b as w,n as A,F as I,U as V,C as f,H as B,A as d,e as N,i as E,g as le,h as oe,W as U,X as se}from"./app-c0427882.js";import{c as b}from"./clientApi-7408d783.js";import{m as ne,a as ie}from"./mdi-a0a77bee.js";import{_ as ce}from"./KpiContent-0fb5d257.js";import{_ as ue}from"./EmployeeCard-eef610e6.js";import{_ as re}from"./ConfirmDialog-9f60622a.js";import{_ as de}from"./SnackBar-e6cdf10e.js";import"./vue-datepicker-5539f93b.js";import"./typeof-7fd5df1e.js";import"./defineProperty-fcf2a4a8.js";import"./printInitials-a54a9c4a.js";const pe={class:"v-col-12 v-col-md-3 pb-0"},ve=l("div",{class:"text-caption px-3 text-grey-darken-1 pt-1"}," Enter ecode, name, or email ",-1),me={key:0,class:"v-col-12 v-col-md-3 text-right pb-0"},_e=l("div",{class:"text-caption px-3 text-grey-darken-1 pt-1"},"Employee Status",-1),fe={class:"v-col-12"},ge={class:"v-col-12 v-col-md-3 d-flex align-center"},he={class:"v-col-12 v-col-md-2 d-flex flex-column"},ye=l("div",{class:"text-caption text-grey"},"Reporting To",-1),xe={class:"text-body-2"},ke={class:"v-col-12 v-col-md-2 d-flex flex-column"},we=l("div",{class:"text-caption text-grey"},"Business Unit",-1),be={class:"text-body-2"},Ce={class:"v-col-12 v-col-md-2 d-flex flex-column"},Se=l("div",{class:"text-caption text-grey"},"KPI's Target Year",-1),Ve={class:"text-body-2"},Ee={class:"v-col-12 v-col-md-1 d-flex flex-column"},Te=l("div",{class:"text-caption text-grey"},"Total KPI",-1),Re={class:"text-body-2"},Pe={key:0,class:"v-col-12 v-col-md-2 d-flex align-center"},We={__name:"SingleEmployee",setup(Ae){const r=Y(),L=q(),$=J(),z=Q(),v=c({}),g=c("Active"),T=c(""),K=c([{title:"Active",color:"success"},{title:"Inactive",color:"error"}]),F=e=>{let s=0;return e.reviews&&e.reviews.length>0&&e.reviews[0].key_review&&e.reviews[0].key_review.map((i,p)=>{s+=i.weightage}),s},n=c({}),C=async()=>{await b(r.authToken).get("/api/hr/employee/ecode/"+z.params.ecode).then(e=>{n.value=e.data,g.value=e.data.status}).catch(e=>{console.log("getEmployee",e)})},M=Z(()=>L.filteredSetting(n.value.company_id));C();const O=e=>{T.value=e.title,o.value={dialog:!0,title:"Confirm Status Update",text:"Please confirm that you want to update the status of "+n.value.display_name+" into "+e.title+".",btnColor:e.title=="Active"?"success":"error",btnTitle:"Confirm"}},W=async()=>{let e={ecode:n.value.ecode,status:T.value};o.value={...o.value,loading:!0},await b(r.authToken).post("/api/hr/employee/status/update",e).then(s=>{C().then(()=>{o.value={...o.value,loading:!1,dialog:!1},v.value={status:!0,type:"success",text:s.data.message}})}).catch(s=>{console.log("getEmployee",s),o.value={...o.value,loading:!1},v.value={status:!0,type:"error",text:"Error while updating employee"}})},h=c(""),y=c(!1),x=c([]),j=async e=>{y.value=!0,await b(r.authToken).get("/api/hr/search/employee?&filter[search]="+e).then(s=>{y.value=!1,x.value=s.data,console.log("results.value",x.value)}).catch(s=>{y.value=!1,console.log("getEmployee",s)})},D=e=>{n.value=e,g.value=e.status,$.push({name:"SingleEmployee",params:{ecode:e.ecode}}).catch(s=>{})};ee(h,(e,s)=>{e!=s&&e.length>3&&j(h.value)});const m=c({data:{},loading:!1}),G=()=>{o.value={dialog:!0,title:"Confirm Reopen",text:"Please confirm that you want to reopen the KPI for "+r.authProfile.email+".",btnColor:"primary",btnTitle:"Confirm"}},H=async()=>{m.value.data={ecode:n.value.ecode},o.value={...o.value,loading:!0},await b(r.authToken).post("/api/hr/employee/reopen",m.value.data).then(e=>{o.value={...o.value,loading:!1,dialog:!1},m.value.loading=!0,C().then(()=>{m.value.loading=!1,v.value={status:!0,type:"success",text:e.data.message}})}).catch(e=>{o.value={...o.value,loading:!1},v.value={status:!0,type:"error",text:"Error while updating employee"},console.log("getEmployee",e)})},o=c(),X=e=>{o.value.title=="Confirm Status Update"?W():o.value.title=="Confirm Reopen"&&H()};return(e,s)=>(u(),_(te,{class:"pb-16"},{default:t(()=>[a(E,{class:"mt-5 justify-space-between"},{default:t(()=>[l("div",pe,[a(R,null,{activator:t(({props:i})=>[a(ae,P(i,{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=p=>h.value=p),loading:y.value,variant:"outlined",density:"compact",class:"bg-white",label:"Search Employee","hide-details":"","append-inner-icon":k(ne)}),null,16,["modelValue","loading","append-inner-icon"])]),default:t(()=>[x.value.length>0?(u(),_(S,{key:0,density:"compact",style:{"max-height":"300px"}},{default:t(()=>[(u(!0),w(I,null,A(x.value,(i,p)=>(u(),_(V,{key:p,onClick:()=>D(i)},{default:t(()=>[a(U,null,{default:t(()=>[f(d(i.display_name+" - "+i.ecode),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(u(),_(S,{key:1,density:"compact"},{default:t(()=>[a(V,null,{default:t(()=>[f(" No results found ")]),_:1})]),_:1}))]),_:1}),ve]),["hr_admin","app_admin"].includes(k(r).authProfile.role)?(u(),w("div",me,[l("div",null,[a(R,null,{activator:t(({props:i})=>[a(B,P(i,{color:`${g.value=="Active"?"success":"error"}`,width:"120"}),{default:t(()=>[f(d(g.value),1)]),_:2},1040,["color"])]),default:t(()=>[a(S,{density:"compact"},{default:t(()=>[(u(!0),w(I,null,A(K.value,(i,p)=>(u(),_(V,{key:p,onClick:()=>O(i)},{default:t(()=>[a(U,null,{default:t(()=>[a(se,{size:"16",color:i.color,icon:k(ie)},null,8,["color","icon"]),f(" "+d(i.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_e])):N("",!0)]),_:1}),a(E,null,{default:t(()=>[l("div",fe,[a(le,{class:"elevation-0"},{default:t(()=>[a(oe,null,{default:t(()=>[a(E,null,{default:t(()=>[l("div",ge,[a(ue,{profile:n.value},null,8,["profile"])]),l("div",he,[ye,l("div",xe,d(n.value.managed_by&&n.value.managed_by.display_name?n.value.managed_by.display_name:""),1)]),l("div",ke,[we,l("div",be,d(n.value&&n.value.company?n.value.company.title:""),1)]),l("div",Ce,[Se,l("div",Ve,d(M.value.year),1)]),l("div",Ee,[Te,l("div",Re,d(F(n.value))+"/100",1)]),["hr_admin","app_admin"].includes(k(r).authProfile.role)?(u(),w("div",Pe,[a(B,{loading:m.value.loading,onClick:G,block:"",size:"large",color:"secondary",class:"text-capitalize rounded-lg"},{default:t(()=>[f("Reopen")]),_:1},8,["loading"])])):N("",!0)]),_:1})]),_:1})]),_:1})])]),_:1}),a(ce,{"selected-employee":n.value},null,8,["selected-employee"]),a(re,{options:o.value,onConfirm:X},null,8,["options"]),a(de,{options:v.value},null,8,["options"])]),_:1}))}};export{We as default};
