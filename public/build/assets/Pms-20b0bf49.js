import{u as A,k as L,x as U,r as c,Q as D,c as x,w as o,V as E,o as u,a as l,f as a,P as M,d as v,R as Y,S as j,t as k,v as S,n as b,g as w,m as I,Z as z,a3 as Q,b as C,F as Z,C as $,e as P,h as q,T as G,i as H}from"./app-b338f8d3.js";import{c as J,f as K}from"./mdi-5e26928d.js";import{c as O}from"./clientApi-542a8e2e.js";import{u as W}from"./company-8dd935bd.js";import{e as X}from"./vue-datepicker-d109fd89.js";import{_ as ee}from"./PageHeader-15f2206b.js";import"./typeof-7fd5df1e.js";import"./defineProperty-fcf2a4a8.js";const ae={class:"v-col-12 v-col-md-4"},te={class:"v-col-12 v-col-md-3"},le={class:"v-col-12 v-col-md-2"},se={class:"v-col-12"},oe=a("div",{class:"text-primary text-capitalize"},"PMS Settings",-1),ne=a("thead",null,[a("tr",null,[a("th",{class:"text-left text-capitalize"},"Company"),a("th",{class:"text-left text-capitalize"},"Year"),a("th",{class:"text-right text-capitalize"},"Actions")])],-1),ie={key:0},ce={class:"d-flex align-center justify-end"},_e={__name:"Pms",setup(re){const g=A(),f=L(),h=U(),s=c({loading:!1,company_id:null,year:new Date().getFullYear()}),d=c(!1),r=c([]),_=c(0),T=c(0),i=c(h.params&&h.params.page?h.params.page:1),y=async n=>{d.value=!0;let t="/api/hr/pms-settings/pms?filter[company]="+s.value.company_id+"&filter[year]="+s.value.year;t+="&page="+n,await O(g.authToken).get(t).then(e=>{_.value=e.data.last_page,i.value=e.data.current_page,T.value=e.data.total,r.value=e.data.data,d.value=!1}).catch(e=>{d.value=!1,console.log("getEmployees",e)})};D(i,(n,t)=>{n!=t&&(f.push({name:"PaginatedPms",params:{page:i.value}}).catch(e=>{}),y(i.value))}),g.authToken&&y(i.value);const F=()=>{f.push({name:"NewPms"}).catch(n=>{})},N=n=>{f.push({name:"SinglePms",params:{id:n}}).catch(t=>{})},R=()=>{s.value.loading=!0,y(1).then(()=>{s.value.loading=!1}).catch(n=>{s.value.loading=!1})},V=W(),m=c(!1),B=()=>{V.companies.length==0&&(m.value=!0,V.getCompanies(g.authToken).then(()=>{m.value=!1}))};return(n,t)=>(u(),x(E,{class:"pb-16"},{default:o(()=>[l(ee,{title:"PMS Settings"}),l(H,{class:"my-5"},{default:o(()=>[a("div",ae,[l(M,{modelValue:s.value.company_id,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value.company_id=e),items:v(V).active_companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white",clearable:"","hide-details":"",label:m.value?"Loading...":"Select Company",loading:m.value,onFocus:B},{selection:o(({props:e,item:p})=>[a("span",Y(j(e)),k(p.raw.title&&p.raw.title.length>30?p.raw.title.substring(0,30)+"...":p.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),a("div",te,[l(v(X),{modelValue:s.value.year,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value.year=e),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),a("div",le,[l(S,{block:"",loading:s.value.loading,onClick:R,height:"40px",color:"secondary",class:"text-capitalize"},{default:o(()=>[b("Filter")]),_:1},8,["loading"])]),a("div",se,[l(w,{class:"mb-3 rounded-lg",loading:d.value},{default:o(()=>[l(I,{class:"d-flex align-center py-3"},{default:o(()=>[l(S,{onClick:F,size:"35",class:"rounded-xl elevation-2 mr-2"},{default:o(()=>[l(z,{size:"small",icon:v(J)},null,8,["icon"])]),_:1}),oe]),_:1}),l(Q,null,{default:o(()=>[ne,r.value&&r.value.length>0?(u(),C("tbody",ie,[(u(!0),C(Z,null,$(r.value,e=>(u(),C("tr",{key:e.id},[a("td",null,k(e.company.title),1),a("td",null,k(e.year),1),a("td",null,[a("div",ce,[l(z,{size:"small",onClick:()=>N(e.id),icon:v(K),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])):P("",!0)]),_:1}),r.value&&r.value.length==0?(u(),x(w,{key:0,class:"elevation-0"},{default:o(()=>[l(q,{class:"text-center"},{default:o(()=>[b(" No records found ")]),_:1})]),_:1})):P("",!0)]),_:1},8,["loading"]),_.value>1?(u(),x(G,{key:0,modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):P("",!0)])]),_:1})]),_:1}))}};export{_e as default};
