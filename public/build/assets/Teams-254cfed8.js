import{l as L,r,o as c,b as f,F as N,C as R,c as V,w as o,f as s,v as k,n as p,t as h,e as w,a,g as $,h as S,i as D,z as U,d as j,k as ee,u as te,V as le,L as ae,s as se,q as ie,M as oe,N as B,H as ne}from"./app-c786321f.js";import H from"./KpiProgress-c0dd417b.js";import{_ as W}from"./EmployeeCard-c7580944.js";import{c as I}from"./clientApi-745d63d6.js";import{_ as de}from"./SnackBar-1575f1e0.js";import"./printInitials-a54a9c4a.js";import"./mdi-5e26928d.js";const ce={class:"d-flex align-center w-100"},re={style:{width:"25px"}},ue={style:{width:"100%"}},me={key:0,class:"mb-2",style:{color:"white","font-size":"8px","line-height":"8px",padding:"4px 10px",display:"inline-block","text-transform":"uppercase","background-color":"#2196f3",position:"absolute",top:"0",left:"0"}},ve={class:"v-col-12 v-col-md-8"},pe={class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},fe={key:0},ge=s("div",{class:"text-caption text-grey"}," Total KPI ",-1),G={__name:"SubTeams",props:{user:{type:Object,default:null}},setup(E){const z=E,C=L(),P=d=>{let x=0;return d.reviews&&d.reviews.length>0&&d.reviews[0].key_review&&d.reviews[0].key_review.map((i,_)=>{x+=i.weightage}),x},n=r(z.user),g=d=>{d.sign?d.sign=="+"?d.sign="-":(d.sign="+",m(d)):d.sign="-"},m=d=>{Object.assign([],d).teams.map((i,_)=>{i.sign="+",i.teams&&i.teams.length>0&&m(i)})};return(d,x)=>(c(),f("div",null,[(c(!0),f(N,null,R(n.value.teams,i=>(c(),V(D,{class:"v-col-12 py-0 my-0 ml-3",key:i.id},{default:o(()=>[s("div",ce,[s("div",re,[i.teams&&i.teams.length>0?(c(),V(k,{key:0,onClick:_=>g(i),class:"",color:"primary",size:"25"},{default:o(()=>[p(h(i.sign?i.sign:"+"),1)]),_:2},1032,["onClick"])):w("",!0)]),s("div",ue,[a($,{width:"100%",class:"mb-1 elevation-0"},{default:o(()=>[a(S,{style:{position:"relative"}},{default:o(()=>[i.is_regular==!1?(c(),f("div",me," Probation Employee ")):w("",!0),a(D,null,{default:o(()=>[s("div",{class:U(`v-col-12 ${i.is_regular==!1?"pt-6":""} v-col-md-3`)},[a(W,{profile:i},null,8,["profile"])],2),s("div",ve,[a(H,{density:"compact","selected-employee":i},null,8,["selected-employee"])]),s("div",pe,[j(C).pmsSettings&&j(C).pmsSettings.state!="yearend"||i.reviews&&i.reviews.length>0&&i.reviews[0].type=="probation"&&i.reviews[0].state!="final_review"?(c(),f("div",fe,[s("div",null,h(P(i))+" / 100 ",1),ge])):w("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),i.teams&&i.teams.length>0&&i.sign=="-"?(c(),V(G,{key:0,class:"w-100",user:i},null,8,["user"])):w("",!0)]),_:2},1024))),128))]))}},_e={class:"v-col-12 pb-0 d-flex"},ye={class:"text-h6"},he={href:"https://growth.gagroup.net/#!/module/4235/446",target:"_blank"},we=s("br",null,null,-1),ke=s("small",{class:"text-caption ml-5"},"Growth Academy",-1),xe={class:"v-col-12 v-col-md-3"},be={class:"v-col-12 v-col-md-3"},Te={class:"v-col-12 v-col-md-2"},Ve=s("div",{class:"v-col-12 v-col-md-2 ml-auto d-flex align-center justify-end"},[s("div",{class:"text-h6"},"Year: 2023")],-1),Ce={key:0,class:"v-col-12"},Pe={class:"d-flex align-center w-100"},$e={style:{width:"25px"}},Se={style:{width:"100%"}},De={key:0,class:"mb-2",style:{color:"white","font-size":"8px","line-height":"8px",padding:"4px 10px",display:"inline-block","text-transform":"uppercase","background-color":"#2196f3",position:"absolute",top:"0",left:"0"}},Ie={class:"v-col-12 v-col-md-8"},je={class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},ze={key:0},Ke=s("div",{class:"text-caption text-grey"}," Total KPI ",-1),Me={key:1,class:"v-col-12"},Oe={class:"pa-3 mt-3 d-flex justify-end"},Ee={class:"pa-3 mt-3 d-flex justify-end"},Ge={__name:"Teams",setup(E){const z=ee(),C=(t,l=null)=>{let e=l?Object.assign({},l):!1;z.push({name:t,params:e}).catch(u=>{})},P=r({}),n=te(),g=L(),m=r([]),d=r(new Date().getFullYear()),x=r(new Date),i=r(["All","Regular","Probation"]),_=r("Employee doesn`t have a KPI review setup for this year. Contact your HRBP for more info."),v=r({data:{employee:"",employee_type:"All"}}),Y=t=>{let l=0;return t.reviews&&t.reviews.length>0&&t.reviews[0].key_review&&t.reviews[0].key_review.map((e,u)=>{l+=e.weightage}),l},q=t=>{t.sign?t.sign=="+"?t.sign="-":(t.sign="+",F(t)):t.sign="-"},F=t=>{Object.assign([],t).teams.map((e,u)=>{e.sign="+",e.teams&&e.teams.length>0&&F(e)})},K=r(!1),b=r({}),T=r(!1),y=r(!1),J=()=>{v.value.data.employee="",m.value=O.value},Q=()=>{var t,l,e;K.value=!0,P.value={status:!0,type:"info",text:"Initializing KPI. Please wait..."},I(n.authToken).post("/api/create/employee-review/year",{ecode:b.value.ecode,is_regular:b.value.is_regular,setting:g.filteredSetting(b.value.company_id),year:d.value,author:((t=n==null?void 0:n.authProfile)==null?void 0:t.display_name)+" "+((l=n==null?void 0:n.authProfile)==null?void 0:l.ecode)}).then(u=>{setTimeout(()=>{P.value={status:!0,type:"success",text:u.data.message}},800)}),I(n.authToken).get("/api/fetch/auth-profile/kpi/"+((e=n==null?void 0:n.authProfile)==null?void 0:e.ecode)).then(u=>{n.setProfile(u.data.result).then(()=>{setTimeout(()=>{K.value=!1,C("SingleTeamMember",{id:b.value.ecode})},3e3)})}).catch(u=>{})},M=r(""),X=t=>{let l="KPI review is currently closed",e=g.filteredSetting(t.company_id);if(M.value="Do you want to set KPI for ",b.value=Object.assign({},t),t.status=="Inactive")_.value="Employee is currently Inactive, kindly contact your HRBP for more info.",y.value=!0;else if(t.reviews&&t.reviews.length>0)t.reviews[0].key_review==0&&t.reviews[0].state!="setting"?y.value=!0:t.is_regular==1&&(t.reviews[0].status=="locked"||t.reviews[0].status=="closed")?(_.value=l,y.value=!0):t.reviews[0].status=="open"?(T.value=!0,e.state!="setting"&&(M.value="Do you want to initialize the review for ")):C("SingleTeamMember",{id:t.ecode});else if(e.status=="open"&&e.state=="setting"&&t.is_regular==1)T.value=!0;else if(t.is_regular==0){let u=new Date(t.doj);u.setDate(u.getDate()+parseInt(e.probation_kpi_setting)),u>=x.value?T.value=!0:((e.status=="locked"||e.status=="closed")&&(_.value=l),y.value=!0)}else e.status=="locked"&&e.state=="closed"&&(_.value=l),y.value=!0},A=()=>{let t=O.value.filter(function(l){return v.value.data.employee?l.display_name.toLowerCase().includes(v.value.data.employee.toLowerCase())?l:l.ecode==v.value.data.employee:v.value.data.employee_type=="Probation"?l.is_regular==0:v.value.data.employee_type=="Regular"?l.is_regular==1:l});m.value=t},O=r([]);(()=>{var t;n&&n.authToken&&I(n.authToken).get("/api/fetch/team-members/"+((t=n==null?void 0:n.authProfile)==null?void 0:t.ecode)).then(l=>{m.value=l.data,O.value=l.data,console.log("res",l),l.data.length>0&&Z()}).catch(l=>{location.reload()})})();const Z=async()=>{n&&n.authToken&&await I(n.authToken).get("/api/pms-settings/all").then(t=>{g.setPmsSettings(t.data),g.setAllSettings(t.data)})};return(t,l)=>(c(),V(le,{class:"pb-16",style:{"max-width":"98%"}},{default:o(()=>[a(D,{class:"mt-5"},{default:o(()=>[s("div",_e,[s("div",ye," My Team "+h("("+m.value.length+")"),1),a(ae),s("div",null,[s("a",he,[a(k,{size:"small",color:"secondary"},{default:o(()=>[p("Watch Tutorial")]),_:1})]),we,ke])]),s("div",xe,[a(se,{modelValue:v.value.data.employee,"onUpdate:modelValue":l[0]||(l[0]=e=>v.value.data.employee=e),variant:"outlined",density:"compact",class:"bg-white","hide-details":"",clearable:"",label:"Input Employee Code",onKeydown:ie(A,["enter"]),"onClick:clear":J},null,8,["modelValue","onKeydown"])]),s("div",be,[a(oe,{modelValue:v.value.data.employee_type,"onUpdate:modelValue":l[1]||(l[1]=e=>v.value.data.employee_type=e),items:i.value,variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),s("div",Te,[a(k,{onClick:A,block:"",color:"secondary",class:"text-capitalize"},{default:o(()=>[p("Filter")]),_:1})]),Ve]),_:1}),a(D,null,{default:o(()=>[m.value&&m.value.length>0?(c(),f("div",Ce,[(c(!0),f(N,null,R(m.value,(e,u)=>(c(),f("div",{style:ne(`${e.sign&&e.sign=="-"?"border-bottom:1px solid #C6A92D;":""}`),key:e.id},[s("div",Pe,[s("div",$e,[e.teams&&e.teams.length>0?(c(),V(k,{key:0,onClick:Ae=>q(e),class:"",color:"primary",size:"25"},{default:o(()=>[p(h(e.sign?e.sign:"+"),1)]),_:2},1032,["onClick"])):w("",!0)]),s("div",Se,[a($,{width:"100%",class:"mb-1 elevation-0",onClick:()=>X(e)},{default:o(()=>[a(S,{style:{position:"relative"}},{default:o(()=>[e.is_regular==!1?(c(),f("div",De," Probation Employee ")):w("",!0),a(D,null,{default:o(()=>[s("div",{class:U(`v-col-12 ${e.is_regular==!1?"pt-6":""} v-col-md-3`)},[a(W,{profile:e},null,8,["profile"])],2),s("div",Ie,[a(H,{density:"compact","selected-employee":e},null,8,["selected-employee"])]),s("div",je,[j(g).pmsSettings&&j(g).pmsSettings.state!="yearend"||e.reviews&&e.reviews.length>0&&e.reviews[0].type=="probation"&&e.reviews[0].state!="final_review"?(c(),f("div",ze,[s("div",null,h(Y(e))+" / 100 ",1),Ke])):w("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])])]),e.teams&&e.teams.length>0&&e.sign=="-"?(c(),V(G,{key:0,user:e},null,8,["user"])):w("",!0)],4))),128))])):(c(),f("div",Me,[a($,null,{default:o(()=>[a(S,{class:"text-center"},{default:o(()=>[p(" No records found ")]),_:1})]),_:1})]))]),_:1}),a(B,{modelValue:T.value,"onUpdate:modelValue":l[3]||(l[3]=e=>T.value=e),width:"450"},{default:o(()=>[a($,{class:"rounded-lg"},{default:o(()=>[a(S,null,{default:o(()=>[p(h(M.value)+" "+h(b.value.first_name)+"? ",1)]),_:1}),s("div",Oe,[a(k,{color:"primary",variant:"text",onClick:l[2]||(l[2]=e=>T.value=!1)},{default:o(()=>[p("Cancel")]),_:1}),a(k,{loading:K.value,color:"secondary",class:"ml-2 px-8",onClick:Q},{default:o(()=>[p("yes")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>y.value=e),width:"450"},{default:o(()=>[a($,{class:"rounded-lg"},{default:o(()=>[a(S,null,{default:o(()=>[p(h(_.value),1)]),_:1}),s("div",Ee,[a(k,{color:"secondary",variant:"text",onClick:l[4]||(l[4]=e=>y.value=!1)},{default:o(()=>[p("Close")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),a(de,{options:P.value},null,8,["options"])]),_:1}))}};export{Ge as default};
