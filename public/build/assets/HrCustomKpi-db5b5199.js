import{u as N,r as i,z as B,K as O,N as E,c as x,w as u,V as L,o as p,a as l,f as e,g as k,B as $,a2 as j,b as V,n as S,F,h as H,C as D,e as K,Q as M,i as Q,A as f,X as P,d as b}from"./app-c0427882.js";import{c as y}from"./clientApi-7408d783.js";import{e as U,f as X}from"./mdi-a0a77bee.js";import{_ as q}from"./PageHeader-2dd49f92.js";import{_ as G}from"./CustomKpiDialog-4eccf846.js";import{_ as J}from"./ConfirmDialog-9f60622a.js";import{_ as W}from"./SnackBar-e6cdf10e.js";import"./industry-50651cef.js";const Y=e("div",{class:"v-col-12"},[e("div",{class:"text-h6"},"Custom KPI")],-1),Z={class:"v-col-12"},ee=e("div",{class:"text-primary text-capitalize"},"KPI List",-1),te=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-capitalize"},"Title"),e("th",{class:"text-left text-capitalize"},"Type"),e("th",{class:"text-left text-capitalize"},"Industry"),e("th",{class:"text-left text-capitalize"},"Author"),e("th",{class:"text-right text-capitalize"},"Actions")])],-1),ae={class:"d-flex align-center justify-end"},de={__name:"HrCustomKpi",setup(se){const g=N(),c=i({}),w=B(),h=O(),r=i({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),d=i([]),v=i(!1),_=i(0),o=i(h.params&&h.params.page?h.params.page:1),m=async t=>{v.value=!0,await y(g.authToken).get("/api/hr/kpi/list/pending/?page="+t).then(s=>{_.value=s.data.last_page,o.value=s.data.current_page,d.value=s.data.data,v.value=!1}).catch(s=>{console.log("getCustomKpi",s.response),v.value=!1})};m(o.value);const T=t=>{r.value={...r.value,title:"Edit KPI ",data:Object.assign({},t),loading:!1,dialog:!0,type:"kpi",action:"approve",is_review:!1}},z=async t=>{let s={id:t.id};await y(g.authToken).post("/api/hr/custom-kpi/approve",s).then(a=>{m(o.value).then(()=>{c.value={status:!0,type:"success",text:a.data.message},r.value={...r.value,dialog:!1,loading:!1}})}).catch(a=>{c.value={status:!0,type:"error",text:"Error while trying to approve Custom KPI"},r.value={...r.value,loading:!1}})};E(o,(t,s)=>{t!=s&&(w.push({name:"PaginatedHrMasterKpi",params:{page:o.value}}).catch(a=>{}),m(o.value))});const n=i({}),C=i({}),I=t=>{C.value=Object.assign({},t),n.value={dialog:!0,title:"Confirm Remove",text:"Please confirm that you want to remove "+t.title+".",btnColor:"error",btnTitle:"Confirm"}},R=async()=>{await y(g.authToken).post("/api/hr/kpi/remove/"+C.value.id).then(t=>{m(o.value).then(()=>{c.value={status:!0,type:"success",text:t.data.message}})}).catch(t=>{c.value={status:!0,type:"error",text:"Error while removing data"}})},A=t=>{n.value={...n.value,loading:!0},R().then(s=>{n.value={...n.value,dialog:!1,loading:!1}}).catch(s=>{n.value={...n.value,loading:!1}})};return(t,s)=>(p(),x(L,{class:"pb-16"},{default:u(()=>[l(q,{title:"Custom KPI"}),l(Q,{class:"my-5"},{default:u(()=>[Y,e("div",Z,[l(k,{class:"mb-3 rounded-lg",loading:v.value},{default:u(()=>[l($,{class:"d-flex align-center"},{default:u(()=>[ee]),_:1}),l(j,null,{default:u(()=>[te,e("tbody",null,[(p(!0),V(F,null,S(d.value,a=>(p(),V("tr",{key:a.id},[e("td",null,f(a.title),1),e("td",null,f(a.type),1),e("td",null,f(a.industry&&a.industry.title),1),e("td",null,f(a.profile&&a.profile.display_name),1),e("td",null,[e("div",ae,[l(P,{size:"small",onClick:()=>T(a),icon:b(U),class:"mx-1"},null,8,["onClick","icon"]),l(P,{size:"small",onClick:()=>I(a),icon:b(X),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])]),_:1}),d.value&&d.value.length==0?(p(),x(k,{key:0},{default:u(()=>[l(H,{class:"text-center"},{default:u(()=>[D(" No records found ")]),_:1})]),_:1})):K("",!0)]),_:1},8,["loading"]),_.value>1?(p(),x(M,{key:0,modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value=a),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):K("",!0)])]),_:1}),l(G,{"kpi-options":r.value,onApprove:z},null,8,["kpi-options"]),l(J,{options:n.value,onConfirm:A},null,8,["options"]),l(W,{options:c.value},null,8,["options"])]),_:1}))}};export{de as default};
