import{u as E,k as F,x as O,r,Q as S,A as $,c as w,w as s,V as U,o as g,a,f as o,g as V,m as I,v as h,Z as T,d as P,a3 as L,t as m,b as C,F as M,C as Q,e as k,h as Z,n as _,T as q,i as b,s as G,N as H,z as J}from"./app-07292aad.js";import{c as K,f as X}from"./mdi-9c5e96e3.js";import{_ as Y}from"./PageHeader-ca36ddcf.js";import{c as z}from"./clientApi-86b20a3c.js";import{_ as ee}from"./ConfirmDialog-37afeba6.js";import{_ as ae}from"./SnackBar-505cf931.js";const te={class:"v-col-12"},le=o("div",{class:"text-primary text-capitalize"},"Weightages",-1),se={class:"text-left text-capitalize"},oe=o("th",{class:"text-center text-capitalize"},"Status",-1),ie=o("th",{class:"text-right text-capitalize"},"Actions",-1),ne={key:0},ue={class:"text-center"},de={class:"d-flex align-center justify-end"},re={class:J("v-col-12 px-4")},ce={class:"v-col-12"},ve={class:"v-col-12 py-0"},ge={class:"v-col-12 d-flex justify-end"},we={__name:"Weightages",setup(pe){const p=E(),W=F(),x=O(),c=r({}),v=r([]),t=r({title:"",data:{},loading:!1,dialog:!1,action:"add"}),y=r(0),n=r(x.params&&x.params.page?x.params.page:1),f=async l=>{await z(p.authToken).get("/api/hr/weightages?page="+l).then(e=>{y.value=e.data.last_page,n.value=e.data.current_page,v.value=e.data.data}).catch(e=>{console.log("weightages",e)})},N=async()=>{let l={profile_id:p.authProfile.id,id:t.value.action=="edit"?t.value.data.id:null,title:t.value.data.title};t.value.loading=!0,await z(p.authToken).post("/api/hr/weightage/save",l).then(e=>{f(n.value).then(()=>{t.value.loading=!1,t.value.dialog=!1,c.value={status:!0,type:"success",text:e.data.message}})}).catch(e=>{t.value.loading=!1,console.log("weightages",e),e.response.data.message.includes("Duplicate entry")==!0?c.value={status:!0,type:"error",text:l.title+" already exist"}:c.value={status:!0,type:"error",text:"Error while saving weightage"}})},R=()=>{t.value={...t.value,title:"Add Weightage",data:{},dialog:!0,action:"add"}},A=l=>{t.value={...t.value,title:"Edit "+l.title,data:Object.assign({},l),dialog:!0,action:"edit"}};S(n,(l,e)=>{l!=e&&(W.push({name:"PaginatedWeightages",params:{page:n.value}}).catch(i=>{}),f(n.value))}),$(()=>{f(n.value)});const u=r({}),d=r({}),B=l=>{d.value=Object.assign({},l),d.value.new_status=d.value.status=="active"?"inactive":"active",u.value={dialog:!0,title:"Confirm",text:"Please confirm that you want to update the status of "+l.title+" to "+d.value.new_status+".",btnColor:d.value.new_status=="active"?"success":"error",btnTitle:d.value.new_status}},j=async()=>{let l={status:d.value.new_status,profile_id:p.authProfile.id};await z(p.authToken).post("/api/hr/weightage/update-status/"+d.value.id,l).then(e=>{f(n.value).then(()=>{c.value={status:!0,type:"success",text:e.data.message}})}).catch(e=>{c.value={status:!0,type:"error",text:"Error while removing data"}})},D=l=>{u.value={...u.value,loading:!0},j().then(e=>{u.value={...u.value,dialog:!1,loading:!1}}).catch(e=>{u.value={...u.value,loading:!1}})};return(l,e)=>(g(),w(U,{class:"pb-16"},{default:s(()=>[a(Y,{title:"Weightages"}),a(b,{class:"my-5"},{default:s(()=>[o("div",te,[a(V,{class:"rounded-lg"},{default:s(()=>[a(I,{class:"d-flex align-center"},{default:s(()=>[a(h,{onClick:R,density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:s(()=>[a(T,{size:"small",icon:P(K)},null,8,["icon"])]),_:1}),le]),_:1}),a(L,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",se,m("Weightage (%)"),1),oe,ie])]),v.value&&v.value.length>0?(g(),C("tbody",ne,[(g(!0),C(M,null,Q(v.value,i=>(g(),C("tr",{key:i.id},[o("td",null,m(i.title+"%"),1),o("td",ue,[a(h,{size:"small",onClick:()=>B(i),color:i.status=="active"?"success":"error",class:"mx-1 rounded-xl"},{default:s(()=>[_(m(i.status),1)]),_:2},1032,["onClick","color"])]),o("td",null,[o("div",de,[a(T,{size:"small",onClick:()=>A(i),icon:P(X),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])):k("",!0)]),_:1}),v.value&&v.value.length==0?(g(),w(V,{key:0},{default:s(()=>[a(Z,{class:"text-center"},{default:s(()=>[_(" No records found ")]),_:1})]),_:1})):k("",!0)]),_:1}),y.value>1?(g(),w(q,{key:0,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value=i),class:"my-4",length:y.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):k("",!0)])]),_:1}),a(H,{modelValue:t.value.dialog,"onUpdate:modelValue":e[3]||(e[3]=i=>t.value.dialog=i),width:"100%","max-width":"480px",persistent:""},{default:s(()=>[a(V,{class:"rounded-lg"},{default:s(()=>[a(b,{class:"ma-0 pa-0"},{default:s(()=>[o("div",re,[a(b,null,{default:s(()=>[o("div",ce,m(t.value.title)+" "+m(),1),o("div",ve,[a(G,{type:"number",modelValue:t.value.data.title,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value.data.title=i),label:"Weightage*",variant:"outlined",density:"compact"},null,8,["modelValue"])]),o("div",ge,[a(h,{color:"primary",variant:"text",onClick:e[2]||(e[2]=i=>t.value.dialog=!1)},{default:s(()=>[_("Cancel")]),_:1}),a(h,{color:"primary",loading:t.value.loading,class:"ml-2 px-8",onClick:N},{default:s(()=>[_("save")]),_:1},8,["loading"])])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ee,{options:u.value,onConfirm:D},null,8,["options"]),a(ae,{options:c.value},null,8,["options"])]),_:1}))}};export{we as default};
