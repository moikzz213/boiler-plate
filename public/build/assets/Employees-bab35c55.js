import{u as z,z as A,K as L,r as d,N as U,c as f,w as i,V as j,o as c,a as o,f as t,A as w,G as I,M as K,d as O,O as $,P as D,I as G,H as k,C as h,i as V,b,F as H,n as M,Q,e as q,g as R,h as F}from"./app-d2fb1262.js";import{c as J}from"./clientApi-2b4a321a.js";import{u as W}from"./company-9750b873.js";import X from"./KpiProgress-3cf08e3a.js";import{_ as Y}from"./EmployeeCard-d6e2f4e2.js";import"./printInitials-a54a9c4a.js";import"./mdi-a0a77bee.js";const Z={class:"v-col-12"},ee={class:"text-h6"},ae={class:"v-col-12 v-col-md-3"},le={class:"v-col-12 v-col-md-4"},te={class:"v-col-12 v-col-md-2"},oe={class:"v-col-12 v-col-md-3"},se={class:"d-flex justify-space-between"},ie={key:0,class:"v-col-12"},ne={class:"v-col-12 v-col-md-3"},de={class:"v-col-12 v-col-md-8"},ce=t("div",{class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},[t("div",null,[t("div",null,"50/100"),t("div",{class:"text-caption text-grey"},"Total KPI")])],-1),ue={key:1,class:"v-col-12"},he={__name:"Employees",setup(re){const p=z(),x=A(),v=L(),E=(s,l=null)=>{let e=l?Object.assign({},l):!1;x.push({name:s,params:e}).catch(u=>{})},g=W(),r=d(!1),P=()=>{g.companies.length==0&&(r.value=!0,g.getCompanies(p.authToken).then(()=>{r.value=!1}))},S=d([{value:1,title:"Regular"},{value:0,title:"Probation"}]),a=d({loadingReset:!1,loadingFilter:!1,data:{employee:null,company_id:null,is_regular:1}}),T=async()=>{a.value.loadingFilter=!0,m(1).then(()=>{a.value.loadingFilter=!1}).catch(s=>{a.value.loadingFilter=!1})},N=async()=>{a.value.data={employee:null,company_id:null,is_regular:1},a.value.loadingReset=!0,m(1).then(()=>{a.value.loadingReset=!1}).catch(s=>{a.value.loadingReset=!1})},y=d([]),_=d(0),C=d(0),n=d(v.params&&v.params.page?v.params.page:1),m=async s=>{let l="/api/hr/employees?&filter[is_regular]="+a.value.data.is_regular+"&filter[hrbp_email]="+p.authProfile.email;a.value.data.company_id!==null&&(l+="&filter[company_id]="+a.value.data.company_id),a.value.data.employee!==null&&(l+="&filter[employee]="+a.value.data.employee),l+="&page="+s,await J(p.authToken).get(l).then(e=>{_.value=e.data.last_page,n.value=e.data.current_page,C.value=e.data.total,y.value=e.data.data}).catch(e=>{console.log("getEmployees",e)})};U(n,(s,l)=>{s!=l&&(x.push({name:"PaginatedEmployees",params:{page:n.value}}).catch(e=>{}),m(n.value))}),m(n.value);const B=s=>{console.log("profile",s),E("SingleEmployee",{ecode:s.ecode})};return(s,l)=>(c(),f(j,{class:"pb-16"},{default:i(()=>[o(V,{class:"mt-5"},{default:i(()=>[t("div",Z,[t("div",ee,"Employee List "+w("("+C.value+")"),1)]),t("div",ae,[o(I,{modelValue:a.value.data.employee,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.data.employee=e),variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Input Employee"},null,8,["modelValue"])]),t("div",le,[o(K,{modelValue:a.value.data.company_id,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.data.company_id=e),items:O(g).companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:r.value?"Loading...":"Select Company",loading:r.value,clearable:"",onFocus:P},{selection:i(({props:e,item:u})=>[t("span",$(D(e)),w(u.raw.title&&u.raw.title.length>20?u.raw.title.substring(0,20)+"...":u.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),t("div",te,[o(G,{modelValue:a.value.data.is_regular,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.data.is_regular=e),items:S.value,"item-title":"title","item-value":"value",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),t("div",oe,[t("div",se,[o(k,{onClick:N,height:"40px",variant:"text",color:"primary",class:"bg-grey-lighten-2 text-capitalize",loading:a.value.loadingReset,style:{width:"48%"}},{default:i(()=>[h("Reset")]),_:1},8,["loading"]),o(k,{onClick:T,height:"40px",color:"primary",class:"text-capitalize",loading:a.value.loadingFilter,style:{width:"48%"}},{default:i(()=>[h("Search")]),_:1},8,["loading"])])])]),_:1}),o(V,null,{default:i(()=>[y.value.length>0?(c(),b("div",ie,[(c(!0),b(H,null,M(y.value,e=>(c(),f(R,{key:e.id,class:"mb-3 elevation-0",onClick:()=>B(e)},{default:i(()=>[o(F,null,{default:i(()=>[o(V,null,{default:i(()=>[t("div",ne,[o(Y,{profile:e},null,8,["profile"])]),t("div",de,[o(X,{density:"compact","selected-employee":e},null,8,["selected-employee"])]),ce]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),_.value>1?(c(),f(Q,{key:0,modelValue:n.value,"onUpdate:modelValue":l[3]||(l[3]=e=>n.value=e),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):q("",!0)])):(c(),b("div",ue,[o(R,null,{default:i(()=>[o(F,{class:"text-center"},{default:i(()=>[h(" No records found ")]),_:1})]),_:1})]))]),_:1})]),_:1}))}};export{he as default};
