import{r as p,N as K,o as v,b as V,a as l,w as n,g as z,i as $,f as t,Y as ae,A as y,M as me,O as Ve,P as Ce,I as le,G as O,Z as $e,$ as pe,a0 as te,H as b,C,e as h,c as w,J as ge,F as Q,z as Ie,K as Te,u as Re,k as De,L as q,d as j,X as U,B as fe,h as J,q as he,n as de,v as be}from"./app-a7c55d1f.js";import{b as Oe,c as re,d as Se,e as je,f as ve,g as ce}from"./mdi-1daeeafa.js";import{e as Pe}from"./vue-datepicker-9af490b2.js";import{_ as ye}from"./SnackBar-8c75c0a2.js";const Ue={class:"v-col-12"},Ke={class:"v-col-12 v-col-md-6 py-0"},Ae={class:"v-col-12 v-col-md-6 py-0"},Fe={class:"v-col-12 v-col-md-3 py-0"},ze={class:"v-col-12 v-col-md-3 py-0"},Be={class:"v-col-12 v-col-md-3 py-0"},Le={class:"v-col-12 v-col-md-3 py-0"},Me={class:"v-col-12 py-0"},We={class:"v-col-12 pt-0"},Ee={class:"v-col-12 py-0"},Ne={class:"v-col-12 py-0"},Ye={class:"v-col-12 py-0"},He={class:"v-col-12 py-0 hidden hide",hidden:""},qe={class:"v-col-12 py-0"},Ge={key:0,class:"v-col-12 d-flex justify-end"},Je={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},Xe=t("div",{class:"v-col-12 px-1"},y("Review"),-1),Ze={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},Qe={class:"v-col-12 v-col-md-6 py-0 px-1"},et={class:"v-col-12 v-col-md-6 py-0 px-1"},tt={class:"v-col-12 v-col-md-6 py-0 px-1"},lt={class:"v-col-12 v-col-md-6 py-0 px-1"},at={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},it={class:"v-col-12 py-0 px-1"},st={class:"v-col-12 v-col-md-6 py-0 px-1"},nt={class:"v-col-12 v-col-md-6 py-0 px-1"},ot={class:"v-col-12 d-flex justify-end"},ut={__name:"KpiDialog",props:{kpiOptions:{type:Object,default:null},submitButton:{type:Boolean,default:!0},industryList:{type:Object,default:null},remainWeightage:{type:Number,default:70},measuresList:{type:Object,default:null},finalReview:{type:Boolean,default:!1}},emits:["savedResponse"],setup(D,{emit:A}){const x=D,F=p({}),g=p(["min","max"]),E=p([]),k=p(["5%","10%","15%","20%","25%","30%"]),P=p(null),e=p({}),u=p({measures:null}),I=p([]),B=p([]),T=p(""),r=p(""),m=p(""),_=p(!1),S=p(!0),R=p([]),X=()=>{_.value=!0,e.value.data=u.value,e.value.industryTitle=m.value,setTimeout(()=>{_.value=!1,e.value.dialog=!1,A("savedResponse",e.value)},1200),T.value=x.kpiOptions.data.industry},ee=()=>{e.value.dialog=!1,(e.value.action=="edit"||e.value.action=="review")&&(T.value=x.kpiOptions.data.industry,r.value=x.kpiOptions.data.title)},ie=()=>{x.finalReview.isFinal?e.value.state="final":e.value.state="mid",X()};K(()=>x.kpiOptions,c=>{_.value=!1,B.value=x.industryList,console.log("listIndustries.value",B.value),u.value=Object.assign({},c.data),e.value=Object.assign({},c),e.value.action=="edit"||e.value.action=="review"||e.value.action=="readonly"?(T.value=c.data.industry,r.value=c.data.title,P.value=c.data.weightage,S.value=!1):(T.value=null,r.value=null,P.value=null,S.value=!0)}),K(()=>T.value,c=>{I.value=[],E.value=x.measuresList,e.value.action=="add"?(S.value=!0,u.value={},r.value=null,c&&(R.value.push("industry"),f(),m.value=c.title,B.value.map(a=>{a.id==c.id&&(I.value=a.kpis)}))):(R.value.push("industry"),S.value=!1)}),K(()=>r.value,c=>{if(e.value.action=="add"){u.value={};let a=I.value.filter(o=>o.id==c);a&&a.length>0&&(u.value=a[0],S.value=!1,R.value.push("kpi"),f())}else R.value.push("kpi")}),K(()=>u.value.weightage,c=>{let a=!1;if(!isNaN(c)||c==null||c==null)a=!1;else if(e.value.action=="add")parseInt(c)>x.remainWeightage?(a=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):a=!0;else{let o=parseInt(x.remainWeightage)+parseInt(P.value)-parseInt(c);parseInt(o)<0?(a=!1,F.value={status:!0,type:"error",text:"Weightage is over the limit!"}):P.value>parseInt(c)||parseInt(o)>=0?a=!0:a=!1}a?(R.value.push("weightage"),f()):Y("weightage")});const f=()=>{R.value=R.value.filter((c,a)=>R.value.indexOf(c)===a)},Y=c=>{const a=R.value.indexOf(c);a>-1&&R.value.splice(a,1)};return K(()=>u.value.target,c=>{c?(R.value.push("target"),f()):Y("target")}),K(()=>u.value.measures,c=>{c?(R.value.push("measures"),f()):Y("measures")}),K(()=>u.value.target_type,c=>{R.value.push("target_type"),f(),c=="min"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Exceeding the Target</span> <br/><span style="color:red">Negative Ranking = Falling short of the Target</span>':c=="max"?u.value.evaluation_pattern='<span style="color:green">Positive Ranking = Falling short of the Target</span> <br/><span style="color:red">Negative Ranking = Exceeding the Target</span>':(Y("target_type"),u.value.evaluation_pattern="")}),(c,a)=>(v(),V(Q,null,[l(ge,{modelValue:e.value.dialog,"onUpdate:modelValue":a[18]||(a[18]=o=>e.value.dialog=o),width:"100%","max-width":`${e.value.is_review==!0?"1240":"900"} `,persistent:""},{default:n(()=>[l(z,{class:"rounded-lg"},{default:n(()=>[l($,{class:"ma-0 pa-0"},{default:n(()=>[t("div",{class:ae(`v-col-12 ${e.value.is_review==!0?"v-col-md-8":""} px-4`)},[l($,null,{default:n(()=>[t("div",Ue,y(e.value.title),1),t("div",Ke,[l(me,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=o=>T.value=o),items:D.industryList,"item-title":"title","item-value":"title","return-object":"",disabled:e.value.action=="edit"||e.value.is_review,variant:"outlined",density:"compact",label:"Select Industry*"},null,8,["modelValue","items","disabled"])]),t("div",Ae,[l(me,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value=o),items:I.value,"item-title":"title","item-value":"id",variant:"outlined",disabled:e.value.action=="edit"||e.value.is_review,density:"compact",label:"Select KPI*"},{selection:n(({props:o,item:H})=>[t("span",Ve(Ce(o)),y((H==null?void 0:H.title.substring(0,35))+"..."),17)]),_:1},8,["modelValue","items","disabled"])]),t("div",Fe,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.target_type,"onUpdate:modelValue":a[2]||(a[2]=o=>u.value.target_type=o),items:g.value,label:"Target Type*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",ze,[l(O,{disabled:S.value||e.value.is_review,modelValue:u.value.target,"onUpdate:modelValue":a[3]||(a[3]=o=>u.value.target=o),label:"Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",Be,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.measures,"onUpdate:modelValue":a[4]||(a[4]=o=>u.value.measures=o),items:E.value,label:"Measures*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Le,[l(le,{disabled:S.value||e.value.is_review,modelValue:u.value.weightage,"onUpdate:modelValue":a[5]||(a[5]=o=>u.value.weightage=o),items:k.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["disabled","modelValue","items"])]),t("div",Me,[l($,{class:"mx-0 mb-3"},{default:n(()=>[l($e,{class:"pa-3",style:{border:"1px solid #b1b1b1","border-radius":"5px","min-height":"70px"},innerHTML:u.value.evaluation_pattern},null,8,["innerHTML"])]),_:1})]),t("div",We,[l(pe,{class:"mx-auto"})]),t("div",Ee,[l(te,{modelValue:u.value.definition,"onUpdate:modelValue":a[6]||(a[6]=o=>u.value.definition=o),readonly:S.value||e.value.action=="edit"||e.value.is_review,label:"KPI Definition*",variant:"outlined",rows:"2"},null,8,["modelValue","readonly"])]),t("div",Ne,[l(te,{modelValue:u.value.formula,"onUpdate:modelValue":a[7]||(a[7]=o=>u.value.formula=o),readonly:"",label:"Calculation Formula*",disabled:"",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",Ye,[l(te,{modelValue:u.value.subordinate_measures,"onUpdate:modelValue":a[8]||(a[8]=o=>u.value.subordinate_measures=o),readonly:"",label:"Subordinate Measures*",disabled:"",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",He,[l(te,{modelValue:u.value.calculation_example,"onUpdate:modelValue":a[9]||(a[9]=o=>u.value.calculation_example=o),readonly:"",label:"KPI Calculation Example*",disabled:"",variant:"outlined",rows:"2"},null,8,["modelValue"])]),t("div",qe,[l(pe,{class:"mx-auto"})]),e.value.is_review?h("",!0):(v(),V("div",Ge,[l(b,{color:"primary",variant:"text",onClick:ee},{default:n(()=>[C("Cancel")]),_:1}),l(b,{loading:_.value,disabled:R.value.length<6,color:"primary",class:"ml-2 px-8",onClick:X},{default:n(()=>[C("save")]),_:1},8,["loading","disabled"])]))]),_:1})],2),e.value.is_review?(v(),V("div",Je,[l($,{class:"px-3"},{default:n(()=>[Xe,t("div",Ze,y(e.value.is_regular?"Mid-year Achievement":"First Review Achievement"),1),t("div",Qe,[l(O,{disabled:D.finalReview.isFinal||e.value.action=="readonly",modelValue:u.value.achievement_midyear,"onUpdate:modelValue":a[10]||(a[10]=o=>u.value.achievement_midyear=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])]),t("div",et,[l(O,{readonly:"",modelValue:c.mid_target_variation,"onUpdate:modelValue":a[11]||(a[11]=o=>c.mid_target_variation=o),label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",tt,[e.value.is_regular?(v(),w(O,{key:0,disabled:D.finalReview.isFinal||e.value.action=="readonly",modelValue:u.value.revised_annual_target,"onUpdate:modelValue":a[12]||(a[12]=o=>u.value.revised_annual_target=o),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["disabled","modelValue"])):h("",!0)]),t("div",lt,[e.value.is_regular?(v(),w(O,{key:0,readonly:"",modelValue:u.value.mid_year_remainder_target,"onUpdate:modelValue":a[13]||(a[13]=o=>u.value.mid_year_remainder_target=o),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])):h("",!0)])]),_:1}),D.finalReview.isFinal?(v(),w($,{key:0,class:"px-3"},{default:n(()=>[t("div",at,y(e.value.is_regular?"Year-end Achievement":"Final Review Achievement"),1),t("div",it,[l(O,{modelValue:u.value.achievement_yearend,"onUpdate:modelValue":a[14]||(a[14]=o=>u.value.achievement_yearend=o),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",st,[l(O,{readonly:"",modelValue:c.final_target_variation,"onUpdate:modelValue":a[15]||(a[15]=o=>c.final_target_variation=o),disabled:"",label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",nt,[l(O,{modelValue:u.value.year_end_remainder_target,"onUpdate:modelValue":a[16]||(a[16]=o=>u.value.year_end_remainder_target=o),disabled:"",label:"Remainer Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])])]),_:1})):h("",!0),l($,null,{default:n(()=>[t("div",ot,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:a[17]||(a[17]=o=>e.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),e.value.action!="readonly"&&x.submitButton&&D.finalReview.saveBtn?(v(),w(b,{key:0,loading:_.value,color:"primary",class:"ml-2",onClick:ie},{default:n(()=>[C("Save")]),_:1},8,["loading"])):h("",!0)])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),l(ye,{options:F.value},null,8,["options"])],64))}},dt={class:"v-col-12"},rt={class:"v-col-12 py-0"},vt={class:"v-col-12 py-0"},ct={class:"v-col-12 py-0"},mt={key:0,class:"v-col-12 d-flex justify-end"},pt={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},gt=t("div",{class:"v-col-12 px-1"},y("Review"),-1),yt=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Mid-year Achievement ",-1),_t={class:"v-col-12 v-col-md-6 py-0 px-1"},ft={class:"v-col-12 v-col-md-6 py-0 px-1"},ht={class:"v-col-12 v-col-md-6 py-0 px-1"},bt={class:"v-col-12 v-col-md-6 py-0 px-1"},xt=t("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Year-year Achievement ",-1),wt={class:"v-col-12 py-0 px-1"},kt={class:"v-col-12 v-col-md-6 py-0 px-1"},Vt={class:"v-col-12 v-col-md-6 py-0 px-1"},Ct={class:"v-col-12 d-flex justify-end"},$t={__name:"EcdDialog",props:{ecdOptions:{type:Object,default:null},ecdList:{type:Object,default:null},remainWeightage:{type:Number,default:30}},emits:["savedResponse"],setup(D,{emit:A}){const x=D,F=p(null),g=p({}),E=p([]),k=p({}),P=p(null),e=p(null),u=p(["5%","10%","15%","20%"]),I=()=>{g.value.weightage=e.value,g.value.ecd_type=x.ecdOptions.ecdType,k.value.data=g.value,k.value.dialog=!1,A("savedResponse",k.value)};K(()=>x.ecdOptions,r=>{g.value=Object.assign({},r.data),E.value=x.ecdList.filter(m=>m.ecd_type==r.ecdType||m.ecd_type=="both"),k.value=Object.assign({},r),k.value.action=="edit"?(F.value=r.data.weightage,P.value=r.data.title,e.value=r.data.weightage):(F.value=null,P.value=null,e.value=null)}),K(()=>P.value,r=>{k.value.action=="add"&&(g.value={},g.value=r)});const B=p({}),T=p(!1);return K(()=>e.value,r=>{if(!isNaN(r)||r==null||r==null)T.value=!1;else if(k.value.action=="add")parseInt(r)>x.remainWeightage?(T.value=!1,B.value={status:!0,type:"error",text:"Weightage is over the limit!"}):T.value=!0;else{let m=parseInt(x.remainWeightage)+parseInt(F.value)-parseInt(r);parseInt(m)<0?(T.value=!1,B.value={status:!0,type:"error",text:"Weightage is over the limit!"}):F.value>parseInt(r)||parseInt(m)>=0?T.value=!0:T.value=!1}}),(r,m)=>(v(),V(Q,null,[l(ge,{modelValue:k.value.dialog,"onUpdate:modelValue":m[11]||(m[11]=_=>k.value.dialog=_),width:"100%","max-width":`${D.ecdOptions.is_review==!0?"1240":"700"} `,persistent:""},{default:n(()=>[l(z,{class:"rounded-lg"},{default:n(()=>[l($,{class:"ma-0 pa-0"},{default:n(()=>[t("div",{class:ae(`v-col-12 ${D.ecdOptions.is_review==!0?"v-col-md-8":""} px-4`)},[l($,null,{default:n(()=>[t("div",dt,y(k.value.title),1),t("div",rt,[l(me,{modelValue:P.value,"onUpdate:modelValue":m[0]||(m[0]=_=>P.value=_),items:E.value,"item-title":"title","item-value":"id","return-object":"",variant:"outlined",density:"compact",label:"Select *"},null,8,["modelValue","items"])]),t("div",vt,[l(le,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=_=>e.value=_),items:u.value,label:"Development Weightage (%)*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),t("div",ct,[l(pe,{class:"mx-auto"})]),k.value.is_review?h("",!0):(v(),V("div",mt,[l(b,{color:"primary",variant:"text",onClick:m[2]||(m[2]=_=>k.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),l(b,{disabled:!T.value,color:"primary",class:"ml-2 px-8",onClick:I},{default:n(()=>[C("save")]),_:1},8,["disabled"])]))]),_:1})],2),k.value.is_review?(v(),V("div",pt,[l($,{class:"px-3"},{default:n(()=>[gt,yt,t("div",_t,[l(O,{modelValue:g.value.revised_annual_target,"onUpdate:modelValue":m[3]||(m[3]=_=>g.value.revised_annual_target=_),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",ft,[l(O,{modelValue:g.value.mid_year_remainder_target,"onUpdate:modelValue":m[4]||(m[4]=_=>g.value.mid_year_remainder_target=_),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",ht,[l(O,{modelValue:g.value.mid_year_achievement,"onUpdate:modelValue":m[5]||(m[5]=_=>g.value.mid_year_achievement=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",bt,[l(O,{modelValue:g.value.mid_year_target_variation,"onUpdate:modelValue":m[6]||(m[6]=_=>g.value.mid_year_target_variation=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),xt,t("div",wt,[l(O,{modelValue:g.value.year_end_achievement,"onUpdate:modelValue":m[7]||(m[7]=_=>g.value.year_end_achievement=_),label:"Year-end Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",kt,[l(O,{modelValue:g.value.year_end_target_variation,"onUpdate:modelValue":m[8]||(m[8]=_=>g.value.year_end_target_variation=_),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",Vt,[l(O,{modelValue:g.value.year_end_remainder_target,"onUpdate:modelValue":m[9]||(m[9]=_=>g.value.year_end_remainder_target=_),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),t("div",Ct,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:m[10]||(m[10]=_=>k.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),l(b,{color:"primary",class:"ml-2",onClick:r.submitReview},{default:n(()=>[C("Submit")]),_:1},8,["onClick"])])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),l(ye,{options:B.value},null,8,["options"])],64))}};const It={class:"v-col-12 v-col-md-2"},Tt={class:"v-col-12 v-col-md-2"},Rt={class:"v-col-12"},Dt={class:"d-flex align-center px-3"},Ot={key:1,class:"ml-auto text-h6"},St={key:1,class:"text-uppercase text-primary"},jt={key:2,class:"text-uppercase text-center",style:{display:"block !important",width:"100%"}},Pt={key:3,class:"text-uppercase text-center"},Ut={key:4,class:"ml-auto text-body-1"},Kt={class:"v-col-12 pb-0"},At={class:"v-col-12"},Ft={class:"v-col-12 pb-0 d-flex justify-space-between"},zt=t("div",{class:"text-grey text-caption"},"KPI",-1),Bt={class:"text-primary text-body-1"},Lt={class:"v-col-3"},Mt=t("div",{class:"text-grey text-caption"},"Industry",-1),Wt={class:"text-primary text-body-1"},Et={class:"v-col-3"},Nt={class:"text-grey text-caption"},Yt={class:"text-primary text-body-1"},Ht={class:"v-col-3"},qt=t("div",{class:"text-grey text-caption"},"Measure",-1),Gt={class:"text-primary text-body-1"},Jt={class:"v-col-3"},Xt={class:"text-grey text-caption"},Zt={class:"text-primary text-body-1"},Qt={key:1,class:"v-col-12 pb-0 text-center"},el={class:"v-col-6 pb-0"},tl={key:1},ll={class:"v-col-6 pb-0"},al={key:1},il={class:"v-col-6 pb-0"},sl={class:"v-col-12 pb-0 d-flex justify-space-between"},nl=t("div",{class:"text-grey text-caption"},"Training",-1),ol={class:"text-primary text-body-1"},ul={class:"v-col-3"},dl={class:"text-grey text-caption"},rl={class:"text-primary text-body-1"},vl={class:"v-col-3"},cl=t("div",{class:"text-grey text-caption"},"Type",-1),ml={class:"text-primary text-body-1"},pl={class:"v-col-6 pb-0"},gl={class:"v-col-12 pb-0 d-flex justify-space-between"},yl=t("div",{class:"text-grey text-caption"},"Training",-1),_l={class:"text-primary text-body-1"},fl={class:"v-col-3"},hl={class:"text-grey text-caption"},bl={class:"text-primary text-body-1"},xl={class:"v-col-3"},wl=t("div",{class:"text-grey text-caption"},"Type",-1),kl={class:"text-primary text-body-1"},Vl={class:"pb-3 text-grey"},Cl={class:"text-primary"},$l={class:"d-flex justify-end mt-5"},Ol={__name:"KpiContent",props:{selectedEmployee:{type:Object,default:null},industryList:{type:Object,default:null},ecdList:{type:Object,default:null},submitButton:{type:Boolean,default:!0},measuresList:{type:Object,default:null}},emits:["yearchange","savedResponse","errorcheck"],setup(D,{emit:A}){const x=D,F=Ie(),g=Te(),E=Re(),k=p({}),P=De(),e=p(x.selectedEmployee),u=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(i=>i.type=="kpi")),I=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(i=>i.type=="ecd")),B=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(i=>i.type=="ecd"&&i.ecd_type=="tech")),T=q(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(i=>i.type=="ecd"&&i.ecd_type=="soft"));K(()=>x.selectedEmployee,i=>{i.length>0?e.value=Object.assign({},i[0]):e.value=Object.assign({},i),g.name=="SingleTeamMember"&&S()});const r=q(()=>P.filteredSetting(e.value.company_id)),m=p(!1),_=p(!1),S=()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="first_review")){let i=e.value.reviews[0].key_review.filter(d=>d.achievement_midyear==null),s=!1;i&&i.length>0&&(s=!0),A("errorcheck",{hasError:s})}else if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="yearend"||e.value.reviews[0].state=="final_review")){let i=e.value.reviews[0].key_review.filter(d=>d.achievement_yearend==null),s=!1;i&&i.length>0&&(s=!0),A("errorcheck",{hasError:s})}else X().then(()=>{A("errorcheck",{hasError:_.value})})},R=p(""),X=async()=>{let i="",s=!1;f.value=="kpi"&&u.value.length<4&&W("kpi")==0?(i="Invalid: Minimum 4 KPI's needed, kindly update the weightage.",s=!0):(i="Invalid: Should have 1 each, technical and soft skill, kindly update the weightage.",s=ee(s)),m.value=s,s&&(R.value=i),ie()},ee=i=>{if(W("ecd")==0&&I.value&&I.value.length>0&&I.value.length<2)i=!0;else if(I.value.length>1){let s=[];I.value.map((d,G)=>{s.push(d.ecd_type)}),s=[...new Set(s)],W("ecd")==0&&s.length<2&&(i=!0)}return i},ie=async()=>{let i=!1;u.value.length<4&&W("kpi")==0&&(i=!0),i=ee(i),_.value=i},f=p("kpi"),Y=i=>{f.value=i,g.name=="SingleTeamMember"&&X()},c=p(new Date),a=q(()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0)return!!(E.authRole.includes("manager")&&g.name=="SingleTeamMember"&&e.value.reviews[0].state=="setting"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"||e.value.reviews[0].status=="inreview"));if(g.name=="SingleTeamMember"&&r&&r.state=="setting"&&(r.status=="open"||r.status=="inprogress"))return!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){let i=new Date(e.value.doj);if(i.setDate(i.getDate()+parseInt(r.probation_kpi_setting)),i>=c.value)return!0}return!1}),o=p({saveBtn:!1,isFinal:!1}),H=q(()=>{if(o.value={saveBtn:!1,isFinal:!1},g.name=="SingleTeamMember"&&r&&r.state=="yearend"&&(o.value={saveBtn:!1,isFinal:!0}),g.name=="SingleTeamMember"&&r&&(r.state=="midyear"||r.state=="yearend")&&(r.status=="open"||r.status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){if(o.value={saveBtn:!1,isFinal:!1},r){let i=new Date(e.value.doj),s=new Date(e.value.doj);if(i.setDate(i.getDate()+parseInt(r.probation_first_review_start)),s.setDate(s.getDate()+parseInt(r.probation_first_review_end)),e.value.reviews[0].state=="first_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!1},!0;if(i<=c.value&&s>=c.value)return o.value={saveBtn:!0,isFinal:!1},!0;let d=new Date(e.value.doj),G=new Date(e.value.doj);if(d.setDate(d.getDate()+parseInt(r.probation_final_review_start)),G.setDate(G.getDate()+parseInt(r.probation_final_review_end)),e.value.reviews[0].state=="final_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return o.value={saveBtn:!0,isFinal:!0},!0;if(d<=c.value&&G>=c.value)return o.value={saveBtn:!0,isFinal:!0},!0}}else if(e.value&&e.value.reviews&&e.value.reviews.length>0)return e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"?o.value.saveBtn=!0:e.value.reviews[0].state=="yearend"&&(o.value.isFinal=!0),!!(E.authRole.includes("manager")&&g.name=="SingleTeamMember"&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="yearend"));return!1}),Z=p(new Date().getFullYear()),xe=()=>{const i=F.resolve({path:"/print/kpi/"+Z.value+"/"+e.value.username,params:{year:Z.value},query:{print:1}});window.open(i.href,"_blank")};K(Z,async(i,s)=>{A("yearchange",i)});const L=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),M=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),se=async(i,s)=>{if(W(f.value)<=0)k.value={status:!0,type:"error",text:"Denied: You've reached the weightage limit."};else if(i=="kpi")u.value.length>5?k.value={status:!0,type:"error",text:"Denied: Max of 6 KPI only. Minimum is 4 KPI"}:L.value={title:"Add KPI ",data:{},dialog:!0,type:i,action:"add",is_review:!1};else{let d="Identify Technical Skill Development";s=="soft"&&(d="Identify Behavioral Program"),M.value={...M.value,title:d,data:{},dialog:!0,type:i,ecdType:s,action:"add",is_review:!1}}},ne=async(i,s="kpi",d)=>{s=="kpi"?L.value={...L.value,title:"Edit KPI ",data:Object.assign({},i),dialog:!0,type:s,action:"edit",is_review:!1}:M.value={...M.value,title:"Edit ECD ",data:Object.assign({},i),dialog:!0,type:s,action:"edit",ecdType:d,is_review:!1}},we=async(i,s="kpi")=>{console.log("item",i),s=="kpi"&&(L.value={...L.value,title:s.toUpperCase(),data:Object.assign({},i),dialog:!0,type:s,action:"readonly",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular},console.log("kpiOptions",L.value)),s=="ecd"&&(M.value={...M.value,title:s.toUpperCase(),data:Object.assign({},i),dialog:!0,type:s,action:"readonly",is_review:!0})},oe=async(i,s="kpi")=>{s=="kpi"&&(L.value={...L.value,title:s.toUpperCase(),data:Object.assign({},i),dialog:!0,type:s,action:"review",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular}),s=="ecd"&&(M.value={...M.value,title:s.toUpperCase(),data:Object.assign({},i),dialog:!0,type:s,action:"review",is_review:!0})},_e=i=>{let s={reviewID:e.value.reviews[0].id,data:i,industryTitle:i.industryTitle,state:i.state};S(),A("savedResponse",s)},N=p({data:{},dialog:!1,loading:!1}),ue=async i=>{N.value={...N.value,data:Object.assign({},i),dialog:!0}},ke=async()=>{let i=N.value.data;N.value.dialog=!1,A("removeKPI",i)},W=i=>{let s=70;return e.value&&e.value.is_regular==0&&(s=100),i=="ecd"?(s=30,I.value&&I.value.length>0&&I.value.map((d,G)=>{s-=d.weightage})):u.value&&u.value.length>0&&u.value.map((d,G)=>{s-=d.weightage}),s};return(i,s)=>(v(),w($,null,{default:n(()=>[t("div",It,[l(j(Pe),{modelValue:Z.value,"onUpdate:modelValue":s[0]||(s[0]=d=>Z.value=d),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),t("div",Tt,[e.value&&e.value.reviews&&e.value.reviews.length>0?(v(),w(b,{key:0,onClick:xe,color:"white",class:"text-capitalize text-md-caption text-lg-body-2"},{default:n(()=>[C("View/Print"),l(U,{icon:j(Oe),class:"ml-1"},null,8,["icon"])]),_:1})):h("",!0)]),t("div",Rt,[t("div",Dt,[l(z,{onClick:s[1]||(s[1]=()=>Y("kpi")),flat:"",class:ae(`
          ${f.value=="kpi"?"":"bg-grey-darken-3 text-white"}
          d-flex align-center justify-center px-3 text-center pms-tab`)},{default:n(()=>[C(" KPI "+y(u.value?"("+u.value.length+")":"(0)"),1)]),_:1},8,["class"]),e.value&&e.value.is_regular?(v(),w(z,{key:0,onClick:s[2]||(s[2]=()=>Y("ecd")),flat:"",class:ae(`${f.value=="ecd"?"":"bg-grey-darken-3 text-white"} d-flex align-center justify-center px-3 text-caption text-center pms-tab`)},{default:n(()=>[C(" Employee Capability Development "+y("("+I.value.length+")"),1)]),_:1},8,["class"])):h("",!0),e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="yearend"&&e.value.reviews[0].status=="submitted"?(v(),V("div",Ot,"Rate: Coming Soon")):h("",!0)]),l(z,{flat:""},{default:n(()=>[l(fe,{class:"px-5 py-5 d-flex align-center"},{default:n(()=>[a.value&&f.value=="kpi"?(v(),w(b,{key:0,onClick:s[3]||(s[3]=()=>se(f.value)),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),f.value=="kpi"&&u.value&&u.value.length>0||f.value=="ecd"&&I.value&&I.value.length>0?(v(),V("div",St,y(f.value=="ecd"?"Employee Capability Development":f.value)+" List ",1)):a.value?(v(),V("div",Pt,y(f.value=="ecd"?"Employee Capability Development":e.value.is_regular?f.value:"Probation KPI")+" List ",1)):(v(),V("div",jt,y(f.value)+" not set ",1)),a.value&&W(f.value)>0?(v(),V("div",Ut,"Remaining "+y(f.value.toUpperCase())+" weightage: "+y(W(f.value))+"%",1)):h("",!0)]),_:1}),l(J,{class:"px-5 pb-10"},{default:n(()=>[m.value?(v(),w($,{key:0,class:"mb-2"},{default:n(()=>[t("div",Kt,[l(z,{class:"rounded-lg",style:{border:"2px solid red"}},{default:n(()=>[l(J,null,{default:n(()=>[l($,null,{default:n(()=>[t("div",At,[l(U,{size:"large",color:"red",class:"mr-1",icon:j(Se)},null,8,["icon"]),C(" "+y(R.value),1)])]),_:1})]),_:1})]),_:1})])]),_:1})):h("",!0),he(l($,{class:"mt-3"},{default:n(()=>[u.value&&u.value.length>0?(v(!0),V(Q,{key:0},de(u.value,d=>(v(),V("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:n(()=>[l(J,null,{default:n(()=>[l($,null,{default:n(()=>[t("div",Ft,[t("div",null,[zt,t("div",Bt,y(d.title),1)]),t("div",null,[a.value?(v(),w(b,{key:0,onClick:()=>we(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(je)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),H.value?(v(),w(b,{key:1,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"kpi")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:2,onClick:()=>ne(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:3,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",Lt,[Mt,t("div",Wt,y(d.industry),1)]),t("div",Et,[t("div",Nt,"Target ("+y(d.target_type)+")",1),t("div",Yt,y(d.target),1)]),t("div",Ht,[qt,t("div",Gt,y(d.measures),1)]),t("div",Jt,[t("div",Xt,y("KPI's Weightage(%)"),1),t("div",Zt,y(d.weightage)+"%",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)):(v(),V("div",Qt," No records yet. "))]),_:1},512),[[be,f.value=="kpi"]]),he(l($,{class:"mt-n3"},{default:n(()=>[t("div",el,[a.value?(v(),w(b,{key:0,onClick:s[4]||(s[4]=()=>se(f.value,"tech")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),a.value?(v(),V("span",tl,"Technical Skill")):h("",!0)]),t("div",ll,[a.value?(v(),w(b,{key:0,onClick:s[5]||(s[5]=()=>se(f.value,"soft")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[l(U,{size:"small",icon:j(re)},null,8,["icon"])]),_:1})):h("",!0),C(),a.value?(v(),V("span",al,"Soft Skill")):h("",!0)]),t("div",il,[l($,null,{default:n(()=>[(v(!0),V(Q,null,de(B.value,d=>(v(),V("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:n(()=>[l(J,null,{default:n(()=>[l($,null,{default:n(()=>[t("div",sl,[t("div",null,[nl,t("div",ol,y(d.title),1)]),t("div",null,[H.value?(v(),w(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:1,onClick:()=>ne(d,"ecd","tech"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",ul,[t("div",dl,y("KPI's Weightage(%)"),1),t("div",rl,y(d.weightage),1)]),t("div",vl,[cl,t("div",ml,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),t("div",pl,[l($,null,{default:n(()=>[(v(!0),V(Q,null,de(T.value,d=>(v(),V("div",{class:"v-col-12 pb-0",key:d.id},[l(z,{class:"rounded-lg"},{default:n(()=>[l(J,null,{default:n(()=>[l($,null,{default:n(()=>[t("div",gl,[t("div",null,[yl,t("div",_l,y(d.title),1)]),t("div",null,[H.value?(v(),w(b,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[C("review")]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:1,onClick:()=>ne(d,"ecd","soft"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),a.value?(v(),w(b,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[l(U,{size:"small",icon:j(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),t("div",fl,[t("div",hl,y("KPI's Weightage(%)"),1),t("div",bl,y(d.weightage),1)]),t("div",xl,[wl,t("div",kl,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})])]),_:1},512),[[be,f.value=="ecd"]])]),_:1})]),_:1})]),l(ge,{modelValue:N.value.dialog,"onUpdate:modelValue":s[7]||(s[7]=d=>N.value.dialog=d),width:"100%","max-width":"480",persistent:""},{default:n(()=>[l(z,{class:"rounded-lg"},{default:n(()=>[l(fe,{class:"pa-3"},{default:n(()=>[C("Confirm Remove")]),_:1}),l(J,{class:"px-3"},{default:n(()=>[t("div",Vl,[C(" Please confirm that you want to remove "),t("span",Cl,y("'"+N.value.data.title.substring(0,35)+"...'"),1)]),t("div",$l,[l(b,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:s[6]||(s[6]=d=>N.value.dialog=!1)},{default:n(()=>[C("Cancel")]),_:1}),l(b,{color:"primary",class:"ml-2",onClick:ke},{default:n(()=>[C("Remove")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ut,{"final-review":o.value,"measures-list":D.measuresList,"kpi-options":L.value,"remain-weightage":W(f.value),"industry-list":D.industryList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","measures-list","kpi-options","remain-weightage","industry-list","submit-button"]),l($t,{"final-review":o.value,"ecd-options":M.value,"remain-weightage":W(f.value),"ecd-list":D.ecdList,"submit-button":x.submitButton,onSavedResponse:_e},null,8,["final-review","ecd-options","remain-weightage","ecd-list","submit-button"]),l(ye,{options:k.value},null,8,["options"])]),_:1}))}};export{Ol as _};
