import{u as A,z as L,L as U,r as c,O as Y,c as V,w as o,V as D,o as u,a as l,f as a,N as E,d as v,P as M,Q as j,A as x,H as b,C as S,g as w,B as H,Y as z,a2 as I,b as C,F as O,n as Q,e as P,h as $,R as q,i as G}from"./app-525191c0.js";import{c as J,f as K}from"./mdi-5e26928d.js";import{c as W}from"./clientApi-64dd0185.js";import{u as X}from"./company-28c31e59.js";import{e as Z}from"./vue-datepicker-8d0714d3.js";import{_ as ee}from"./PageHeader-fd922cb3.js";import"./typeof-7fd5df1e.js";import"./defineProperty-fcf2a4a8.js";const ae={class:"v-col-12 v-col-md-4"},te={class:"v-col-12 v-col-md-3"},le={class:"v-col-12 v-col-md-2"},se={class:"v-col-12"},oe=a("div",{class:"text-primary text-capitalize"},"PMS Settings",-1),ne=a("thead",null,[a("tr",null,[a("th",{class:"text-left text-capitalize"},"Company"),a("th",{class:"text-left text-capitalize"},"Year"),a("th",{class:"text-right text-capitalize"},"Actions")])],-1),ie={key:0},ce={class:"d-flex align-center justify-end"},he={__name:"Pms",setup(re){const k=A(),g=L(),f=U(),s=c({loading:!1,company_id:null,year:new Date().getFullYear()}),d=c(!1),r=c([]),_=c(0),N=c(0),i=c(f.params&&f.params.page?f.params.page:1),h=async n=>{d.value=!0;let t="/api/hr/pms-settings/pms?filter[company]="+s.value.company_id+"&filter[year]="+s.value.year;t+="&page="+n,await W(k.authToken).get(t).then(e=>{_.value=e.data.last_page,i.value=e.data.current_page,N.value=e.data.total,r.value=e.data.data,d.value=!1}).catch(e=>{d.value=!1,console.log("getEmployees",e)})};Y(i,(n,t)=>{n!=t&&(g.push({name:"PaginatedPms",params:{page:i.value}}).catch(e=>{}),h(i.value))}),h(i.value);const B=()=>{g.push({name:"NewPms"}).catch(n=>{})},F=n=>{g.push({name:"SinglePms",params:{id:n}}).catch(t=>{})},R=()=>{s.value.loading=!0,h(1).then(()=>{s.value.loading=!1}).catch(n=>{s.value.loading=!1})},y=X(),m=c(!1),T=()=>{y.companies.length==0&&(m.value=!0,y.getCompanies(k.authToken).then(()=>{m.value=!1}))};return(n,t)=>(u(),V(D,{class:"pb-16"},{default:o(()=>[l(ee,{title:"PMS Settings"}),l(G,{class:"my-5"},{default:o(()=>[a("div",ae,[l(E,{modelValue:s.value.company_id,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value.company_id=e),items:v(y).active_companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white",clearable:"","hide-details":"",label:m.value?"Loading...":"Select Company",loading:m.value,onFocus:T},{selection:o(({props:e,item:p})=>[a("span",M(j(e)),x(p.raw.title&&p.raw.title.length>30?p.raw.title.substring(0,30)+"...":p.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),a("div",te,[l(v(Z),{modelValue:s.value.year,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value.year=e),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),a("div",le,[l(b,{block:"",loading:s.value.loading,onClick:R,height:"40px",color:"secondary",class:"text-capitalize"},{default:o(()=>[S("Filter")]),_:1},8,["loading"])]),a("div",se,[l(w,{class:"mb-3 rounded-lg",loading:d.value},{default:o(()=>[l(H,{class:"d-flex align-center py-3"},{default:o(()=>[l(b,{onClick:B,size:"35",class:"rounded-xl elevation-2 mr-2"},{default:o(()=>[l(z,{size:"small",icon:v(J)},null,8,["icon"])]),_:1}),oe]),_:1}),l(I,null,{default:o(()=>[ne,r.value&&r.value.length>0?(u(),C("tbody",ie,[(u(!0),C(O,null,Q(r.value,e=>(u(),C("tr",{key:e.id},[a("td",null,x(e.company.title),1),a("td",null,x(e.year),1),a("td",null,[a("div",ce,[l(z,{size:"small",onClick:()=>F(e.id),icon:v(K),class:"mx-1"},null,8,["onClick","icon"])])])]))),128))])):P("",!0)]),_:1}),r.value&&r.value.length==0?(u(),V(w,{key:0,class:"elevation-0"},{default:o(()=>[l($,{class:"text-center"},{default:o(()=>[S(" No records found ")]),_:1})]),_:1})):P("",!0)]),_:1},8,["loading"]),_.value>1?(u(),V(q,{key:0,modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),class:"my-4",length:_.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):P("",!0)])]),_:1})]),_:1}))}};export{he as default};
