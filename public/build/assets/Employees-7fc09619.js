import{u as A,z as L,K as U,r as d,N as j,c as h,w as i,V as I,o as u,a as s,f as o,A as f,G as O,M as K,d as $,O as D,P as G,I as H,H as k,C as V,i as w,b,F as M,n as Q,Q as W,e as q,g as R,h as F}from"./app-b1ca44b3.js";import{c as J}from"./clientApi-d5d9c19b.js";import{u as X}from"./company-0fa48444.js";import Y from"./KpiProgress-3ab976b0.js";import{_ as Z}from"./EmployeeCard-896593dd.js";import"./printInitials-a54a9c4a.js";import"./mdi-a0a77bee.js";const ee={class:"v-col-12"},ae={class:"text-h6"},le={class:"v-col-12 v-col-md-3"},te={class:"v-col-12 v-col-md-4"},oe={class:"v-col-12 v-col-md-2"},se={class:"v-col-12 v-col-md-3"},ie={class:"d-flex justify-space-between"},ne={key:0,class:"v-col-12"},de={class:"v-col-12 v-col-md-3"},ce={class:"v-col-12 v-col-md-8"},ue={class:"v-col-12 v-col-md-1 d-flex justify-end align-center"},re=o("div",{class:"text-caption text-grey"},"Total KPI",-1),me={key:1,class:"v-col-12"},we={__name:"Employees",setup(pe){const p=A(),x=L(),v=U(),E=(t,a=null)=>{let e=a?Object.assign({},a):!1;x.push({name:t,params:e}).catch(c=>{})},P=t=>{let a=0;return t.reviews&&t.reviews.length>0&&t.reviews[0].key_review&&t.reviews[0].key_review.map((e,c)=>{a+=e.weightage}),a},g=X(),r=d(!1),S=()=>{g.companies.length==0&&(r.value=!0,g.getCompanies(p.authToken).then(()=>{r.value=!1}))},T=d([{value:1,title:"Regular"},{value:0,title:"Probation"}]),l=d({loadingReset:!1,loadingFilter:!1,data:{employee:null,company_id:null,is_regular:1}}),N=async()=>{l.value.loadingFilter=!0,m(1).then(()=>{l.value.loadingFilter=!1}).catch(t=>{l.value.loadingFilter=!1})},B=async()=>{l.value.data={employee:null,company_id:null,is_regular:1},l.value.loadingReset=!0,m(1).then(()=>{l.value.loadingReset=!1}).catch(t=>{l.value.loadingReset=!1})},_=d([]),y=d(0),C=d(0),n=d(v.params&&v.params.page?v.params.page:1),m=async t=>{let a="/api/hr/employees?&filter[is_regular]="+l.value.data.is_regular+"&filter[hrbp_email]="+p.authProfile.email;l.value.data.company_id!==null&&(a+="&filter[company_id]="+l.value.data.company_id),l.value.data.employee!==null&&(a+="&filter[employee]="+l.value.data.employee),a+="&page="+t,await J(p.authToken).get(a).then(e=>{y.value=e.data.last_page,n.value=e.data.current_page,C.value=e.data.total,_.value=e.data.data}).catch(e=>{console.log("getEmployees",e)})};j(n,(t,a)=>{t!=a&&(x.push({name:"PaginatedEmployees",params:{page:n.value}}).catch(e=>{}),m(n.value))}),m(n.value);const z=t=>{console.log("profile",t),E("SingleEmployee",{ecode:t.ecode})};return(t,a)=>(u(),h(I,{class:"pb-16"},{default:i(()=>[s(w,{class:"mt-5"},{default:i(()=>[o("div",ee,[o("div",ae,"Employee List "+f("("+C.value+")"),1)]),o("div",le,[s(O,{modelValue:l.value.data.employee,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value.data.employee=e),variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Input Employee"},null,8,["modelValue"])]),o("div",te,[s(K,{modelValue:l.value.data.company_id,"onUpdate:modelValue":a[1]||(a[1]=e=>l.value.data.company_id=e),items:$(g).companies,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:r.value?"Loading...":"Select Company",loading:r.value,clearable:"",onFocus:S},{selection:i(({props:e,item:c})=>[o("span",D(G(e)),f(c.raw.title&&c.raw.title.length>20?c.raw.title.substring(0,20)+"...":c.raw.title),17)]),_:1},8,["modelValue","items","label","loading"])]),o("div",oe,[s(H,{modelValue:l.value.data.is_regular,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value.data.is_regular=e),items:T.value,"item-title":"title","item-value":"value",variant:"outlined",density:"compact",class:"bg-white","hide-details":"",label:"Select Employee Type"},null,8,["modelValue","items"])]),o("div",se,[o("div",ie,[s(k,{onClick:B,height:"40px",variant:"text",color:"primary",class:"bg-grey-lighten-2 text-capitalize",loading:l.value.loadingReset,style:{width:"48%"}},{default:i(()=>[V("Reset")]),_:1},8,["loading"]),s(k,{onClick:N,height:"40px",color:"primary",class:"text-capitalize",loading:l.value.loadingFilter,style:{width:"48%"}},{default:i(()=>[V("Search")]),_:1},8,["loading"])])])]),_:1}),s(w,null,{default:i(()=>[_.value.length>0?(u(),b("div",ne,[(u(!0),b(M,null,Q(_.value,e=>(u(),h(R,{key:e.id,class:"mb-3 elevation-0",onClick:()=>z(e)},{default:i(()=>[s(F,null,{default:i(()=>[s(w,null,{default:i(()=>[o("div",de,[s(Z,{profile:e},null,8,["profile"])]),o("div",ce,[s(Y,{density:"compact","selected-employee":e},null,8,["selected-employee"])]),o("div",ue,[o("div",null,[o("div",null,f(P(e))+" /100",1),re])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),y.value>1?(u(),h(W,{key:0,modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value=e),class:"my-4",length:y.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable"},null,8,["modelValue","length"])):q("",!0)])):(u(),b("div",me,[s(R,null,{default:i(()=>[s(F,{class:"text-center"},{default:i(()=>[V(" No records found ")]),_:1})]),_:1})]))]),_:1})]),_:1}))}};export{we as default};
