import{r as p,N as F,o as r,b as C,a as t,w as n,g as B,i as T,f as l,Y as J,A as y,c as _,M as me,G as I,O as Ve,P as Ce,I as ae,Z as $e,$ as pe,a0 as te,H as x,C as $,e as h,J as ge,F as le,U as Ie,S as Te,z as Re,K as Se,u as De,k as Oe,L as X,d as U,X as K,B as fe,h as Q,q as he,n as de,v as be}from"./app-839ab5dd.js";import{b as Pe,c as re,d as Ue,e as je,f as ve,g as ce}from"./mdi-1daeeafa.js";import{e as Ke}from"./vue-datepicker-a389471d.js";import{_ as ye}from"./SnackBar-2240eafd.js";const Fe={class:"v-col-12"},Ae={class:"v-col-12 v-col-md-6 py-0"},ze={class:"v-col-12 v-col-md-6 py-0"},Le={class:"v-col-12 v-col-md-3 py-0 mb-2"},Be={class:"v-col-12 v-col-md-3 py-0 mb-2"},Me={class:"v-col-12 v-col-md-3 py-0 mb-2"},We={class:"v-col-12 v-col-md-3 py-0 mb-2"},Ee={class:"v-col-12 py-0"},Ne={class:"v-col-12 pt-0"},Ye={class:"v-col-12 py-0"},He={class:"v-col-12 py-0"},qe={class:"v-col-12 py-0"},Ge={class:"v-col-12 py-0 hidden hide",hidden:""},Je={class:"v-col-12 py-0"},Xe={key:0,class:"v-col-12 d-flex justify-end"},Ze={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},Qe=l("div",{class:"v-col-12 px-1"},y("Review"),-1),el={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},ll={class:"v-col-12 v-col-md-6 py-0 px-1"},tl={class:"v-col-12 v-col-md-6 py-0 px-1"},al={class:"v-col-12 v-col-md-12 py-0 px-1"},sl={class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"},il={class:"v-col-12 py-0 px-1"},nl={class:"v-col-12 v-col-md-6 py-0 px-1"},ol={class:"v-col-12 v-col-md-6 py-0 px-1"},ul={class:"v-col-12 d-flex justify-end"},dl={__name:"KpiDialog",props:{kpiOptions:{type:Object,default:null},submitButton:{type:Boolean,default:!0},industryList:{type:Object,default:null},remainWeightage:{type:Number,default:70},measuresList:{type:Object,default:null},finalReview:{type:Boolean,default:!1}},emits:["savedResponse"],setup(S,{emit:A}){const w=S,z=p({}),g=p(["min","max"]),H=p([]),k=p(["5%","10%","15%","20%","25%","30%"]),j=p(null),e=p({}),o=p({measures:null}),R=p([]),q=p([]),V=p(""),c=p(""),m=p(""),f=p(""),P=p(!1),D=p(!0),O=p([]),ee=()=>{P.value=!0,e.value.data=o.value,e.value.industryTitle=f.value,setTimeout(()=>{P.value=!1,e.value.dialog=!1,A("savedResponse",e.value)},1200),V.value=w.kpiOptions.data.industry},se=()=>{e.value.dialog=!1,(e.value.action=="edit"||e.value.action=="review")&&(V.value=w.kpiOptions.data.industry,c.value=w.kpiOptions.data.title)},b=()=>{w.finalReview.isFinal?e.value.state="final":e.value.state="mid",ee()};F(()=>w.kpiOptions,v=>{m.value="",P.value=!1,q.value=w.industryList,o.value=Object.assign({},v.data),o.value.measures=="%"&&(m.value=o.value.target),o.value.achievement_midyear&&o.value.measures!="%"&&(m.value=o.value.target-o.value.achievement_midyear),e.value=Object.assign({},v),e.value.action=="edit"||e.value.action=="review"||e.value.action=="readonly"?(V.value=v.data.industry,c.value=v.data.title,j.value=v.data.weightage,D.value=!1):(V.value=null,c.value=null,j.value=null,D.value=!0)}),F(()=>V.value,v=>{R.value=[],H.value=w.measuresList,e.value.action=="add"?(D.value=!0,o.value={},c.value=null,v&&(O.value.push("industry"),M(),f.value=v.title,q.value.map(a=>{a.id==v.id&&(R.value=a.kpis)}))):(O.value.push("industry"),D.value=!1)}),F(()=>c.value,v=>{if(e.value.action=="add"){o.value={};let a=R.value.filter(u=>u.id==v);a&&a.length>0&&(o.value=a[0],D.value=!1,O.value.push("kpi"),M())}else O.value.push("kpi")}),F(()=>o.value.weightage,v=>{let a=!1;if(!isNaN(v)||v==null||v==null)a=!1;else if(e.value.action=="add")parseInt(v)>w.remainWeightage?(a=!1,z.value={status:!0,type:"error",text:"Weightage is over the limit!"}):a=!0;else{let u=parseInt(w.remainWeightage)+parseInt(j.value)-parseInt(v);parseInt(u)<0?(a=!1,z.value={status:!0,type:"error",text:"Weightage is over the limit!"}):j.value>parseInt(v)||parseInt(u)>=0?a=!0:a=!1}a?(O.value.push("weightage"),M()):L("weightage")});const M=()=>{O.value=O.value.filter((v,a)=>O.value.indexOf(v)===a)},L=v=>{const a=O.value.indexOf(v);a>-1&&O.value.splice(a,1)};return F(()=>o.value.target,v=>{v?(O.value.push("target"),M()):L("target")}),F(()=>o.value.measures,v=>{v?(O.value.push("measures"),M()):L("measures")}),F(()=>o.value.target_type,v=>{O.value.push("target_type"),M(),v=="min"?o.value.evaluation_pattern='<span style="color:green">Positive Ranking = Exceeding the Target</span> <br/><span style="color:red">Negative Ranking = Falling short of the Target</span>':v=="max"?o.value.evaluation_pattern='<span style="color:green">Positive Ranking = Falling short of the Target</span> <br/><span style="color:red">Negative Ranking = Exceeding the Target</span>':(L("target_type"),o.value.evaluation_pattern="")}),(v,a)=>(r(),C(le,null,[t(ge,{modelValue:e.value.dialog,"onUpdate:modelValue":a[22]||(a[22]=u=>e.value.dialog=u),width:"100%","max-width":`${e.value.is_review==!0?"1240":"900"} `,persistent:""},{default:n(()=>[t(B,{class:"rounded-lg"},{default:n(()=>[t(T,{class:"ma-0 pa-0"},{default:n(()=>[l("div",{class:J(`v-col-12 ${e.value.is_review==!0?"v-col-md-8":""} px-4`)},[t(T,null,{default:n(()=>[l("div",Fe,y(e.value.title),1),l("div",Ae,[e.value.action=="add"?(r(),_(me,{key:0,modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=u=>V.value=u),items:S.industryList,"item-title":"title","item-value":"title","hide-details":"","return-object":"",variant:"outlined",density:"compact",label:"Select Industry*"},null,8,["modelValue","items"])):(r(),_(I,{key:1,modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=u=>V.value=u),"hide-details":"",variant:"outlined",density:"compact",label:"Select Industry*",class:"bg-grey-lighten-4 mb-3"},null,8,["modelValue"]))]),l("div",ze,[e.value.action=="add"?(r(),_(me,{key:0,modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=u=>c.value=u),items:R.value,"item-title":"title","item-value":"id",variant:"outlined",density:"compact",label:"Select KPI*"},{selection:n(({props:u,item:W})=>[l("span",Ve(Ce(u)),y((W==null?void 0:W.title.substring(0,35))+"..."),17)]),_:1},8,["modelValue","items"])):(r(),_(I,{key:1,modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=u=>c.value=u),"hide-details":"",variant:"outlined",density:"compact",label:"Select KPI*",class:"bg-grey-lighten-4 mb-3"},null,8,["modelValue"]))]),l("div",Le,[!D.value&&!e.value.is_review?(r(),_(ae,{key:0,modelValue:o.value.target_type,"onUpdate:modelValue":a[4]||(a[4]=u=>o.value.target_type=u),items:g.value,label:"Target Type*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])):(r(),_(I,{key:1,modelValue:o.value.target_type,"onUpdate:modelValue":a[5]||(a[5]=u=>o.value.target_type=u),"hide-details":"",variant:"outlined",density:"compact",label:"Target Type*",class:"bg-grey-lighten-4 mb-3"},null,8,["modelValue"]))]),l("div",Be,[t(I,{readonly:D.value||e.value.is_review,class:J(`${D.value||e.value.is_review?"bg-grey-lighten-4 mb-3":""}`),"hide-details":"",type:"number",modelValue:o.value.target,"onUpdate:modelValue":a[6]||(a[6]=u=>o.value.target=u),label:"Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["readonly","class","modelValue"])]),l("div",Me,[!D.value&&!e.value.is_review?(r(),_(ae,{key:0,modelValue:o.value.measures,"onUpdate:modelValue":a[7]||(a[7]=u=>o.value.measures=u),items:H.value,label:"Measures*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])):(r(),_(I,{key:1,modelValue:o.value.measures,"onUpdate:modelValue":a[8]||(a[8]=u=>o.value.measures=u),"hide-details":"",variant:"outlined",density:"compact",label:"Measures*",class:"bg-grey-lighten-4 mb-3"},null,8,["modelValue"]))]),l("div",We,[!D.value&&!e.value.is_review?(r(),_(ae,{key:0,modelValue:o.value.weightage,"onUpdate:modelValue":a[9]||(a[9]=u=>o.value.weightage=u),items:k.value,label:"KPI's Weightage (%)*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])):(r(),_(I,{key:1,modelValue:o.value.weightage,"onUpdate:modelValue":a[10]||(a[10]=u=>o.value.weightage=u),"hide-details":"",variant:"outlined",density:"compact",label:"KPI's Weightage (%)*",class:"bg-grey-lighten-4 mb-3"},null,8,["modelValue"]))]),l("div",Ee,[t(T,{class:"mx-0 mb-3"},{default:n(()=>[t($e,{class:"pa-3 bg-grey-lighten-4",style:{border:"1px solid #b1b1b1","border-radius":"5px","min-height":"70px"},innerHTML:o.value.evaluation_pattern},null,8,["innerHTML"])]),_:1})]),l("div",Ne,[t(pe,{class:"mx-auto"})]),l("div",Ye,[t(te,{"auto-grow":"",modelValue:o.value.definition,"onUpdate:modelValue":a[11]||(a[11]=u=>o.value.definition=u),readonly:D.value||e.value.action=="edit"||e.value.is_review,label:"KPI Definition*",variant:"outlined",rows:"2"},null,8,["modelValue","readonly"])]),l("div",He,[t(te,{"auto-grow":"",modelValue:o.value.formula,"onUpdate:modelValue":a[12]||(a[12]=u=>o.value.formula=u),class:"bg-grey-lighten-4 mb-4","hide-details":"",readonly:"",label:"Calculation Formula*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),l("div",qe,[t(te,{"auto-grow":"",modelValue:o.value.subordinate_measures,"onUpdate:modelValue":a[13]||(a[13]=u=>o.value.subordinate_measures=u),class:"bg-grey-lighten-4 mb-4","hide-details":"",readonly:"",label:"Subordinate Measures*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),l("div",Ge,[t(te,{"auto-grow":"",modelValue:o.value.calculation_example,"onUpdate:modelValue":a[14]||(a[14]=u=>o.value.calculation_example=u),class:"bg-grey-lighten-4 mb-4","hide-details":"",readonly:"",label:"KPI Calculation Example*",variant:"outlined",rows:"2"},null,8,["modelValue"])]),l("div",Je,[t(pe,{class:"mx-auto"})]),e.value.is_review?h("",!0):(r(),C("div",Xe,[t(x,{color:"primary",variant:"text",onClick:se},{default:n(()=>[$("Cancel")]),_:1}),t(x,{loading:P.value,disabled:O.value.length<6,color:"secondary",class:"ml-2 px-8",onClick:ee},{default:n(()=>[$("save")]),_:1},8,["loading","disabled"])]))]),_:1})],2),e.value.is_review?(r(),C("div",Ze,[t(T,{class:"px-3"},{default:n(()=>[Qe,l("div",el,y(e.value.is_regular?"Mid-year Achievement":"First Review Achievement"),1),l("div",ll,[t(I,{type:"number",readonly:S.finalReview.isFinal||e.value.action=="readonly","hide-details":"",class:J(`${S.finalReview.isFinal||e.value.action=="readonly"?"bg-grey-lighten-2":""} mb-4`),modelValue:o.value.achievement_midyear,"onUpdate:modelValue":a[15]||(a[15]=u=>o.value.achievement_midyear=u),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["readonly","class","modelValue"])]),l("div",tl,[t(I,{readonly:"",modelValue:m.value,"onUpdate:modelValue":a[16]||(a[16]=u=>m.value=u),label:"Remainder Annual Target",class:"bg-grey-lighten-2","hide-details":"",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",al,[e.value.is_regular?(r(),_(I,{key:0,type:"number",readonly:S.finalReview.isFinal||e.value.action=="readonly","hide-details":"",class:J(`${S.finalReview.isFinal||e.value.action=="readonly"?"bg-grey-lighten-2":""} mb-4`),modelValue:o.value.revised_annual_target,"onUpdate:modelValue":a[17]||(a[17]=u=>o.value.revised_annual_target=u),label:"Revised Annual Target",variant:"outlined",density:"compact","persistent-hint":""},null,8,["readonly","class","modelValue"])):h("",!0)])]),_:1}),S.finalReview.isFinal?(r(),_(T,{key:0,class:"px-3"},{default:n(()=>[l("div",sl,y(e.value.is_regular?"Year-end Achievement":"Final Review Achievement"),1),l("div",il,[t(I,{modelValue:o.value.achievement_yearend,"onUpdate:modelValue":a[18]||(a[18]=u=>o.value.achievement_yearend=u),readonly:e.value.action=="readonly","hide-details":"",class:J(`${e.value.action=="readonly"?"bg-grey-lighten-2":""} mb-4`),label:"Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue","readonly","class"])]),l("div",nl,[t(I,{modelValue:v.final_target_variation,"onUpdate:modelValue":a[19]||(a[19]=u=>v.final_target_variation=u),readonly:"","hide-details":"",class:"bg-grey-lighten-2 mb-3",label:"Target Variation",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",ol,[t(I,{modelValue:o.value.year_end_remainder_target,"onUpdate:modelValue":a[20]||(a[20]=u=>o.value.year_end_remainder_target=u),readonly:"","hide-details":"",class:"bg-grey-lighten-2 mb-3",label:"Remainer Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])])]),_:1})):h("",!0),t(T,null,{default:n(()=>[l("div",ul,[t(x,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:a[21]||(a[21]=u=>e.value.dialog=!1)},{default:n(()=>[$("Cancel")]),_:1}),e.value.action!="readonly"&&w.submitButton&&S.finalReview.saveBtn?(r(),_(x,{key:0,loading:P.value,color:"secondary",class:"ml-2",onClick:b},{default:n(()=>[$("Save")]),_:1},8,["loading"])):h("",!0)])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),t(ye,{options:z.value},null,8,["options"])],64))}},rl={class:"v-col-12"},vl={class:"v-col-12 py-0"},cl={class:"v-col-12 py-0"},ml={class:"v-col-12 py-0"},pl={key:0,class:"v-col-12 d-flex justify-end"},gl={key:0,class:"v-col-12 v-col-md-4 bg-grey-lighten-4"},yl=l("div",{class:"v-col-12 px-1"},y("Review"),-1),_l=l("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Mid-year Achievement ",-1),fl={class:"v-col-12 v-col-md-6 py-0 px-1"},hl={class:"v-col-12 v-col-md-6 py-0 px-1"},bl={class:"v-col-12 v-col-md-6 py-0 px-1"},xl={class:"v-col-12 v-col-md-6 py-0 px-1"},wl=l("div",{class:"v-col-12 py-0 px-1 mt-3 mb-3 text-body-2"}," Year-year Achievement ",-1),kl={class:"v-col-12 py-0 px-1"},Vl={class:"v-col-12 v-col-md-6 py-0 px-1"},Cl={class:"v-col-12 v-col-md-6 py-0 px-1"},$l={class:"v-col-12 d-flex justify-end"},Il={__name:"EcdDialog",props:{ecdOptions:{type:Object,default:null},ecdList:{type:Object,default:null},remainWeightage:{type:Number,default:30}},emits:["savedResponse"],setup(S,{emit:A}){const w=S,z=p(null),g=p({}),H=p([]),k=p({}),j=p(null),e=p(null),o=p(["5%","10%","15%","20%"]),R=()=>{g.value.weightage=e.value,g.value.ecd_type=w.ecdOptions.ecdType,k.value.data=g.value,k.value.dialog=!1,A("savedResponse",k.value)};F(()=>w.ecdOptions,c=>{g.value=Object.assign({},c.data),H.value=w.ecdList.filter(m=>m.ecd_type==c.ecdType||m.ecd_type=="both"),k.value=Object.assign({},c),k.value.action=="edit"?(z.value=c.data.weightage,j.value=c.data.title,e.value=c.data.weightage):(z.value=null,j.value=null,e.value=null)}),F(()=>j.value,c=>{k.value.action=="add"&&(g.value={},g.value=c)});const q=p({}),V=p(!1);return F(()=>e.value,c=>{if(!isNaN(c)||c==null||c==null)V.value=!1;else if(k.value.action=="add")parseInt(c)>w.remainWeightage?(V.value=!1,q.value={status:!0,type:"error",text:"Weightage is over the limit!"}):V.value=!0;else{let m=parseInt(w.remainWeightage)+parseInt(z.value)-parseInt(c);parseInt(m)<0?(V.value=!1,q.value={status:!0,type:"error",text:"Weightage is over the limit!"}):z.value>parseInt(c)||parseInt(m)>=0?V.value=!0:V.value=!1}}),(c,m)=>(r(),C(le,null,[t(ge,{modelValue:k.value.dialog,"onUpdate:modelValue":m[11]||(m[11]=f=>k.value.dialog=f),width:"100%","max-width":`${S.ecdOptions.is_review==!0?"1240":"700"} `,persistent:""},{default:n(()=>[t(B,{class:"rounded-lg"},{default:n(()=>[t(T,{class:"ma-0 pa-0"},{default:n(()=>[l("div",{class:J(`v-col-12 ${S.ecdOptions.is_review==!0?"v-col-md-8":""} px-4`)},[t(T,null,{default:n(()=>[l("div",rl,y(k.value.title),1),l("div",vl,[t(me,{modelValue:j.value,"onUpdate:modelValue":m[0]||(m[0]=f=>j.value=f),items:H.value,"item-title":"title","item-value":"id","return-object":"",variant:"outlined",density:"compact",label:"Select *"},{item:n(({props:f,item:P})=>{var D;return[t(Ie,Te({style:`${P.raw.profile_ecode?"background-color:#f1f1f1":""} `},f,{title:(D=P==null?void 0:P.raw)==null?void 0:D.title}),null,16,["style","title"])]}),_:1},8,["modelValue","items"])]),l("div",cl,[t(ae,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=f=>e.value=f),items:o.value,label:"Development Weightage (%)*",variant:"outlined",density:"compact"},null,8,["modelValue","items"])]),l("div",ml,[t(pe,{class:"mx-auto"})]),k.value.is_review?h("",!0):(r(),C("div",pl,[t(x,{color:"primary",variant:"text",onClick:m[2]||(m[2]=f=>k.value.dialog=!1)},{default:n(()=>[$("Cancel")]),_:1}),t(x,{disabled:!V.value,color:"secondary",class:"ml-2 px-8",onClick:R},{default:n(()=>[$("save")]),_:1},8,["disabled"])]))]),_:1})],2),k.value.is_review?(r(),C("div",gl,[t(T,{class:"px-3"},{default:n(()=>[yl,_l,l("div",fl,[t(I,{modelValue:g.value.revised_annual_target,"onUpdate:modelValue":m[3]||(m[3]=f=>g.value.revised_annual_target=f),label:"Revised Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",hl,[t(I,{modelValue:g.value.mid_year_remainder_target,"onUpdate:modelValue":m[4]||(m[4]=f=>g.value.mid_year_remainder_target=f),label:"Remainder Annual Target*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",bl,[t(I,{modelValue:g.value.mid_year_achievement,"onUpdate:modelValue":m[5]||(m[5]=f=>g.value.mid_year_achievement=f),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",xl,[t(I,{modelValue:g.value.mid_year_target_variation,"onUpdate:modelValue":m[6]||(m[6]=f=>g.value.mid_year_target_variation=f),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),wl,l("div",kl,[t(I,{modelValue:g.value.year_end_achievement,"onUpdate:modelValue":m[7]||(m[7]=f=>g.value.year_end_achievement=f),label:"Year-end Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",Vl,[t(I,{modelValue:g.value.year_end_target_variation,"onUpdate:modelValue":m[8]||(m[8]=f=>g.value.year_end_target_variation=f),label:"Mid-year Achievement*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",Cl,[t(I,{modelValue:g.value.year_end_remainder_target,"onUpdate:modelValue":m[9]||(m[9]=f=>g.value.year_end_remainder_target=f),label:"Target Variation*",variant:"outlined",density:"compact","persistent-hint":""},null,8,["modelValue"])]),l("div",$l,[t(x,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:m[10]||(m[10]=f=>k.value.dialog=!1)},{default:n(()=>[$("Cancel")]),_:1}),t(x,{color:"secondary",class:"ml-2",onClick:c.submitReview},{default:n(()=>[$("Submit")]),_:1},8,["onClick"])])]),_:1})])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","max-width"]),t(ye,{options:q.value},null,8,["options"])],64))}};const Tl={class:"v-col-12 v-col-md-2"},Rl={class:"v-col-12 v-col-md-2"},Sl={class:"v-col-12"},Dl={class:"d-flex align-center px-3"},Ol={key:1,class:"ml-auto text-h6"},Pl={key:1,class:"text-uppercase text-primary"},Ul={key:2,class:"text-uppercase text-center",style:{display:"block !important",width:"100%"}},jl={key:3,class:"text-uppercase text-center"},Kl={key:4,class:"ml-auto text-body-1"},Fl={class:"v-col-12 pb-0"},Al={class:"v-col-12"},zl={class:"v-col-12 pb-0 d-flex justify-space-between"},Ll=l("div",{class:"text-grey text-caption"},"KPI",-1),Bl={class:"text-primary text-body-1"},Ml={class:"v-col-3"},Wl=l("div",{class:"text-grey text-caption"},"Industry",-1),El={class:"text-primary text-body-1"},Nl={class:"v-col-3"},Yl={class:"text-grey text-caption"},Hl={class:"text-primary text-body-1"},ql={class:"v-col-3"},Gl=l("div",{class:"text-grey text-caption"},"Measure",-1),Jl={class:"text-primary text-body-1"},Xl={class:"v-col-3"},Zl={class:"text-grey text-caption"},Ql={class:"text-primary text-body-1"},et={key:1,class:"v-col-12 pb-0 text-center"},lt={class:"v-col-6 pb-0"},tt={key:1},at={class:"v-col-6 pb-0"},st={key:1},it={class:"v-col-6 pb-0"},nt={class:"v-col-12 pb-0 d-flex justify-space-between"},ot=l("div",{class:"text-grey text-caption"},"Training",-1),ut={class:"text-primary text-body-1"},dt={class:"v-col-3"},rt={class:"text-grey text-caption"},vt={class:"text-primary text-body-1"},ct={class:"v-col-3"},mt=l("div",{class:"text-grey text-caption"},"Type",-1),pt={class:"text-primary text-body-1"},gt={class:"v-col-6 pb-0"},yt={class:"v-col-12 pb-0 d-flex justify-space-between"},_t=l("div",{class:"text-grey text-caption"},"Training",-1),ft={class:"text-primary text-body-1"},ht={class:"v-col-3"},bt={class:"text-grey text-caption"},xt={class:"text-primary text-body-1"},wt={class:"v-col-3"},kt=l("div",{class:"text-grey text-caption"},"Type",-1),Vt={class:"text-primary text-body-1"},Ct={class:"pb-3 text-grey"},$t={class:"text-primary"},It={class:"d-flex justify-end mt-5"},Ot={__name:"KpiContent",props:{selectedEmployee:{type:Object,default:null},industryList:{type:Object,default:null},ecdList:{type:Object,default:null},submitButton:{type:Boolean,default:!0},measuresList:{type:Object,default:null}},emits:["yearchange","savedResponse","errorcheck"],setup(S,{emit:A}){const w=S,z=Re(),g=Se(),H=De(),k=p({}),j=Oe(),e=p(w.selectedEmployee),o=X(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="kpi")),R=X(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd")),q=X(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="tech")),V=X(()=>!e.value||e.value&&(!e.value.reviews||e.value.reviews.length==0)?[]:e.value.reviews[0].key_review.filter(s=>s.type=="ecd"&&s.ecd_type=="soft"));F(()=>w.selectedEmployee,s=>{s.length>0?e.value=Object.assign({},s[0]):e.value=Object.assign({},s),g.name=="SingleTeamMember"&&P()});const c=X(()=>j.filteredSetting(e.value.company_id)),m=p(!1),f=p(!1),P=()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="first_review")){let s=e.value.reviews[0].key_review.filter(d=>d.achievement_midyear==null),i=!1;s&&s.length>0&&(i=!0),A("errorcheck",{hasError:i})}else if(e.value&&e.value.reviews&&e.value.reviews.length>0&&(e.value.reviews[0].state=="yearend"||e.value.reviews[0].state=="final_review")){let s=e.value.reviews[0].key_review.filter(d=>d.achievement_yearend==null),i=!1;s&&s.length>0&&(i=!0),A("errorcheck",{hasError:i})}else O().then(()=>{A("errorcheck",{hasError:f.value})})},D=p(""),O=async()=>{let s="",i=!1;b.value=="kpi"&&o.value.length<4&&Y("kpi")==0?(s="Invalid: Minimum 4 KPI's needed, kindly update the weightage.",i=!0):(s="Invalid: Should have 1 each, technical and soft skill, kindly update the weightage.",i=ee(i)),m.value=i,i&&(D.value=s),se()},ee=s=>{if(Y("ecd")==0&&R.value&&R.value.length>0&&R.value.length<2)s=!0;else if(R.value.length>1){let i=[];R.value.map((d,Z)=>{i.push(d.ecd_type)}),i=[...new Set(i)],Y("ecd")==0&&i.length<2&&(s=!0)}return s},se=async()=>{let s=!1;o.value.length<4&&Y("kpi")==0&&(s=!0),s=ee(s),f.value=s},b=p("kpi"),M=s=>{b.value=s,g.name=="SingleTeamMember"&&O()},L=p(new Date),v=X(()=>{if(e.value&&e.value.reviews&&e.value.reviews.length>0)return!!(H.authRole.includes("manager")&&g.name=="SingleTeamMember"&&e.value.reviews[0].state=="setting"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"||e.value.reviews[0].status=="inreview"));if(g.name=="SingleTeamMember"&&c&&c.state=="setting"&&(c.status=="open"||c.status=="inprogress"))return!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){let s=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(c.probation_kpi_setting)),s>=L.value)return!0}return!1}),a=p({saveBtn:!1,isFinal:!1}),u=X(()=>{if(a.value={saveBtn:!1,isFinal:!1},g.name=="SingleTeamMember"&&c&&c.state=="yearend"&&(a.value={saveBtn:!1,isFinal:!0}),g.name=="SingleTeamMember"&&c&&(c.state=="midyear"||c.state=="yearend")&&(c.status=="open"||c.status=="inprogress"))return a.value={saveBtn:!0,isFinal:!0},!0;if(e.value&&e.value.is_regular==0&&g.name=="SingleTeamMember"){if(a.value={saveBtn:!1,isFinal:!1},c){let s=new Date(e.value.doj),i=new Date(e.value.doj);if(s.setDate(s.getDate()+parseInt(c.probation_first_review_start)),i.setDate(i.getDate()+parseInt(c.probation_first_review_end)),e.value.reviews[0].state=="first_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return a.value={saveBtn:!0,isFinal:!1},!0;if(s<=L.value&&i>=L.value)return a.value={saveBtn:!0,isFinal:!1},!0;let d=new Date(e.value.doj),Z=new Date(e.value.doj);if(d.setDate(d.getDate()+parseInt(c.probation_final_review_start)),Z.setDate(Z.getDate()+parseInt(c.probation_final_review_end)),e.value.reviews[0].state=="final_review"&&(e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"))return a.value={saveBtn:!0,isFinal:!0},!0;if(d<=L.value&&Z>=L.value)return a.value={saveBtn:!0,isFinal:!0},!0}}else if(e.value&&e.value.reviews&&e.value.reviews.length>0)return e.value.reviews[0].status=="open"||e.value.reviews[0].status=="inprogress"?a.value.saveBtn=!0:e.value.reviews[0].state=="yearend"&&(a.value.isFinal=!0),!!(H.authRole.includes("manager")&&g.name=="SingleTeamMember"&&(e.value.reviews[0].state=="midyear"||e.value.reviews[0].state=="yearend"));return!1}),W=p(new Date().getFullYear()),xe=()=>{const s=z.resolve({path:"/print/kpi/"+W.value+"/"+e.value.username,params:{year:W.value},query:{print:1}});window.open(s.href,"_blank")};F(W,async(s,i)=>{A("yearchange",s)});const E=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),N=p({title:"",dialog:!1,data:{},type:"",action:"",is_review:!1}),ie=async(s,i)=>{if(Y(b.value)<=0)k.value={status:!0,type:"error",text:"Denied: You've reached the weightage limit."};else if(s=="kpi")o.value.length>5?k.value={status:!0,type:"error",text:"Denied: Max of 6 KPI only. Minimum is 4 KPI"}:E.value={title:"Add KPI ",data:{},dialog:!0,type:s,action:"add",is_review:!1};else{let d="Identify Technical Skill Development";i=="soft"&&(d="Identify Behavioral Program"),N.value={...N.value,title:d,data:{},dialog:!0,type:s,ecdType:i,action:"add",is_review:!1}}},ne=async(s,i="kpi",d)=>{i=="kpi"?E.value={...E.value,title:"Edit KPI ",data:Object.assign({},s),dialog:!0,type:i,action:"edit",is_review:!1}:N.value={...N.value,title:"Edit ECD ",data:Object.assign({},s),dialog:!0,type:i,action:"edit",ecdType:d,is_review:!1}},we=async(s,i="kpi")=>{console.log("item",s),i=="kpi"&&(E.value={...E.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"readonly",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular},console.log("kpiOptions",E.value)),i=="ecd"&&(N.value={...N.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"readonly",is_review:!0})},oe=async(s,i="kpi")=>{i=="kpi"&&(E.value={...E.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"review",is_review:!0,state:e.value.reviews[0].state,is_regular:e.value.is_regular}),i=="ecd"&&(N.value={...N.value,title:i.toUpperCase(),data:Object.assign({},s),dialog:!0,type:i,action:"review",is_review:!0})},_e=s=>{let i={reviewID:e.value.reviews[0].id,data:s,industryTitle:s.industryTitle,state:s.state};P(),A("savedResponse",i)},G=p({data:{},dialog:!1,loading:!1}),ue=async s=>{G.value={...G.value,data:Object.assign({},s),dialog:!0}},ke=async()=>{let s=G.value.data;G.value.dialog=!1,A("removeKPI",s)},Y=s=>{let i=70;return e.value&&e.value.is_regular==0&&(i=100),s=="ecd"?(i=30,R.value&&R.value.length>0&&R.value.map((d,Z)=>{i-=d.weightage})):o.value&&o.value.length>0&&o.value.map((d,Z)=>{i-=d.weightage}),i};return(s,i)=>(r(),_(T,null,{default:n(()=>[l("div",Tl,[t(U(Ke),{modelValue:W.value,"onUpdate:modelValue":i[0]||(i[0]=d=>W.value=d),"year-picker":"",class:"pms-date-picker"},null,8,["modelValue"])]),l("div",Rl,[e.value&&e.value.reviews&&e.value.reviews.length>0?(r(),_(x,{key:0,onClick:xe,color:"white",class:"text-capitalize text-md-caption text-lg-body-2"},{default:n(()=>[$("View/Print"),t(K,{icon:U(Pe),class:"ml-1"},null,8,["icon"])]),_:1})):h("",!0)]),l("div",Sl,[l("div",Dl,[t(B,{onClick:i[1]||(i[1]=()=>M("kpi")),flat:"",class:J(`
          ${b.value=="kpi"?"":"bg-grey-darken-3 text-white"}
          d-flex align-center justify-center px-3 text-center pms-tab`)},{default:n(()=>[$(" KPI "+y(o.value?"("+o.value.length+")":"(0)"),1)]),_:1},8,["class"]),e.value&&e.value.is_regular?(r(),_(B,{key:0,onClick:i[2]||(i[2]=()=>M("ecd")),flat:"",class:J(`${b.value=="ecd"?"":"bg-grey-darken-3 text-white"} d-flex align-center justify-center px-3 text-caption text-center pms-tab`)},{default:n(()=>[$(" Employee Capability Development "+y("("+R.value.length+")"),1)]),_:1},8,["class"])):h("",!0),e.value&&e.value.reviews&&e.value.reviews.length>0&&e.value.reviews[0].state=="yearend"&&e.value.reviews[0].status=="submitted"?(r(),C("div",Ol,"Rate: Coming Soon")):h("",!0)]),t(B,{flat:""},{default:n(()=>[t(fe,{class:"px-5 py-5 d-flex align-center"},{default:n(()=>[v.value&&b.value=="kpi"?(r(),_(x,{key:0,onClick:i[3]||(i[3]=()=>ie(b.value)),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[t(K,{size:"small",icon:U(re)},null,8,["icon"])]),_:1})):h("",!0),b.value=="kpi"&&o.value&&o.value.length>0||b.value=="ecd"&&R.value&&R.value.length>0?(r(),C("div",Pl,y(b.value=="ecd"?"Employee Capability Development":b.value)+" List ",1)):v.value?(r(),C("div",jl,y(b.value=="ecd"?"Employee Capability Development":e.value.is_regular?b.value:"Probation KPI")+" List ",1)):(r(),C("div",Ul,y(b.value)+" not set ",1)),v.value&&Y(b.value)>0?(r(),C("div",Kl,"Remaining "+y(b.value.toUpperCase())+" weightage: "+y(Y(b.value))+"%",1)):h("",!0)]),_:1}),t(Q,{class:"px-5 pb-10"},{default:n(()=>[m.value?(r(),_(T,{key:0,class:"mb-2"},{default:n(()=>[l("div",Fl,[t(B,{class:"rounded-lg",style:{border:"2px solid red"}},{default:n(()=>[t(Q,null,{default:n(()=>[t(T,null,{default:n(()=>[l("div",Al,[t(K,{size:"large",color:"red",class:"mr-1",icon:U(Ue)},null,8,["icon"]),$(" "+y(D.value),1)])]),_:1})]),_:1})]),_:1})])]),_:1})):h("",!0),he(t(T,{class:"mt-3"},{default:n(()=>[o.value&&o.value.length>0?(r(!0),C(le,{key:0},de(o.value,d=>(r(),C("div",{class:"v-col-12 pb-0",key:d.id},[t(B,{class:"rounded-lg"},{default:n(()=>[t(Q,null,{default:n(()=>[t(T,null,{default:n(()=>[l("div",zl,[l("div",null,[Ll,l("div",Bl,y(d.title),1)]),l("div",null,[v.value?(r(),_(x,{key:0,onClick:()=>we(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(je)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),u.value?(r(),_(x,{key:1,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"kpi")},{default:n(()=>[$("review")]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:2,onClick:()=>ne(d,"kpi"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:3,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),l("div",Ml,[Wl,l("div",El,y(d.industry),1)]),l("div",Nl,[l("div",Yl,"Target ("+y(d.target_type)+")",1),l("div",Hl,y(d.target),1)]),l("div",ql,[Gl,l("div",Jl,y(d.measures),1)]),l("div",Xl,[l("div",Zl,y("KPI's Weightage(%)"),1),l("div",Ql,y(d.weightage)+"%",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)):(r(),C("div",et," No records yet. "))]),_:1},512),[[be,b.value=="kpi"]]),he(t(T,{class:"mt-n3"},{default:n(()=>[l("div",lt,[v.value?(r(),_(x,{key:0,onClick:i[4]||(i[4]=()=>ie(b.value,"tech")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[t(K,{size:"small",icon:U(re)},null,8,["icon"])]),_:1})):h("",!0),v.value?(r(),C("span",tt,"Technical Skill")):h("",!0)]),l("div",at,[v.value?(r(),_(x,{key:0,onClick:i[5]||(i[5]=()=>ie(b.value,"soft")),density:"compact",size:"35",class:"rounded-xl elevation-2 mr-2"},{default:n(()=>[t(K,{size:"small",icon:U(re)},null,8,["icon"])]),_:1})):h("",!0),$(),v.value?(r(),C("span",st,"Soft Skill")):h("",!0)]),l("div",it,[t(T,null,{default:n(()=>[(r(!0),C(le,null,de(q.value,d=>(r(),C("div",{class:"v-col-12 pb-0",key:d.id},[t(B,{class:"rounded-lg"},{default:n(()=>[t(Q,null,{default:n(()=>[t(T,null,{default:n(()=>[l("div",nt,[l("div",null,[ot,l("div",ut,y(d.title),1)]),l("div",null,[u.value?(r(),_(x,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[$("review")]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:1,onClick:()=>ne(d,"ecd","tech"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),l("div",dt,[l("div",rt,y("KPI's Weightage(%)"),1),l("div",vt,y(d.weightage),1)]),l("div",ct,[mt,l("div",pt,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),l("div",gt,[t(T,null,{default:n(()=>[(r(!0),C(le,null,de(V.value,d=>(r(),C("div",{class:"v-col-12 pb-0",key:d.id},[t(B,{class:"rounded-lg"},{default:n(()=>[t(Q,null,{default:n(()=>[t(T,null,{default:n(()=>[l("div",yt,[l("div",null,[_t,l("div",ft,y(d.title),1)]),l("div",null,[u.value?(r(),_(x,{key:0,color:"primary",class:"rounded-xl px-5",size:"small",onClick:()=>oe(d,"ecd")},{default:n(()=>[$("review")]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:1,onClick:()=>ne(d,"ecd","soft"),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ve)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0),v.value?(r(),_(x,{key:2,onClick:()=>ue(d),density:"compact",size:"30",color:"primary",class:"rounded-xl elevation-2 ml-1"},{default:n(()=>[t(K,{size:"small",icon:U(ce)},null,8,["icon"])]),_:2},1032,["onClick"])):h("",!0)])]),l("div",ht,[l("div",bt,y("KPI's Weightage(%)"),1),l("div",xt,y(d.weightage),1)]),l("div",wt,[kt,l("div",Vt,y(d.ecd_type),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})])]),_:1},512),[[be,b.value=="ecd"]])]),_:1})]),_:1})]),t(ge,{modelValue:G.value.dialog,"onUpdate:modelValue":i[7]||(i[7]=d=>G.value.dialog=d),width:"100%","max-width":"480",persistent:""},{default:n(()=>[t(B,{class:"rounded-lg"},{default:n(()=>[t(fe,{class:"pa-3"},{default:n(()=>[$("Confirm Remove")]),_:1}),t(Q,{class:"px-3"},{default:n(()=>[l("div",Ct,[$(" Please confirm that you want to remove "),l("span",$t,y("'"+G.value.data.title.substring(0,35)+"...'"),1)]),l("div",It,[t(x,{class:"bg-grey-lighten-2 text-primary",variant:"text",onClick:i[6]||(i[6]=d=>G.value.dialog=!1)},{default:n(()=>[$("Cancel")]),_:1}),t(x,{color:"primary",class:"ml-2",onClick:ke},{default:n(()=>[$("Remove")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(dl,{"final-review":a.value,"measures-list":S.measuresList,"kpi-options":E.value,"remain-weightage":Y(b.value),"industry-list":S.industryList,"submit-button":w.submitButton,onSavedResponse:_e},null,8,["final-review","measures-list","kpi-options","remain-weightage","industry-list","submit-button"]),t(Il,{"final-review":a.value,"ecd-options":N.value,"remain-weightage":Y(b.value),"ecd-list":S.ecdList,"submit-button":w.submitButton,onSavedResponse:_e},null,8,["final-review","ecd-options","remain-weightage","ecd-list","submit-button"]),t(ye,{options:k.value},null,8,["options"])]),_:1}))}};export{Ot as _};
